<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#f5b8d5"><meta name="author" content="l1pmoluy,1392181761@qq.com"><meta name="copyright" content="l1pmoluy"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>ghctf2025-re-wp | l1pmoluy</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#f5b8d5"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"l1pmoluy.github.io","root":"/","title":"è¸ç€æ¢¦èµ°è¿‡æ—¶å…‰","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"algolia":{"hits":{"per_page":8}},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="l1pmoluy" type="application/atom+xml"><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="å†™äº†é€†å‘æ–¹å‘7ä¸ªé¢˜">
<meta property="og:type" content="article">
<meta property="og:title" content="ghctf2025-re-wp">
<meta property="og:url" content="https://l1pmoluy.github.io/2025/03/26/2025ghctf/index.html">
<meta property="og:site_name" content="l1pmoluy">
<meta property="og:description" content="å†™äº†é€†å‘æ–¹å‘7ä¸ªé¢˜">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/1.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/2.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/3.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/4.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/5.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/6.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/7.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/8.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/9.png">
<meta property="og:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/11.png">
<meta property="article:published_time" content="2025-03-26T07:55:14.000Z">
<meta property="article:modified_time" content="2025-03-26T09:34:05.526Z">
<meta property="article:author" content="l1pmoluy">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://l1pmoluy.github.io/.io//tool/blog/source/postpic/ghctf2025/1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="l1pmoluy"><img width="96" loading="lazy" src="/images/rika.jpg" alt="l1pmoluy"><span class="site-author-status" title="Looking for dawn.">ğŸ¥°</span></a><div class="site-author-name"><a href="/about/">l1pmoluy</a></div><span class="site-name">l1pmoluy</span><sub class="site-subtitle">Dawing...</sub><div class="site-description">l1pmoluy's blog</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">8</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">2</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">3</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="1392181761" target="_blank" style="color:#12B7F5"><span class="icon iconify" data-icon="ri:qq-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://blog.csdn.net/dawn_ing_" title="csdn" target="_blank" style="color:#e83b07"><span class="icon iconify" data-icon="ri:terminal-box-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://bbs.kanxue.com/user-home-1012312.htm" title="çœ‹é›ª" target="_blank" style="color:#e83b07"><span class="icon iconify" data-icon="ri:snowflake-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="1392181761@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/hututu-mknzl" title="è¯­é›€" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:yuque-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="å‹é“¾" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:user-community-line"></span></a><a class="links-item hty-icon-button" href="/girl/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><span class="icon iconify" data-icon="ri:women-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ASM-Signin"><span class="toc-number">1.</span> <span class="toc-text">ASM?Signin!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FishingKit"><span class="toc-number">2.</span> <span class="toc-text">FishingKit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LockedSecret"><span class="toc-number">3.</span> <span class="toc-text">LockedSecret</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mio%EF%BC%9FRyo%EF%BC%9FSoyo%EF%BC%9F"><span class="toc-number">4.</span> <span class="toc-text">Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TimeSpaceRescue"><span class="toc-number">5.</span> <span class="toc-text">TimeSpaceRescue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Room0"><span class="toc-number">6.</span> <span class="toc-text">Room0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#canno"><span class="toc-number">7.</span> <span class="toc-text">canno</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#f5b8d5;"><link itemprop="mainEntityOfPage" href="https://l1pmoluy.github.io/2025/03/26/2025ghctf/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="l1pmoluy,1392181761@qq.com"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="l1pmoluy"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ghctf2025-re-wp</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2025-3-26 15:55:14" itemprop="dateCreated datePublished" datetime="2025-03-26T15:55:14+08:00">2025-3-26</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="æœ¬æ–‡å­—æ•°">14.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="é˜…è¯»æ—¶é•¿">83m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/ctf/" style="--text-color:#416482" itemprop="url" rel="index"><span itemprop="text">ctf</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/wp/" style="--text-color:#1E90FF"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">wp</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>å†™äº†é€†å‘æ–¹å‘7ä¸ªé¢˜</p>
<span id="more"></span>
<h2 id="ASM-Signin"><a href="#ASM-Signin" class="headerlink" title="ASM?Signin!"></a>ASM?Signin!</h2><p>æ±‡ç¼–é¢˜ï¼Œç›´æ¥æ¢­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤„ç†åçš„DATA1æ•°ç»„ï¼ˆç»è¿‡DO1è¿‡ç¨‹ï¼‰</span></span><br><span class="line">processed_data1 = [</span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x24</span>, <span class="number">0x25</span>,</span><br><span class="line">    <span class="number">0x3F</span>, <span class="number">0x27</span>, <span class="number">0x34</span>, <span class="number">0x11</span>,</span><br><span class="line">    <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x30</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x34</span>, <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x3A</span>, <span class="number">0x3B</span>, <span class="number">0x38</span>, <span class="number">0x39</span>,</span><br><span class="line">    <span class="number">0x3E</span>, <span class="number">0x3F</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>,</span><br><span class="line">    <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x28</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x2E</span>, <span class="number">0x2F</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># DATA2æ•°ç»„ï¼ˆåŠ å¯†åçš„ç›®æ ‡æ•°æ®ï¼‰</span></span><br><span class="line">data2 = [</span><br><span class="line">    <span class="number">0x69</span>, <span class="number">0x77</span>, <span class="number">0x77</span>, <span class="number">0x66</span>,</span><br><span class="line">    <span class="number">0x73</span>, <span class="number">0x72</span>, <span class="number">0x4F</span>, <span class="number">0x46</span>,</span><br><span class="line">    <span class="number">0x03</span>, <span class="number">0x47</span>, <span class="number">0x6F</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x41</span>, <span class="number">0x13</span>, <span class="number">0x47</span>,</span><br><span class="line">    <span class="number">0x5E</span>, <span class="number">0x67</span>, <span class="number">0x5F</span>, <span class="number">0x09</span>,</span><br><span class="line">    <span class="number">0x0F</span>, <span class="number">0x58</span>, <span class="number">0x63</span>, <span class="number">0x7D</span>,</span><br><span class="line">    <span class="number">0x5F</span>, <span class="number">0x77</span>, <span class="number">0x68</span>, <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x62</span>, <span class="number">0x0D</span>, <span class="number">0x0D</span>, <span class="number">0x50</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†æ¯ä¸ªå—</span></span><br><span class="line">flag_bytes = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="comment"># è·å–DATA2çš„å½“å‰å››å­—èŠ‚å—</span></span><br><span class="line">    e0, e1, e2, e3 = data2[i*<span class="number">4</span> : (i+<span class="number">1</span>)*<span class="number">4</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è·å–å¯¹åº”çš„å¤„ç†åçš„DATA1å—</span></span><br><span class="line">    d_block = processed_data1[i*<span class="number">4</span> : (i+<span class="number">1</span>)*<span class="number">4</span>]</span><br><span class="line">    d1 = d_block[<span class="number">1</span>]  <span class="comment"># ç¬¬äºŒä¸ªå­—èŠ‚ç”¨äºå¼‚æˆ–e0</span></span><br><span class="line">    d2 = d_block[<span class="number">2</span>]  <span class="comment"># ç¬¬ä¸‰ä¸ªå­—èŠ‚ç”¨äºå¼‚æˆ–e1å’Œe2</span></span><br><span class="line">    d3 = d_block[<span class="number">3</span>]  <span class="comment"># ç¬¬å››ä¸ªå­—èŠ‚ç”¨äºå¼‚æˆ–e3</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¼‚æˆ–è§£å¯†</span></span><br><span class="line">    b0 = e0 ^ d1</span><br><span class="line">    b1 = e1 ^ d2</span><br><span class="line">    b2 = e2 ^ d2</span><br><span class="line">    b3 = e3 ^ d3</span><br><span class="line">    </span><br><span class="line">    flag_bytes.extend([b0, b1, b2, b3])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å­—èŠ‚è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">flag = <span class="built_in">bytes</span>(flag_bytes).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#NSSCTF&#123;W0w_y0u&#x27;re_g00d_@t_@5M!!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="FishingKit"><a href="#FishingKit" class="headerlink" title="FishingKit"></a>FishingKit</h2><p>hook+tea+z3</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v4; <span class="comment">// r8</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  __int64 v7; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v8; <span class="comment">// r8</span></span><br><span class="line">  __int64 v10; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v11; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">char</span> v13[<span class="number">24</span>]; <span class="comment">// [rsp+20h] [rbp-98h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v14[<span class="number">56</span>]; <span class="comment">// [rsp+38h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">56</span>]; <span class="comment">// [rsp+70h] [rbp-48h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v13, <span class="number">0</span>, <span class="number">0x14u</span>i64);</span><br><span class="line">  <span class="built_in">memset</span>(v14, <span class="number">0</span>, <span class="number">0x32u</span>i64);</span><br><span class="line">  <span class="built_in">memset</span>(Str1, <span class="number">0</span>, <span class="number">0x32u</span>i64);</span><br><span class="line">  sub_140002FD0(<span class="string">&quot;Give me the bait:&quot;</span>, argv, envp);</span><br><span class="line">  sub_140003050(<span class="string">&quot;%s&quot;</span>, v13);</span><br><span class="line">  <span class="keyword">if</span> ( sub_140001150((<span class="type">unsigned</span> __int8 *)v13) )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_140002FD0(<span class="string">&quot;Yes!This bait is a good one.\n\n&quot;</span>, v3, v4);</span><br><span class="line">    sub_140002FD0(<span class="string">&quot;Give me the second thing:&quot;</span>, v5, v6);</span><br><span class="line">    sub_140003050(<span class="string">&quot;%s&quot;</span>, v14);</span><br><span class="line">    sub_140002FD0(<span class="string">&quot;\nFishing...\n\n&quot;</span>, v7, v8);</span><br><span class="line">    Sleep(<span class="number">0x3E8u</span>);</span><br><span class="line">    sub_140002460(v14, Str1, v13);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(Str1, &amp;Str2) )</span><br><span class="line">      sub_140002FD0(<span class="string">&quot;Didn&#x27;t the fish take the bait?\n&quot;</span>, v10, v11);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      sub_140002FD0(<span class="string">&quot;Did the fish take the bait?\n&quot;</span>, v10, v11);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_140002FD0(<span class="string">&quot;Oops...This bait is terrible.\n&quot;</span>, v3, v4);</span><br><span class="line">  &#125;</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªæ˜¯z3çº¦æŸæ±‚è§£</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ 10 ä¸ªæ•´å‹å˜é‡ï¼Œa0 è¡¨ç¤º a0ï¼Œå…¶ä½™ a1~a9</span></span><br><span class="line">a0, a1, a2, a3, a4, a5, a6, a7, a8, a9 = Ints(<span class="string">&#x27;a0 a1 a2 a3 a4 a5 a6 a7 a8 a9&#x27;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">202</span> * a8 + <span class="number">216</span> * a5 - <span class="number">4</span> * a4 - <span class="number">330</span> * a9 - <span class="number">13</span> * a4 - <span class="number">268</span> * a6 == -<span class="number">14982</span>,</span><br><span class="line">    <span class="number">325</span> * a8 + <span class="number">195</span> * a0 + <span class="number">229</span> * a1 - <span class="number">121</span> * a6 - <span class="number">409</span> * a6 - (a1 &lt;&lt; <span class="number">7</span>) == <span class="number">22606</span>,</span><br><span class="line">    <span class="number">489</span> * a1 + <span class="number">480</span> * a6 + <span class="number">105</span> * a2 + <span class="number">367</span> * a3 - <span class="number">135</span> * a4 - <span class="number">482</span> * a9 == <span class="number">63236</span>,</span><br><span class="line">    <span class="number">493</span> * a1 - <span class="number">80</span> * a4 - <span class="number">253</span> * a8 - <span class="number">121</span> * a2 - <span class="number">177</span> * a0 - <span class="number">243</span> * a9 == -<span class="number">39664</span>,</span><br><span class="line">    <span class="number">275</span> * a4 + <span class="number">271</span> * a6 + <span class="number">473</span> * a7 - <span class="number">72</span> * a5 - <span class="number">260</span> * a4 - <span class="number">367</span> * a4 == <span class="number">14255</span>,</span><br><span class="line">    <span class="number">286</span> * a0 + <span class="number">196</span> * a7 + <span class="number">483</span> * a2 + <span class="number">442</span> * a1 - <span class="number">495</span> * a8 - <span class="number">351</span> * a4 == <span class="number">41171</span>,</span><br><span class="line">    <span class="number">212</span> * a2 + <span class="number">283</span> * a7 - <span class="number">329</span> * a8 - <span class="number">429</span> * a9 - <span class="number">362</span> * a2 - <span class="number">261</span> * a6 == -<span class="number">90284</span>,</span><br><span class="line">    <span class="number">456</span> * a5 + <span class="number">244</span> * a7 + <span class="number">92</span> * a4 + <span class="number">348</span> * a7 - <span class="number">225</span> * a1 - <span class="number">31</span> * a2 == <span class="number">88447</span>,</span><br><span class="line">    <span class="number">238</span> * a9 + <span class="number">278</span> * a7 + <span class="number">216</span> * a6 + <span class="number">237</span> * a0 + <span class="number">8</span> * a2 - <span class="number">17</span> * a9 == <span class="number">83838</span>,</span><br><span class="line">    <span class="number">323</span> * a9 + <span class="number">121</span> * a1 + <span class="number">370</span> * a7 - (a4 &lt;&lt; <span class="number">6</span>) - <span class="number">196</span> * a9 - <span class="number">422</span> * a0 == <span class="number">26467</span>,</span><br><span class="line">    <span class="number">166</span> * a9 + <span class="number">90</span> * a1 + <span class="number">499</span> * a2 + <span class="number">301</span> * a8 - <span class="number">31</span> * a2 - <span class="number">206</span> * a2 == <span class="number">88247</span>,</span><br><span class="line">    <span class="number">355</span> * a0 + <span class="number">282</span> * a4 + <span class="number">44</span> * a9 + <span class="number">359</span> * a8 - <span class="number">167</span> * a5 - <span class="number">62</span> * a3 == <span class="number">76658</span>,</span><br><span class="line">    <span class="number">488</span> * a6 + <span class="number">379</span> * a9 + <span class="number">318</span> * a2 - <span class="number">85</span> * a1 - <span class="number">357</span> * a2 - <span class="number">277</span> * a5 == <span class="number">35398</span>,</span><br><span class="line">    <span class="number">40</span> * a0 + <span class="number">281</span> * a4 + <span class="number">217</span> * a5 - <span class="number">241</span> * a1 - <span class="number">407</span> * a7 - <span class="number">309</span> * a7 == -<span class="number">35436</span>,</span><br><span class="line">    <span class="number">429</span> * a3 + <span class="number">441</span> * a3 + <span class="number">115</span> * a1 + <span class="number">96</span> * a8 + <span class="number">464</span> * a1 - <span class="number">133</span> * a7 == <span class="number">157448</span></span><br><span class="line">    )</span><br><span class="line"><span class="comment"># æ±‚è§£çº¦æŸ</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="comment"># å‡è®¾æ±‚è§£å‡ºæ¥çš„ a0~a9 æ˜¯ ASCII ç ï¼Œå°†å…¶è½¬æ¢ä¸ºå­—ç¬¦å¹¶æ‹¼æ¥æˆå­—ç¬¦ä¸²</span></span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(m[v].as_long()) <span class="keyword">for</span> v <span class="keyword">in</span> (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Solution:&quot;</span>, flag)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>åé¢çš„å‡½æ•°ç‚¹è¿›å»åƒæ˜¯é­”æ”¹rc4</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140002460</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v4; <span class="comment">// [rsp+20h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v5; <span class="comment">// [rsp+21h] [rbp-17h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp-14h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+28h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  sub_1400028B0(a3);</span><br><span class="line">  v7 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v7; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += byte_1400060C0[++v4];</span><br><span class="line">    sub_140002D90(&amp;byte_1400060C0[v4], &amp;byte_1400060C0[v5]);</span><br><span class="line">    *(_BYTE *)(a2 + i) = byte_1400060C0[(<span class="type">unsigned</span> __int8)(byte_1400060C0[v5] + byte_1400060C0[v4])] ^ a1[i];</span><br><span class="line">    *(_BYTE *)(a2 + i) ^= <span class="number">0x14u</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result = v7;</span><br><span class="line">  *(_BYTE *)(a2 + v7) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æœ‰é—®é¢˜ï¼Œæˆ‘åœ¨çœ‹äº¤æ¢å‡½æ•°sub_140002D90çš„æ—¶å€™å‘ç°äº†äº¤å‰å¼•ç”¨<img src="/.io//tool\blog\source\postpic\ghctf2025\1.png" loading="lazy"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.rdata:<span class="number">0000000140004230</span> <span class="number">38</span> <span class="number">32</span> <span class="number">00</span> <span class="number">40</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       dq offset ?pre_cpp_initialization@@YAXXZ ; pre_cpp_initialization(<span class="type">void</span>)</span><br><span class="line">.rdata:<span class="number">0000000140004238</span> <span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">40</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_140001000</span><br><span class="line">.rdata:<span class="number">0000000140004240</span> <span class="number">20</span> <span class="number">10</span> <span class="number">00</span> <span class="number">40</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_140001020</span><br><span class="line">.rdata:<span class="number">0000000140004248</span> <span class="number">40</span> <span class="number">10</span> <span class="number">00</span> <span class="number">40</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_140001040</span><br></pre></td></tr></table></figure>

<p>ä»–ä»¬çš„æ ¹æºéƒ½æ˜¯è¿™ä¸ªï¼Œå¹¶ä¸”å¯ä»¥çŒœåˆ°æ˜¯initï¼Œåˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨çš„ï¼Œsub_140001000ç‚¹è¿›å»ä¼šå‘ç°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> <span class="title function_">sub_140001AD0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-48h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp-44h]</span></span><br><span class="line">  HMODULE hModule; <span class="comment">// [rsp+28h] [rbp-40h]</span></span><br><span class="line">  FARPROC ProcAddress; <span class="comment">// [rsp+30h] [rbp-38h]</span></span><br><span class="line">  CHAR ProcName[<span class="number">8</span>]; <span class="comment">// [rsp+38h] [rbp-30h] BYREF</span></span><br><span class="line">  CHAR ModuleName[<span class="number">16</span>]; <span class="comment">// [rsp+40h] [rbp-28h] BYREF</span></span><br><span class="line"></span><br><span class="line">  qmemcpy(ModuleName, <span class="string">&quot;fpagqr`v=w&quot;</span>, <span class="number">10</span>);</span><br><span class="line">  ModuleName[<span class="number">10</span>] = <span class="number">127</span>;</span><br><span class="line">  ModuleName[<span class="number">11</span>] = <span class="number">127</span>;</span><br><span class="line">  ModuleName[<span class="number">12</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">12</span>; ++i )</span><br><span class="line">    ModuleName[i] ^= <span class="number">0x13u</span>;</span><br><span class="line">  hModule = GetModuleHandleA(ModuleName);	<span class="comment">//dll</span></span><br><span class="line">  <span class="built_in">strcpy</span>(ProcName, <span class="string">&quot;`gap~c&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">6</span>; ++j )</span><br><span class="line">    ProcName[j] ^= <span class="number">0x13u</span>;</span><br><span class="line">  ProcAddress = GetProcAddress(hModule, ProcName);	<span class="comment">//strcmp</span></span><br><span class="line">  sub_140001C00(ProcAddress, sub_140001CE0);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªæ˜¯dllçš„åå­—ï¼Œç¬¬äºŒä¸ªæ˜¯strcmpå‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œå®ç°äº†å¯¹strcmpå‡½æ•°çš„hookï¼Œåç»­è°ƒç”¨strcmpçš„æ—¶å€™å®é™…ä¸Šæ˜¯è°ƒç”¨äº†sub_140001CE0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140001CE0</span><span class="params">(_BYTE *a1, <span class="type">unsigned</span> __int8 *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [rsp+20h] [rbp-108h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> num; <span class="comment">// [rsp+20h] [rbp-108h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> numa; <span class="comment">// [rsp+20h] [rbp-108h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+24h] [rbp-104h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+24h] [rbp-104h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [rsp+24h] [rbp-104h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [rsp+28h] [rbp-100h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v10; <span class="comment">// [rsp+28h] [rbp-100h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// [rsp+28h] [rbp-100h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+2Ch] [rbp-FCh]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+30h] [rbp-F8h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+34h] [rbp-F4h]</span></span><br><span class="line">  <span class="type">int</span> ii; <span class="comment">// [rsp+38h] [rbp-F0h]</span></span><br><span class="line">  <span class="type">int</span> jj; <span class="comment">// [rsp+3Ch] [rbp-ECh]</span></span><br><span class="line">  <span class="type">int</span> kk; <span class="comment">// [rsp+40h] [rbp-E8h]</span></span><br><span class="line">  <span class="type">int</span> mm; <span class="comment">// [rsp+44h] [rbp-E4h]</span></span><br><span class="line">  <span class="type">int</span> nn; <span class="comment">// [rsp+48h] [rbp-E0h]</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// [rsp+4Ch] [rbp-DCh]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+50h] [rbp-D8h]</span></span><br><span class="line">  <span class="type">int</span> m; <span class="comment">// [rsp+54h] [rbp-D4h]</span></span><br><span class="line">  <span class="type">int</span> n; <span class="comment">// [rsp+58h] [rbp-D0h]</span></span><br><span class="line">  HMODULE hModule; <span class="comment">// [rsp+60h] [rbp-C8h]</span></span><br><span class="line">  FARPROC ProcAddress; <span class="comment">// [rsp+68h] [rbp-C0h]</span></span><br><span class="line">  CHAR LibFileName[<span class="number">16</span>]; <span class="comment">// [rsp+70h] [rbp-B8h] BYREF</span></span><br><span class="line">  CHAR ProcName[<span class="number">16</span>]; <span class="comment">// [rsp+80h] [rbp-A8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v28[<span class="number">3</span>]; <span class="comment">// [rsp+90h] [rbp-98h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v29[<span class="number">11</span>]; <span class="comment">// [rsp+93h] [rbp-95h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v30[<span class="number">8</span>]; <span class="comment">// [rsp+9Eh] [rbp-8Ah] BYREF</span></span><br><span class="line">  <span class="type">char</span> v31[<span class="number">32</span>]; <span class="comment">// [rsp+A8h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v32[<span class="number">6</span>]; <span class="comment">// [rsp+C8h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v33[<span class="number">14</span>]; <span class="comment">// [rsp+E0h] [rbp-48h] BYREF</span></span><br><span class="line">  _BYTE *v34; <span class="comment">// [rsp+130h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  v34 = a1;</span><br><span class="line">  <span class="built_in">memset</span>(v32, <span class="number">0</span>, <span class="number">0x14u</span>i64);</span><br><span class="line">  <span class="built_in">memset</span>(v33, <span class="number">0</span>, <span class="number">0x32u</span>i64);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">20</span>; ++i )</span><br><span class="line">    *((_BYTE *)v32 + i) = a1[i - <span class="number">80</span>];</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">50</span>; ++j )</span><br><span class="line">    *((_BYTE *)v33 + j) = a1[j - <span class="number">56</span>];</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v6 = v33[<span class="number">0</span>];</span><br><span class="line">  v9 = v33[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">24</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 += (v32[v3 &amp; <span class="number">3</span>] + v3) ^ (v9 + ((v9 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v9)));</span><br><span class="line">    v3 += <span class="number">1719109785</span>;</span><br><span class="line">    v9 += (v32[(v3 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + v3) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)));</span><br><span class="line">  &#125;</span><br><span class="line">  v33[<span class="number">0</span>] = v6;</span><br><span class="line">  v33[<span class="number">1</span>] = v9;</span><br><span class="line">  num = <span class="number">0</span>;</span><br><span class="line">  v7 = v33[<span class="number">2</span>];</span><br><span class="line">  v10 = v33[<span class="number">3</span>];</span><br><span class="line">  <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">24</span>; ++m )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 += (v32[num &amp; <span class="number">3</span>] + num) ^ (v10 + ((v10 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v10)));</span><br><span class="line">    num += <span class="number">1719109785</span>;</span><br><span class="line">    v10 += (v32[(num &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + num) ^ (v7 + ((v7 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v7)));</span><br><span class="line">  &#125;</span><br><span class="line">  v33[<span class="number">2</span>] = v7;</span><br><span class="line">  v33[<span class="number">3</span>] = v10;</span><br><span class="line">  numa = <span class="number">0</span>;</span><br><span class="line">  v8 = v33[<span class="number">4</span>];</span><br><span class="line">  v11 = v33[<span class="number">5</span>];</span><br><span class="line">  <span class="keyword">for</span> ( n = <span class="number">0</span>; n &lt; <span class="number">24</span>; ++n )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 += (v32[numa &amp; <span class="number">3</span>] + numa) ^ (v11 + ((v11 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v11)));</span><br><span class="line">    numa += <span class="number">1719109785</span>;</span><br><span class="line">    v11 += (v32[(numa &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + numa) ^ (v8 + ((v8 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v8)));</span><br><span class="line">  &#125;</span><br><span class="line">  v33[<span class="number">4</span>] = v8;</span><br><span class="line">  v33[<span class="number">5</span>] = v11;</span><br><span class="line">  v12 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( ii = <span class="number">0</span>; ii &lt; <span class="number">24</span>; ++ii )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( byte_1400063C8[ii] != *((<span class="type">unsigned</span> __int8 *)v33 + ii) )</span><br><span class="line">    &#123;</span><br><span class="line">      v12 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v12 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>(LibFileName, <span class="string">&quot;dbtc\&quot;#?u&#125;&#125;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> ( jj = <span class="number">0</span>; jj &lt; <span class="number">10</span>; ++jj )</span><br><span class="line">      LibFileName[jj] ^= <span class="number">0x11u</span>;</span><br><span class="line">    hModule = LoadLibraryA(LibFileName);</span><br><span class="line">    <span class="built_in">strcpy</span>(ProcName, <span class="string">&quot;\\tbbpvtS~iP&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> ( kk = <span class="number">0</span>; kk &lt; <span class="number">11</span>; ++kk )</span><br><span class="line">      ProcName[kk] ^= <span class="number">0x11u</span>;</span><br><span class="line">    ProcAddress = GetProcAddress(hModule, ProcName);</span><br><span class="line">    <span class="built_in">strcpy</span>(v31, <span class="string">&quot;H~d6gt1rpdvye1p1sxv1wxby0&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> ( mm = <span class="number">0</span>; mm &lt; <span class="number">25</span>; ++mm )</span><br><span class="line">      v31[mm] ^= <span class="number">0x11u</span>;</span><br><span class="line">    qmemcpy(v28, <span class="string">&quot;R~&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    v28[<span class="number">2</span>] = <span class="number">127</span>;</span><br><span class="line">    qmemcpy(v29, <span class="string">&quot;vcped&#125;pex~&quot;</span>, <span class="number">10</span>);</span><br><span class="line">    v29[<span class="number">10</span>] = <span class="number">127</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(v30, <span class="string">&quot;000&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> ( nn = <span class="number">0</span>; nn &lt; <span class="number">17</span>; ++nn )</span><br><span class="line">      v28[nn] ^= <span class="number">0x11u</span>;</span><br><span class="line">    ((<span class="type">void</span> (__fastcall *)(_QWORD, <span class="type">char</span> *, <span class="type">char</span> *, _QWORD))ProcAddress)(<span class="number">0</span>i64, v31, v28, <span class="number">0</span>i64);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v20 = (<span class="type">unsigned</span> __int8)*v34 - *a2;</span><br><span class="line">    <span class="keyword">if</span> ( v20 || !*v34 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++v34;</span><br><span class="line">    ++a2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v20 &gt; <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( v20 &gt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åé¢è¿™ä¸ªå‡½æ•°å®é™…ä¸Šå°±æ˜¯å®ç°äº†teaçš„é­”æ”¹ï¼Œä¸‰ç»„å°±æ˜¯24ä½åˆšå¥½ç¬¦åˆï¼Œkeyå‘¢å°±æ˜¯å‰é¢ç¬¬ä¸€æ¬¡çš„è¾“å…¥</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//DeluxeBait</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">detea</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* middle,<span class="type">unsigned</span> <span class="type">int</span>* key)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> a1, a2;</span><br><span class="line">    a1 = middle[<span class="number">0</span>];</span><br><span class="line">    a2 = middle[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v3 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//for (int i = 0; i &lt; 24; ++i)</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    a1 += (key[v3 &amp; 3] + v3) ^ (a2 + ((a2 &gt;&gt; 5) ^ (16 * a2)));</span></span><br><span class="line">    <span class="comment">//    v3 += 1719109785;</span></span><br><span class="line">    <span class="comment">//    a2 += ((key[(v3 &gt;&gt; 11) &amp; 3] + v3) ^ (a1 + ((a1 &gt;&gt; 5) ^ (16 * a1))));</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v3 += <span class="number">1719109785</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        a2 -= ((key[(v3 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + v3) ^ (a1 + ((a1 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * a1))));</span><br><span class="line">        v3 -= <span class="number">1719109785</span>;</span><br><span class="line">        a1 -= (key[v3 &amp; <span class="number">3</span>] + v3) ^ (a2 + ((a2 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * a2)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x %x\n&quot;</span>, a1, a2);</span><br><span class="line">    middle[<span class="number">0</span>] = a1;</span><br><span class="line">    middle[<span class="number">1</span>] = a2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> flag[<span class="number">6</span>] = &#123;</span><br><span class="line">    <span class="number">0xA6975621</span>, <span class="number">0xDEC4D51A</span>, <span class="number">0x4D829CA4</span>, <span class="number">0x56C845D1</span>, <span class="number">0x5C96B4A7</span>, <span class="number">0x2087494D</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[]= &#123;</span><br><span class="line">    <span class="number">0x756C6544</span>, <span class="number">0x61426578</span>, <span class="number">0x00007469</span>, <span class="number">0x00000000</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> *middle;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        middle = &amp;flag[i];</span><br><span class="line">        detea(middle, key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">24</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="comment">//charç±»å‹è½¬æ¢</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">6</span>; k++) &#123;</span><br><span class="line">        a[k * <span class="number">4</span>] = (flag[k]);</span><br><span class="line">        a[k * <span class="number">4</span> + <span class="number">1</span>] = (flag[k] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        a[k * <span class="number">4</span> + <span class="number">2</span>] = (flag[k] &gt;&gt; <span class="number">16</span>);</span><br><span class="line">        a[k * <span class="number">4</span> + <span class="number">3</span>] = (flag[k] &gt;&gt; <span class="number">24</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//DeluxeBait</span></span><br><span class="line"><span class="comment">//NSSCTF&#123;Wh@t_@_b1g_F1sh&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/.io//tool\blog\source\postpic\ghctf2025\2.png" loading="lazy">å½©è›‹ï¼Œåé¢hookäº†MessageboxA</p>
<h2 id="LockedSecret"><a href="#LockedSecret" class="headerlink" title="LockedSecret"></a>LockedSecret</h2><p><img src="/.io//tool\blog\source\postpic\ghctf2025\3.png" loading="lazy"></p>
<p>upxæ”¹å£³+32ï¼Œè€Œä¸”å’Œä¸€èˆ¬å£³ä¸å¤ªä¸€æ ·ï¼Œæˆ‘é€‰æ‹©å’Œidaé…åˆæ‰‹è„±</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+0h] [ebp-108h]</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+0h] [ebp-108h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+0h] [ebp-108h]</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">256</span>]; <span class="comment">// [esp+4h] [ebp-104h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(Str, <span class="number">0</span>, <span class="keyword">sizeof</span>(Str));</span><br><span class="line">  sub_6D1050(Format, v4);</span><br><span class="line">  sub_6D10C0(<span class="string">&quot;%32s&quot;</span>, Str);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str) != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_6D1050(aWrongLength, v5);</span><br><span class="line">    system(Command);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_6D1100();</span><br><span class="line">  sub_6D1190((<span class="type">int</span> *)Str);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( unk_6D4060[i] != Str[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_6D1050(aWrong, i);</span><br><span class="line">      system(aPause_0);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_6D1050(aRight, i);</span><br><span class="line">  system(aPause_1);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªå­—å†™å‡½æ•°æ˜¯é€ ç›’ï¼Œç”¨äºåˆå§‹åŒ–ç¬¬äºŒä¸ªå‡½æ•°é‡Œçš„keyï¼Œç¬¬äºŒä¸ªå‡½æ•°ç¡®å®éš¾çœ‹ï¼Œæç¤ºè¯´åœ¨Ghidraä¸­æŸ¥çœ‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">void</span> __cdecl <span class="title function_">FUN_006d1190</span><span class="params">(<span class="type">int</span> param_1)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  uint uVar1;</span><br><span class="line">  uint uVar2;</span><br><span class="line">  <span class="type">bool</span> bVar3;</span><br><span class="line">  uint local_34;</span><br><span class="line">  <span class="type">int</span> local_30;</span><br><span class="line">  <span class="type">int</span> local_2c;</span><br><span class="line">  <span class="type">int</span> local_28;</span><br><span class="line">  <span class="type">int</span> local_24;</span><br><span class="line">  <span class="type">int</span> local_20;</span><br><span class="line">  byte local_1c [<span class="number">16</span>];</span><br><span class="line">  <span class="type">char</span> local_c;</span><br><span class="line">  uint local_8;</span><br><span class="line">  </span><br><span class="line">  local_8 = DAT_006d4000 ^ (uint)&amp;stack0xfffffffc;</span><br><span class="line">  local_1c._0_4_ = s_IamTheKeyYouKnow_006d3120._0_4_;</span><br><span class="line">  local_1c._4_4_ = s_IamTheKeyYouKnow_006d3120._4_4_;</span><br><span class="line">  local_1c._8_4_ = s_IamTheKeyYouKnow_006d3120._8_4_;</span><br><span class="line">  local_1c._12_4_ = s_IamTheKeyYouKnow_006d3120._12_4_;</span><br><span class="line">  local_c = s_IamTheKeyYouKnow_006d3120[<span class="number">0x10</span>];</span><br><span class="line">  <span class="keyword">for</span> (local_34 = <span class="number">0</span>; (<span class="type">int</span>)local_34 &lt; <span class="number">0xf</span>; local_34 = local_34 + <span class="number">1</span>) &#123;</span><br><span class="line">    uVar1 = local_34 &amp; <span class="number">0x80000007</span>;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="type">int</span>)uVar1 &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      uVar1 = (uVar1 - <span class="number">1</span> | <span class="number">0xfffffff8</span>) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    local_1c[local_34] = local_1c[local_34] ^ (byte)*(undefined4 *)(&amp;DAT_006d43d8 + uVar1 * <span class="number">4</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  local_2c = <span class="number">0</span>;</span><br><span class="line">  local_28 = <span class="number">0</span>;</span><br><span class="line">  local_24 = <span class="number">0</span>;</span><br><span class="line">  local_20 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;local_2c,local_1c,<span class="number">0x10</span>);</span><br><span class="line">  local_30 = <span class="number">4</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    uVar1 = *(uint *)(param_1 + <span class="number">4</span> + (<span class="number">4</span> - local_30) * <span class="number">8</span>);</span><br><span class="line">    uVar2 = (uVar1 * <span class="number">0x10</span> + local_2c ^ uVar1 + <span class="number">0x5e2377ff</span> ^ (uVar1 &gt;&gt; <span class="number">5</span>) + local_28) +</span><br><span class="line">            *(<span class="type">int</span> *)(param_1 + (<span class="number">4</span> - local_30) * <span class="number">8</span>);</span><br><span class="line">    uVar1 = (uVar2 * <span class="number">0x10</span> + local_24 ^ uVar2 + <span class="number">0x5e2377ff</span> ^ (uVar2 &gt;&gt; <span class="number">5</span>) + local_20) + uVar1;</span><br><span class="line">    uVar2 = (uVar1 * <span class="number">0x10</span> + local_2c ^ uVar1 + <span class="number">0xbc46effe</span> ^ (uVar1 &gt;&gt; <span class="number">5</span>) + local_28) + uVar2;</span><br><span class="line">    uVar1 = (uVar2 * <span class="number">0x10</span> + local_24 ^ uVar2 + <span class="number">0xbc46effe</span> ^ (uVar2 &gt;&gt; <span class="number">5</span>) + local_20) + uVar1;</span><br><span class="line">    uVar2 = (uVar1 * <span class="number">0x10</span> + local_2c ^ uVar1 + <span class="number">0x1a6a67fd</span> ^ (uVar1 &gt;&gt; <span class="number">5</span>) + local_28) + uVar2;</span><br><span class="line">    uVar1 = (uVar2 * <span class="number">0x10</span> + local_24 ^ uVar2 + <span class="number">0x1a6a67fd</span> ^ (uVar2 &gt;&gt; <span class="number">5</span>) + local_20) + uVar1;</span><br><span class="line">    uVar2 = (uVar1 * <span class="number">0x10</span> + local_2c ^ uVar1 + <span class="number">0x788ddffc</span> ^ (uVar1 &gt;&gt; <span class="number">5</span>) + local_28) + uVar2;</span><br><span class="line">    uVar1 = (uVar2 * <span class="number">0x10</span> + local_24 ^ uVar2 + <span class="number">0x788ddffc</span> ^ (uVar2 &gt;&gt; <span class="number">5</span>) + local_20) + uVar1;</span><br><span class="line">    uVar2 = (uVar1 * <span class="number">0x10</span> + local_2c ^ uVar1 + <span class="number">0xd6b157fb</span> ^ (uVar1 &gt;&gt; <span class="number">5</span>) + local_28) + uVar2;</span><br><span class="line">    uVar1 = (uVar2 * <span class="number">0x10</span> + local_24 ^ uVar2 + <span class="number">0xd6b157fb</span> ^ (uVar2 &gt;&gt; <span class="number">5</span>) + local_20) + uVar1;</span><br><span class="line">    uVar2 = (uVar1 * <span class="number">0x10</span> + local_2c ^ uVar1 + <span class="number">0x34d4cffa</span> ^ (uVar1 &gt;&gt; <span class="number">5</span>) + local_28) + uVar2;</span><br><span class="line">    uVar1 = (uVar2 * <span class="number">0x10</span> + local_24 ^ uVar2 + <span class="number">0x34d4cffa</span> ^ (uVar2 &gt;&gt; <span class="number">5</span>) + local_20) + uVar1;</span><br><span class="line">    uVar2 = (uVar1 * <span class="number">0x10</span> + local_2c ^ uVar1 + <span class="number">0x92f847f9</span> ^ (uVar1 &gt;&gt; <span class="number">5</span>) + local_28) + uVar2;</span><br><span class="line">    uVar1 = (uVar2 * <span class="number">0x10</span> + local_24 ^ uVar2 + <span class="number">0x92f847f9</span> ^ (uVar2 &gt;&gt; <span class="number">5</span>) + local_20) + uVar1;</span><br><span class="line">    uVar2 = (uVar1 * <span class="number">0x10</span> + local_2c ^ uVar1 + <span class="number">0xf11bbff8</span> ^ (uVar1 &gt;&gt; <span class="number">5</span>) + local_28) + uVar2;</span><br><span class="line">    *(uint *)(param_1 + (<span class="number">4</span> - local_30) * <span class="number">8</span>) = uVar2 ^ <span class="number">0xf</span>;</span><br><span class="line">    *(uint *)(param_1 + <span class="number">4</span> + (<span class="number">4</span> - local_30) * <span class="number">8</span>) =</span><br><span class="line">         (uVar2 * <span class="number">0x10</span> + local_24 ^ uVar2 + <span class="number">0xf11bbff8</span> ^ (uVar2 &gt;&gt; <span class="number">5</span>) + local_20) + uVar1 ^ <span class="number">0xf</span>;</span><br><span class="line">    bVar3 = local_30 != <span class="number">0</span>;</span><br><span class="line">    local_30 = local_30 + <span class="number">-1</span>;</span><br><span class="line">  &#125; <span class="keyword">while</span> (bVar3);</span><br><span class="line">  FUN_006d173b(local_8 ^ (uint)&amp;stack0xfffffffc);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸‹å°±å¾ˆå¥½çœ‹äº†ï¼Œæ˜¯teaï¼Œå¸¸æ•°æ˜¯åœ¨æ¨¡æ‹Ÿ+&#x3D;deltaï¼Œkeyçš„å®ç°åŠ¨è°ƒçœ‹ï¼Œdumpä¸‹æ¥æ˜¯0x423DF72D, 0x05F59A01, 0x633FCF1D, 0x77D19122</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">detea</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* mi, <span class="type">unsigned</span> <span class="type">int</span>* key)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> a1, a2;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">    a1 = mi[<span class="number">0</span>]^<span class="number">0xf</span>;</span><br><span class="line">    a2 = mi[<span class="number">1</span>]^<span class="number">0xf</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        num += <span class="number">0x5e2377ff</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;num=%x\n&quot;</span>, num);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a2 -= (a1 * <span class="number">16</span> + key[<span class="number">2</span>] ^ a1 + num ^ (a1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]);</span><br><span class="line">        a1 -= (a2 * <span class="number">16</span> + key[<span class="number">0</span>] ^ a2 + num ^ (a2 &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]);</span><br><span class="line">        num -= <span class="number">0x5e2377ff</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//for (int i = 0; i &lt; 8; i++)</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    num += 0x5e2377ff;</span></span><br><span class="line">    <span class="comment">//    printf(&quot;%x %x\n&quot;, a1, a2);</span></span><br><span class="line">    <span class="comment">//    a1 += (a2 * 16 + key[0] ^ a2 + num ^ (a2 &gt;&gt; 5) + key[1]);</span></span><br><span class="line">    <span class="comment">//    a2 += (a1 * 16 + key[2] ^ a1 + num ^ (a1 &gt;&gt; 5) + key[3]);</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x %x\n&quot;</span>, a1, a2);</span><br><span class="line">    mi[<span class="number">0</span>] = a1;</span><br><span class="line">    mi[<span class="number">1</span>] = a2;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[] = &#123; <span class="number">0x423DF72D</span>, <span class="number">0x05F59A01</span>, <span class="number">0x633FCF1D</span>, <span class="number">0x77D19122</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> input[] = &#123;</span><br><span class="line">        <span class="number">0x031E45DC</span>, <span class="number">0x2776E989</span>, <span class="number">0x01234847</span>, <span class="number">0x64CED270</span>, <span class="number">0x33467FDA</span>, <span class="number">0xA34903B1</span>, <span class="number">0x2CD10027</span>, <span class="number">0x75BDB337</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span>* middle;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        middle = &amp;input[i];</span><br><span class="line">        detea(middle, key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">33</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="comment">//charç±»å‹è½¬æ¢</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">8</span>; k++) &#123;</span><br><span class="line">        a[k * <span class="number">4</span>] = (input[k]);</span><br><span class="line">        a[k * <span class="number">4</span> + <span class="number">1</span>] = (input[k] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        a[k * <span class="number">4</span> + <span class="number">2</span>] = (input[k] &gt;&gt; <span class="number">16</span>);</span><br><span class="line">        a[k * <span class="number">4</span> + <span class="number">3</span>] = (input[k] &gt;&gt; <span class="number">24</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, a);</span><br><span class="line">    <span class="comment">//NSSCTF&#123;!!!Y0u_g3t_th3_s3cr3t!!!&#125;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ"><a href="#Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ" class="headerlink" title="Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ"></a>Mioï¼ŸRyoï¼ŸSoyoï¼Ÿ</h2><p>pythonæ–‡ä»¶ï¼Œè§£å¯†å‡ºæ¥æ˜¯å¼•ç”¨è‡ªå·±çš„åº“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">R85</span>:</span><br><span class="line">    Mbox = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(Miiooooooooo) <span class="keyword">for</span> Miiooooooooo <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>, <span class="number">118</span>)])</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">M</span>(<span class="params">M1: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        M5 = <span class="string">&quot;&quot;</span></span><br><span class="line">        M2 = (<span class="number">4</span> - <span class="built_in">len</span>(M1) % <span class="number">4</span>) % <span class="number">4</span></span><br><span class="line">        M1 += <span class="string">b&#x27;\x00&#x27;</span> * M2</span><br><span class="line">        <span class="keyword">for</span> M7 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(M1), <span class="number">4</span>):</span><br><span class="line">            M6 = M1[M7[:M7 + <span class="number">4</span>]]</span><br><span class="line">            M4 = <span class="built_in">int</span>.from_bytes(M6, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">            M3 = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                M3 = R85.Mbox[M4 % <span class="number">85</span>] + M3</span><br><span class="line">                M4 //= <span class="number">85</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                M5 += M3</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> M2:</span><br><span class="line">                M5 = M5[<span class="literal">None</span>[:-M2]]</span><br><span class="line">            <span class="keyword">return</span> M5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">R45</span>:</span><br><span class="line">    Rbox = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(RRRRouto) <span class="keyword">for</span> RRRRouto <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">93</span>)])</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">R</span>(<span class="params">Rin: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        Rout = []</span><br><span class="line">        Ri = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> Ri &lt; <span class="built_in">len</span>(Rin):</span><br><span class="line">            <span class="keyword">if</span> Ri + <span class="number">1</span> &lt; <span class="built_in">len</span>(Rin):</span><br><span class="line">                Rmi = Rin[Ri] &lt;&lt; <span class="number">8</span> | Rin[Ri + <span class="number">1</span>]</span><br><span class="line">                Rout.append(R45.Rbox[Rmi % <span class="number">45</span>])</span><br><span class="line">                Rmi //= <span class="number">45</span></span><br><span class="line">                Rout.append(R45.Rbox[Rmi % <span class="number">45</span>])</span><br><span class="line">                Rmi //= <span class="number">45</span></span><br><span class="line">                Rout.append(R45.Rbox[Rmi])</span><br><span class="line">                Ri += <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                Rmi = Rin[Ri]</span><br><span class="line">                Rout.append(R45.Rbox[Rmi % <span class="number">45</span>])</span><br><span class="line">                Rmi //= <span class="number">45</span></span><br><span class="line">                Rout.append(R45.Rbox[Rmi])</span><br><span class="line">                Ri += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(Rout)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">S</span>(<span class="params">S2, num</span>):</span><br><span class="line">    Sre = []</span><br><span class="line">    <span class="keyword">for</span> S1 <span class="keyword">in</span> S2:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;a&quot;</span> &lt;= S1 &lt;= <span class="string">&quot;z&quot;</span>:</span><br><span class="line">            S3 = (<span class="built_in">ord</span>(S1) - <span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>) + num) % <span class="number">26</span></span><br><span class="line">            Sre.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>) + S3))</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;0&quot;</span> &lt;= S1 &lt;= <span class="string">&quot;9&quot;</span>:</span><br><span class="line">            S3 = (<span class="built_in">ord</span>(S1) - <span class="built_in">ord</span>(<span class="string">&quot;0&quot;</span>) - num) % <span class="number">10</span></span><br><span class="line">            Sre.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&quot;0&quot;</span>) + S3))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            Sre.append(S1)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(Sre)</span><br><span class="line"></span><br><span class="line">sssssssssssss = <span class="built_in">bytes</span>([<span class="number">57</span>, <span class="number">118</span>, <span class="number">33</span>, <span class="number">114</span>, <span class="number">68</span>, <span class="number">56</span>, <span class="number">117</span>, <span class="number">115</span>, <span class="number">34</span>, <span class="number">52</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">78</span>, <span class="number">40</span>, <span class="number">49</span>, <span class="number">59</span>, </span><br><span class="line"> <span class="number">95</span>, <span class="number">85</span>, <span class="number">63</span>, <span class="number">122</span>, <span class="number">54</span>, <span class="number">33</span>, <span class="number">77</span>, <span class="number">110</span>, <span class="number">49</span>, <span class="number">54</span>, <span class="number">34</span>, <span class="number">109</span>, <span class="number">106</span>, <span class="number">122</span>, <span class="number">60</span>, </span><br><span class="line"> <span class="number">92</span>, <span class="number">108</span>, <span class="number">91</span>, <span class="number">61</span>, <span class="number">51</span>, <span class="number">42</span>, <span class="number">62</span>, <span class="number">35</span>, <span class="number">38</span>, <span class="number">52</span>, <span class="number">67</span>, <span class="number">62</span>, <span class="number">122</span>, <span class="number">116</span>, <span class="number">48</span>, </span><br><span class="line"> <span class="number">76</span>, <span class="number">50</span>, <span class="number">67</span>, <span class="number">51</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">122</span>, <span class="number">45</span>, <span class="number">45</span>, <span class="number">51</span>, <span class="number">90</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">l</span>(<span class="params">_: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> S(R85.M(S(R45.R(_.encode()), <span class="number">7</span>).encode()), <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Secret <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¾“å…¥:&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    aaaaaaaaaaaaa = <span class="built_in">input</span>()</span><br><span class="line">    wwwwwwwwwww = l(aaaaaaaaaaaaa)</span><br><span class="line">    <span class="keyword">if</span> sssssssssssss == wwwwwwwwwww.encode():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å“¦ï¼Œå¯¹çš„ã€‚&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å“ï¼Œå¹¶éã€‚&quot;</span>)</span><br><span class="line">    <span class="built_in">input</span>()</span><br></pre></td></tr></table></figure>

<p>ç®€å•åˆ†æbase45-&gt;å‡¯æ’’-&gt;base85-&gt;å‡¯æ’’ï¼Œç›´æ¥è§£å¯†å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åå‘åç§»çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_SSSooooyyooo</span>(<span class="params">s: <span class="built_in">str</span>, offset: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            new_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - offset) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">            result.append(new_char)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;0&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            new_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) + offset) % <span class="number">10</span> + <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>))</span><br><span class="line">            result.append(new_char)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(char)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åå‘MMMMiiiiiioå‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_MMMMiiiiiio</span>(<span class="params">encoded_str: <span class="built_in">str</span>, reverse_offset: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    MMiiiiiiooo = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(Miiooooooooo) <span class="keyword">for</span> Miiooooooooo <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>, <span class="number">118</span>)])</span><br><span class="line">    decoded_bytes = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> encoded_str:</span><br><span class="line">        index = MMiiiiiiooo.find(char)</span><br><span class="line">        <span class="keyword">if</span> index != -<span class="number">1</span>:</span><br><span class="line">            decoded_bytes.append(index)</span><br><span class="line">    decoded_str = <span class="built_in">bytes</span>(decoded_bytes).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> reverse_SSSooooyyooo(decoded_str, reverse_offset)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åå‘RRRRyyoooå‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_RRRRyyooo</span>(<span class="params">encoded_str: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    RRRRyooooooo = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(RRRRRRRyyyyyoooo) <span class="keyword">for</span> RRRRRRRyyyyyoooo <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">93</span>)])</span><br><span class="line">    decoded_str = []</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(encoded_str):</span><br><span class="line">        char1 = encoded_str[i]</span><br><span class="line">        char2 = encoded_str[i+<span class="number">1</span>] <span class="keyword">if</span> i+<span class="number">1</span> &lt; <span class="built_in">len</span>(encoded_str) <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">        decoded_str.append(RRRRyooooooo[<span class="built_in">int</span>(char1) % <span class="number">45</span>])</span><br><span class="line">        decoded_str.append(RRRRyooooooo[<span class="built_in">int</span>(char2) % <span class="number">45</span>] <span class="keyword">if</span> char2 <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decoded_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†æ•´ä¸ªè¿‡ç¨‹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_input</span>(<span class="params">input_bytes: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    step1 = reverse_RRRRyyooo(input_bytes.decode())</span><br><span class="line">    step2 = reverse_MMMMiiiiiio(step1, <span class="number">9</span>)</span><br><span class="line">    <span class="keyword">return</span> step2</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å¯†åçš„æ•°æ® sssssssssssss</span></span><br><span class="line">sssssssssssss = <span class="built_in">bytes</span>([<span class="number">57</span>, <span class="number">118</span>, <span class="number">33</span>, <span class="number">114</span>, <span class="number">68</span>, <span class="number">56</span>, <span class="number">117</span>, <span class="number">115</span>, <span class="number">34</span>, <span class="number">52</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">78</span>, <span class="number">40</span>, <span class="number">49</span>, <span class="number">59</span>, </span><br><span class="line"> <span class="number">95</span>, <span class="number">85</span>, <span class="number">63</span>, <span class="number">122</span>, <span class="number">54</span>, <span class="number">33</span>, <span class="number">77</span>, <span class="number">110</span>, <span class="number">49</span>, <span class="number">54</span>, <span class="number">34</span>, <span class="number">109</span>, <span class="number">106</span>, <span class="number">122</span>, <span class="number">60</span>, </span><br><span class="line"> <span class="number">92</span>, <span class="number">108</span>, <span class="number">91</span>, <span class="number">61</span>, <span class="number">51</span>, <span class="number">42</span>, <span class="number">62</span>, <span class="number">35</span>, <span class="number">38</span>, <span class="number">52</span>, <span class="number">67</span>, <span class="number">62</span>, <span class="number">122</span>, <span class="number">116</span>, <span class="number">48</span>, </span><br><span class="line"> <span class="number">76</span>, <span class="number">50</span>, <span class="number">67</span>, <span class="number">51</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">122</span>, <span class="number">45</span>, <span class="number">45</span>, <span class="number">51</span>, <span class="number">90</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†å¹¶è¾“å‡º</span></span><br><span class="line">decrypted_output = decrypt_input(sssssssssssss)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;è§£å¯†åçš„ç»“æœ: <span class="subst">&#123;decrypted_output&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="TimeSpaceRescue"><a href="#TimeSpaceRescue" class="headerlink" title="TimeSpaceRescue"></a>TimeSpaceRescue</h2><p>æ‹–å…¥ida</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">signed</span> <span class="type">int</span> v4; <span class="comment">// [esp+0h] [ebp-11Ch]</span></span><br><span class="line">    <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [esp+4h] [ebp-118h]</span></span><br><span class="line">    <span class="type">char</span> Str[<span class="number">256</span>]; <span class="comment">// [esp+8h] [ebp-114h] BYREF</span></span><br><span class="line">    <span class="type">int</span> Src[<span class="number">4</span>]; <span class="comment">// [esp+108h] [ebp-14h] BYREF</span></span><br><span class="line"></span><br><span class="line">    sub_B220E0(<span class="string">&quot;Before input the key, make sure you&#x27;re on the same spacetime as Liv.\n&quot;</span>);</span><br><span class="line">    sub_B220E0(<span class="string">&quot;Try your key:&quot;</span>);</span><br><span class="line">    <span class="built_in">memset</span>(Str, <span class="number">0</span>, <span class="keyword">sizeof</span>(Str));</span><br><span class="line">    sub_B22130(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">    <span class="built_in">memset</span>(Src, <span class="number">0</span>, <span class="keyword">sizeof</span>(Src));</span><br><span class="line">    initkey(Src);</span><br><span class="line">    v4 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">    aes(Src, <span class="number">0x10u</span>, Str, v4);</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v4; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ( Str[i] != byte_B26104[i] )</span><br><span class="line">        &#123;</span><br><span class="line">            sub_B220E0(<span class="string">&quot;Spacetime turbulence is detected, and rescue fails!\n&quot;</span>);</span><br><span class="line">            system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_B220E0(<span class="string">&quot;Congratulations on rescuing Liv and successfully protecting the world!\n&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…ˆé€ aesç”¨åˆ°çš„keyï¼Œç„¶ååŠ å¯†è¾“å…¥ï¼Œæ‰€ä»¥å…ˆçœ‹initkey</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_B21DD0</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">__time64_t</span> v1; <span class="comment">// rax</span></span><br><span class="line">  HANDLE CurrentProcess; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+0h] [ebp-28h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+4h] [ebp-24h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+8h] [ebp-20h]</span></span><br><span class="line">  <span class="type">__time64_t</span> Time; <span class="comment">// [esp+Ch] [ebp-1Ch] BYREF</span></span><br><span class="line">  BOOL pbDebuggerPresent; <span class="comment">// [esp+14h] [ebp-14h] BYREF</span></span><br><span class="line">  <span class="type">int</span> Src[<span class="number">3</span>]; <span class="comment">// [esp+18h] [ebp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  LODWORD(v1) = sub_B22180(<span class="number">0</span>);</span><br><span class="line">  Time = v1;</span><br><span class="line">  v4 = sub_B21F80(&amp;Time);</span><br><span class="line">  <span class="built_in">memset</span>(Src, <span class="number">0</span>, <span class="keyword">sizeof</span>(Src));</span><br><span class="line">  pbDebuggerPresent = <span class="number">0</span>;</span><br><span class="line">  CurrentProcess = GetCurrentProcess();</span><br><span class="line">  CheckRemoteDebuggerPresent(CurrentProcess, &amp;pbDebuggerPresent);</span><br><span class="line">  <span class="keyword">if</span> ( !pbDebuggerPresent )</span><br><span class="line">    <span class="built_in">memcpy</span>(Src, (v4 + <span class="number">12</span>), <span class="keyword">sizeof</span>(Src));</span><br><span class="line">  md5(Src, <span class="number">0xCu</span>, a1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i )</span><br><span class="line">    *(i + a1) ^= <span class="number">0x14u</span>;</span><br><span class="line">  result = <span class="number">11673238</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">16</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    result = j + a1;</span><br><span class="line">    *(j + a1) ^= <span class="number">0x11u</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°timeæˆ‘å°±æœ‰ä¸å¥½çš„é¢„æ„Ÿï¼Œæœç„¶æ˜¯æ ¹æ®æ—¶é—´æˆ³ï¼Œmd5åŠ å¯†ç”Ÿæˆkeyï¼Œè¿™é‡Œæœ‰ä¸ªç»†èŠ‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00B</span>21E8E                               loc_B21E8E:                             ; CODE XREF: initkey+<span class="number">96</span>â†‘j</span><br><span class="line">.text:<span class="number">00B</span>21E8E <span class="number">50</span>                            push    eax</span><br><span class="line">.text:<span class="number">00B</span>21E8F <span class="number">33</span> C0                         xor     eax, eax</span><br><span class="line">.text:<span class="number">00B</span>21E91 E8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                call    $+<span class="number">5</span></span><br><span class="line">.text:<span class="number">00B</span>21E91</span><br><span class="line">.text:<span class="number">00B</span>21E96 <span class="number">83</span> C0 <span class="number">05</span>                      add     eax, <span class="number">5</span></span><br><span class="line">.text:<span class="number">00B</span>21E99 <span class="number">83</span> C0 <span class="number">06</span>                      add     eax, <span class="number">6</span></span><br><span class="line">.text:<span class="number">00B</span>21E9C <span class="number">83</span> C0 <span class="number">07</span>                      add     eax, <span class="number">7</span></span><br><span class="line">.text:<span class="number">00B</span>21E9F D1 E0                         shl     eax, <span class="number">1</span></span><br><span class="line">.text:<span class="number">00B</span>21EA1 <span class="number">83</span> F0 <span class="number">02</span>                      xor     eax, <span class="number">2</span></span><br><span class="line">.text:<span class="number">00B</span>21EA4 <span class="number">83</span> C0 <span class="number">01</span>                      add     eax, <span class="number">1</span></span><br><span class="line">.text:<span class="number">00B</span>21EA7 <span class="number">83</span> F8 <span class="number">71</span>                      cmp     eax, <span class="number">71</span>h ; <span class="string">&#x27;q&#x27;</span></span><br><span class="line">.text:<span class="number">00B</span>21EAA <span class="number">74</span> <span class="number">01</span>                         jz      <span class="type">short</span> loc_B21EAD</span><br><span class="line">.text:<span class="number">00B</span>21EAA</span><br><span class="line">.text:<span class="number">00B</span>21EAC                               retn</span><br><span class="line">.text:<span class="number">00B</span>21EAC</span><br><span class="line">.text:<span class="number">00B</span>21EAD</span><br><span class="line">.text:<span class="number">00B</span>21EAD                               loc_B21EAD:</span><br></pre></td></tr></table></figure>

<p>æœ¬æ¥è¿™ä¸ªä½ç½®æ˜¯è¿”å›ï¼Œä½†æ˜¯çœ‹idaæ±‡ç¼–ä»£ç å°±ä¼šå‘ç°ï¼Œè¿™é‡Œæœ‰ç‚¹åƒèŠ±æŒ‡ä»¤ï¼Œå› ä¸ºå†è¿è¡Œçš„æ—¶å€™ä¼šå‘ç°è¿™ä¸ªåœ°æ–¹æ˜¯è¦è·³è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥nopäº†ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ°æˆ‘çš„é‚£ä¸ªä¼ªä»£ç ç•Œé¢äº†</p>
<p>æ‰€ä»¥è¿™ä¸ªå‡½æ•°å®ç°äº†ï¼Œmd5åŠ å¯†æ—¶é—´æˆ³ï¼Œç„¶åç®€å•åŠ å¯†ç”Ÿæˆkeyï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªæ—¶é—´æˆ³æ˜¯å¦èµ‹å€¼æ˜¯è¦æ ¹æ®æ˜¯å¦å¤„äºåè°ƒè¯•çš„ï¼‰æåˆ°è¿™é‡Œè¿˜æœ‰ä¸ªç»†èŠ‚ï¼Œè¿™ä¸ªç¨‹åºè‚¯å®šè¦å¤šæ¬¡è°ƒè¯•åšï¼Œç„¶åå°±ä¼šå‘ç°ï¼Œæ— è®ºæ€ä¹ˆå†mainä¸­ä¸‹æ–­ç‚¹éƒ½ä¼šé€€å‡ºç¨‹åºï¼Œæˆ‘ç›´æ¥å†startä¸‹æ–­ç‚¹è¿½æœ¬æº¯æºå‘ç°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">if</span> ( dword_B264DC )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    dword_B264DC = <span class="number">1</span>;</span><br><span class="line">    initterm(&amp;dword_B24110, &amp;dword_B24124);</span><br><span class="line">    dword_B264DC = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> __scrt_release_startup_lock(v10);</span><br><span class="line">  v2 = sub_B22C41();</span><br><span class="line">  v3 = v2;</span><br><span class="line">  <span class="keyword">if</span> ( *v2 &amp;&amp; __scrt_is_nonwritable_in_current_image(v2) )</span><br><span class="line">    (*v3)(*v3, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  v4 = sub_B22C47();</span><br><span class="line">  v5 = v4;</span><br><span class="line">  <span class="keyword">if</span> ( *v4 &amp;&amp; __scrt_is_nonwritable_in_current_image(v4) )</span><br><span class="line">    register_thread_local_exe_atexit_callback(*v5);</span><br><span class="line">  initial_narrow_environment = get_initial_narrow_environment();</span><br><span class="line">  v7 = *_p___argv();</span><br><span class="line">  v8 = _p___argc();</span><br><span class="line">  a1 = main(*v8, v7, initial_narrow_environment);</span><br><span class="line">  <span class="keyword">if</span> ( !sub_B22D6A() )</span><br><span class="line">LABEL_17:</span><br><span class="line">    <span class="built_in">exit</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( !v1 )</span><br><span class="line">    cexit();</span><br><span class="line">  __scrt_uninitialize_crt(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œæœ‰åè°ƒè¯•ï¼Œä¹Ÿå°±æ˜¯é‚£ä¸ªifåˆ¤æ–­ï¼Œæ¯ä¸€æ¬¡éƒ½è¦æ‰‹åŠ¨è·³è¿‡ä¸€ä¸‹ï¼Œå¥½çš„æ¥ä¸‹æ¥çœ‹aesäº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">aes</span><span class="params">(<span class="type">void</span> *Src, <span class="type">size_t</span> Size, <span class="type">char</span> *a3, <span class="type">unsigned</span> <span class="type">int</span> a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+10h] [ebp-19Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+14h] [ebp-198h]</span></span><br><span class="line">  <span class="type">char</span> *v7; <span class="comment">// [esp+18h] [ebp-194h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> k; <span class="comment">// [esp+1Ch] [ebp-190h]</span></span><br><span class="line">  <span class="type">char</span> *v9; <span class="comment">// [esp+20h] [ebp-18Ch]</span></span><br><span class="line">  <span class="type">char</span> v10[<span class="number">356</span>]; <span class="comment">// [esp+24h] [ebp-188h] BYREF</span></span><br><span class="line">  <span class="type">int</span> key[<span class="number">4</span>]; <span class="comment">// [esp+188h] [ebp-24h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v12[<span class="number">4</span>]; <span class="comment">// [esp+198h] [ebp-14h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v7 = a3;</span><br><span class="line">  v9 = v10;</span><br><span class="line">  <span class="built_in">memset</span>(key, <span class="number">0</span>, <span class="keyword">sizeof</span>(key));</span><br><span class="line">  <span class="built_in">memset</span>(v12, <span class="number">0</span>, <span class="keyword">sizeof</span>(v12));</span><br><span class="line">  <span class="keyword">if</span> ( Size &gt; <span class="number">0x10</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a4 % <span class="number">0x10</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">memcpy</span>(key, Src, Size);</span><br><span class="line">  de2(key);</span><br><span class="line">  sub_B21490(key, <span class="number">16</span>, v10);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a4; i += <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    de3(a3);</span><br><span class="line">    sub_B21750(v12, a3);</span><br><span class="line">    sub_B21170(v12, v10);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">1</span>; j &lt; <span class="number">10</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 += <span class="number">16</span>;</span><br><span class="line">      sub_B21B90(v12);</span><br><span class="line">      sub_B21990(v12);</span><br><span class="line">      sub_B217C0(v12);</span><br><span class="line">      sub_B21170(v12, v9);</span><br><span class="line">    &#125;</span><br><span class="line">    sub_B21B90(v12);</span><br><span class="line">    sub_B21990(v12);</span><br><span class="line">    sub_B21170(v12, v9 + <span class="number">16</span>);</span><br><span class="line">    sub_B21B30(v12, v7);</span><br><span class="line">    de2(v7);</span><br><span class="line">    v7 += <span class="number">16</span>;</span><br><span class="line">    a3 += <span class="number">16</span>;</span><br><span class="line">    v9 = v10;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( byte_B26100 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; a4; ++k )</span><br><span class="line">      a3[k] ^= <span class="number">0x11u</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»å…¸AES_EBCï¼Œä½†æ˜¯æœ‰å°é­”æ”¹ï¼Œæˆ‘æ ‡è®°æˆäº†de2å’Œde3ï¼ŒåŒæ ·çš„è¿™ä¸ªå‡½æ•°çš„æœ«å°¾ä¹Ÿæœ‰ä¸€ä¸ªå°èŠ±ï¼Œä¸è¿‡è§‚å¯Ÿå‘ç°ï¼Œa3ä¸€å…±åŠ äº†32å­—èŠ‚ï¼Œæ‰€ä»¥åé¢çš„å¼‚æˆ–æ˜¯ä¸å½±å“è¾“å…¥æ˜æ–‡çš„ï¼Œæœ€åä¸flagå¯¹æ¯”ï¼Œé€»è¾‘å°±æ¸…æ™°äº†</p>
<p>timeâ€”md5â€”&gt;keyâ€”de2â€”â€“AES-EBC</p>
<pre><code>               ^
</code></pre>
<p>inputâ€”de2â€”â€”â€” |</p>
<p>æ‰€ä»¥è¦ã€‚ã€‚ã€‚ã€‚ã€‚çˆ†ç ´æ—¶é—´ï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼Œ2024çš„æŸä¸€å¤©</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MD5_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MD5_H</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> count[<span class="number">2</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> state[<span class="number">4</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> buffer[<span class="number">64</span>];</span><br><span class="line">&#125;MD5_CTX;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> F(x,y,z) ((x &amp; y) | (~x &amp; z))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> G(x,y,z) ((x &amp; z) | (y &amp; ~z))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> H(x,y,z) (x^y^z)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> I(x,y,z) (y ^ (x | ~z))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROTATE_LEFT(x,n) ((x <span class="string">&lt;&lt; n) | (x &gt;</span>&gt; (32-n)))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FF(a,b,c,d,x,s,ac) \</span></span><br><span class="line"><span class="meta">          &#123; \</span></span><br><span class="line"><span class="meta">          a += F(b,c,d) + x + ac; \</span></span><br><span class="line"><span class="meta">          a = ROTATE_LEFT(a,s); \</span></span><br><span class="line"><span class="meta">          a += b; \</span></span><br><span class="line"><span class="meta">          &#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GG(a,b,c,d,x,s,ac) \</span></span><br><span class="line"><span class="meta">          &#123; \</span></span><br><span class="line"><span class="meta">          a += G(b,c,d) + x + ac; \</span></span><br><span class="line"><span class="meta">          a = ROTATE_LEFT(a,s); \</span></span><br><span class="line"><span class="meta">          a += b; \</span></span><br><span class="line"><span class="meta">          &#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HH(a,b,c,d,x,s,ac) \</span></span><br><span class="line"><span class="meta">          &#123; \</span></span><br><span class="line"><span class="meta">          a += H(b,c,d) + x + ac; \</span></span><br><span class="line"><span class="meta">          a = ROTATE_LEFT(a,s); \</span></span><br><span class="line"><span class="meta">          a += b; \</span></span><br><span class="line"><span class="meta">          &#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> II(a,b,c,d,x,s,ac) \</span></span><br><span class="line"><span class="meta">          &#123; \</span></span><br><span class="line"><span class="meta">          a += I(b,c,d) + x + ac; \</span></span><br><span class="line"><span class="meta">          a = ROTATE_LEFT(a,s); \</span></span><br><span class="line"><span class="meta">          a += b; \</span></span><br><span class="line"><span class="meta">          &#125;                                            </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Init</span><span class="params">(MD5_CTX* context)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Update</span><span class="params">(MD5_CTX* context, <span class="type">unsigned</span> <span class="type">char</span>* input, <span class="type">unsigned</span> <span class="type">int</span> inputlen)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Final</span><span class="params">(MD5_CTX* context, <span class="type">unsigned</span> <span class="type">char</span> digest[<span class="number">16</span>])</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Transform</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> state[<span class="number">4</span>], <span class="type">unsigned</span> <span class="type">char</span> block[<span class="number">64</span>])</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Encode</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* output, <span class="type">unsigned</span> <span class="type">int</span>* input, <span class="type">unsigned</span> <span class="type">int</span> len)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Decode</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* output, <span class="type">unsigned</span> <span class="type">char</span>* input, <span class="type">unsigned</span> <span class="type">int</span> len)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;md5.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> PADDING[] = &#123; <span class="number">0x80</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">						 <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">						 <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">						 <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Init</span><span class="params">(MD5_CTX* context)</span></span><br><span class="line">&#123;</span><br><span class="line">	context-&gt;count[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	context-&gt;count[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	context-&gt;state[<span class="number">0</span>] = <span class="number">0x67452301</span>;</span><br><span class="line">	context-&gt;state[<span class="number">1</span>] = <span class="number">0xEFCDAB89</span>;</span><br><span class="line">	context-&gt;state[<span class="number">2</span>] = <span class="number">0x98BADCFE</span>;</span><br><span class="line">	context-&gt;state[<span class="number">3</span>] = <span class="number">0x10325476</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Update</span><span class="params">(MD5_CTX* context, <span class="type">unsigned</span> <span class="type">char</span>* input, <span class="type">unsigned</span> <span class="type">int</span> inputlen)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>, index = <span class="number">0</span>, partlen = <span class="number">0</span>;</span><br><span class="line">	index = (context-&gt;count[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">	partlen = <span class="number">64</span> - index;</span><br><span class="line">	context-&gt;count[<span class="number">0</span>] += inputlen &lt;&lt; <span class="number">3</span>;</span><br><span class="line">	<span class="keyword">if</span> (context-&gt;count[<span class="number">0</span>] &lt; (inputlen &lt;&lt; <span class="number">3</span>))</span><br><span class="line">		context-&gt;count[<span class="number">1</span>]++;</span><br><span class="line">	context-&gt;count[<span class="number">1</span>] += inputlen &gt;&gt; <span class="number">29</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (inputlen &gt;= partlen)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">memcpy</span>(&amp;context-&gt;buffer[index], input, partlen);</span><br><span class="line">		MD5Transform(context-&gt;state, context-&gt;buffer);</span><br><span class="line">		<span class="keyword">for</span> (i = partlen; i + <span class="number">64</span> &lt;= inputlen; i += <span class="number">64</span>)</span><br><span class="line">			MD5Transform(context-&gt;state, &amp;input[i]);</span><br><span class="line">		index = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">memcpy</span>(&amp;context-&gt;buffer[index], &amp;input[i], inputlen - i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Final</span><span class="params">(MD5_CTX* context, <span class="type">unsigned</span> <span class="type">char</span> digest[<span class="number">16</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> index = <span class="number">0</span>, padlen = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> bits[<span class="number">8</span>];</span><br><span class="line">	index = (context-&gt;count[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">	padlen = (index &lt; <span class="number">56</span>) ? (<span class="number">56</span> - index) : (<span class="number">120</span> - index);</span><br><span class="line">	MD5Encode(bits, context-&gt;count, <span class="number">8</span>);</span><br><span class="line">	MD5Update(context, PADDING, padlen);</span><br><span class="line">	MD5Update(context, bits, <span class="number">8</span>);</span><br><span class="line">	MD5Encode(digest, context-&gt;state, <span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Encode</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* output, <span class="type">unsigned</span> <span class="type">int</span>* input, <span class="type">unsigned</span> <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (j &lt; len)</span><br><span class="line">	&#123;</span><br><span class="line">		output[j] = input[i] &amp; <span class="number">0xFF</span>;</span><br><span class="line">		output[j + <span class="number">1</span>] = (input[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">		output[j + <span class="number">2</span>] = (input[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">		output[j + <span class="number">3</span>] = (input[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">		i++;</span><br><span class="line">		j += <span class="number">4</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Decode</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* output, <span class="type">unsigned</span> <span class="type">char</span>* input, <span class="type">unsigned</span> <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (j &lt; len)</span><br><span class="line">	&#123;</span><br><span class="line">		output[i] = (input[j]) |</span><br><span class="line">			(input[j + <span class="number">1</span>] &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">			(input[j + <span class="number">2</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">			(input[j + <span class="number">3</span>] &lt;&lt; <span class="number">24</span>);</span><br><span class="line">		i++;</span><br><span class="line">		j += <span class="number">4</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MD5Transform</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> state[<span class="number">4</span>], <span class="type">unsigned</span> <span class="type">char</span> block[<span class="number">64</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> a = state[<span class="number">0</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> b = state[<span class="number">1</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> c = state[<span class="number">2</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> d = state[<span class="number">3</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> x[<span class="number">64</span>];</span><br><span class="line">	MD5Decode(x, block, <span class="number">64</span>);</span><br><span class="line">	FF(a, b, c, d, x[<span class="number">0</span>], <span class="number">7</span>, <span class="number">0xd76aa478</span>); <span class="comment">/* 1 */</span></span><br><span class="line">	FF(d, a, b, c, x[<span class="number">1</span>], <span class="number">12</span>, <span class="number">0xe8c7b756</span>); <span class="comment">/* 2 */</span></span><br><span class="line">	FF(c, d, a, b, x[<span class="number">2</span>], <span class="number">17</span>, <span class="number">0x242070db</span>); <span class="comment">/* 3 */</span></span><br><span class="line">	FF(b, c, d, a, x[<span class="number">3</span>], <span class="number">22</span>, <span class="number">0xc1bdceee</span>); <span class="comment">/* 4 */</span></span><br><span class="line">	FF(a, b, c, d, x[<span class="number">4</span>], <span class="number">7</span>, <span class="number">0xf57c0faf</span>); <span class="comment">/* 5 */</span></span><br><span class="line">	FF(d, a, b, c, x[<span class="number">5</span>], <span class="number">12</span>, <span class="number">0x4787c62a</span>); <span class="comment">/* 6 */</span></span><br><span class="line">	FF(c, d, a, b, x[<span class="number">6</span>], <span class="number">17</span>, <span class="number">0xa8304613</span>); <span class="comment">/* 7 */</span></span><br><span class="line">	FF(b, c, d, a, x[<span class="number">7</span>], <span class="number">22</span>, <span class="number">0xfd469501</span>); <span class="comment">/* 8 */</span></span><br><span class="line">	FF(a, b, c, d, x[<span class="number">8</span>], <span class="number">7</span>, <span class="number">0x698098d8</span>); <span class="comment">/* 9 */</span></span><br><span class="line">	FF(d, a, b, c, x[<span class="number">9</span>], <span class="number">12</span>, <span class="number">0x8b44f7af</span>); <span class="comment">/* 10 */</span></span><br><span class="line">	FF(c, d, a, b, x[<span class="number">10</span>], <span class="number">17</span>, <span class="number">0xffff5bb1</span>); <span class="comment">/* 11 */</span></span><br><span class="line">	FF(b, c, d, a, x[<span class="number">11</span>], <span class="number">22</span>, <span class="number">0x895cd7be</span>); <span class="comment">/* 12 */</span></span><br><span class="line">	FF(a, b, c, d, x[<span class="number">12</span>], <span class="number">7</span>, <span class="number">0x6b901122</span>); <span class="comment">/* 13 */</span></span><br><span class="line">	FF(d, a, b, c, x[<span class="number">13</span>], <span class="number">12</span>, <span class="number">0xfd987193</span>); <span class="comment">/* 14 */</span></span><br><span class="line">	FF(c, d, a, b, x[<span class="number">14</span>], <span class="number">17</span>, <span class="number">0xa679438e</span>); <span class="comment">/* 15 */</span></span><br><span class="line">	FF(b, c, d, a, x[<span class="number">15</span>], <span class="number">22</span>, <span class="number">0x49b40821</span>); <span class="comment">/* 16 */</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/* Round 2 */</span></span><br><span class="line">	GG(a, b, c, d, x[<span class="number">1</span>], <span class="number">5</span>, <span class="number">0xf61e2562</span>); <span class="comment">/* 17 */</span></span><br><span class="line">	GG(d, a, b, c, x[<span class="number">6</span>], <span class="number">9</span>, <span class="number">0xc040b340</span>); <span class="comment">/* 18 */</span></span><br><span class="line">	GG(c, d, a, b, x[<span class="number">11</span>], <span class="number">14</span>, <span class="number">0x265e5a51</span>); <span class="comment">/* 19 */</span></span><br><span class="line">	GG(b, c, d, a, x[<span class="number">0</span>], <span class="number">20</span>, <span class="number">0xe9b6c7aa</span>); <span class="comment">/* 20 */</span></span><br><span class="line">	GG(a, b, c, d, x[<span class="number">5</span>], <span class="number">5</span>, <span class="number">0xd62f105d</span>); <span class="comment">/* 21 */</span></span><br><span class="line">	GG(d, a, b, c, x[<span class="number">10</span>], <span class="number">9</span>, <span class="number">0x2441453</span>); <span class="comment">/* 22 */</span></span><br><span class="line">	GG(c, d, a, b, x[<span class="number">15</span>], <span class="number">14</span>, <span class="number">0xd8a1e681</span>); <span class="comment">/* 23 */</span></span><br><span class="line">	GG(b, c, d, a, x[<span class="number">4</span>], <span class="number">20</span>, <span class="number">0xe7d3fbc8</span>); <span class="comment">/* 24 */</span></span><br><span class="line">	GG(a, b, c, d, x[<span class="number">9</span>], <span class="number">5</span>, <span class="number">0x21e1cde6</span>); <span class="comment">/* 25 */</span></span><br><span class="line">	GG(d, a, b, c, x[<span class="number">14</span>], <span class="number">9</span>, <span class="number">0xc33707d6</span>); <span class="comment">/* 26 */</span></span><br><span class="line">	GG(c, d, a, b, x[<span class="number">3</span>], <span class="number">14</span>, <span class="number">0xf4d50d87</span>); <span class="comment">/* 27 */</span></span><br><span class="line">	GG(b, c, d, a, x[<span class="number">8</span>], <span class="number">20</span>, <span class="number">0x455a14ed</span>); <span class="comment">/* 28 */</span></span><br><span class="line">	GG(a, b, c, d, x[<span class="number">13</span>], <span class="number">5</span>, <span class="number">0xa9e3e905</span>); <span class="comment">/* 29 */</span></span><br><span class="line">	GG(d, a, b, c, x[<span class="number">2</span>], <span class="number">9</span>, <span class="number">0xfcefa3f8</span>); <span class="comment">/* 30 */</span></span><br><span class="line">	GG(c, d, a, b, x[<span class="number">7</span>], <span class="number">14</span>, <span class="number">0x676f02d9</span>); <span class="comment">/* 31 */</span></span><br><span class="line">	GG(b, c, d, a, x[<span class="number">12</span>], <span class="number">20</span>, <span class="number">0x8d2a4c8a</span>); <span class="comment">/* 32 */</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/* Round 3 */</span></span><br><span class="line">	HH(a, b, c, d, x[<span class="number">5</span>], <span class="number">4</span>, <span class="number">0xfffa3942</span>); <span class="comment">/* 33 */</span></span><br><span class="line">	HH(d, a, b, c, x[<span class="number">8</span>], <span class="number">11</span>, <span class="number">0x8771f681</span>); <span class="comment">/* 34 */</span></span><br><span class="line">	HH(c, d, a, b, x[<span class="number">11</span>], <span class="number">16</span>, <span class="number">0x6d9d6122</span>); <span class="comment">/* 35 */</span></span><br><span class="line">	HH(b, c, d, a, x[<span class="number">14</span>], <span class="number">23</span>, <span class="number">0xfde5380c</span>); <span class="comment">/* 36 */</span></span><br><span class="line">	HH(a, b, c, d, x[<span class="number">1</span>], <span class="number">4</span>, <span class="number">0xa4beea44</span>); <span class="comment">/* 37 */</span></span><br><span class="line">	HH(d, a, b, c, x[<span class="number">4</span>], <span class="number">11</span>, <span class="number">0x4bdecfa9</span>); <span class="comment">/* 38 */</span></span><br><span class="line">	HH(c, d, a, b, x[<span class="number">7</span>], <span class="number">16</span>, <span class="number">0xf6bb4b60</span>); <span class="comment">/* 39 */</span></span><br><span class="line">	HH(b, c, d, a, x[<span class="number">10</span>], <span class="number">23</span>, <span class="number">0xbebfbc70</span>); <span class="comment">/* 40 */</span></span><br><span class="line">	HH(a, b, c, d, x[<span class="number">13</span>], <span class="number">4</span>, <span class="number">0x289b7ec6</span>); <span class="comment">/* 41 */</span></span><br><span class="line">	HH(d, a, b, c, x[<span class="number">0</span>], <span class="number">11</span>, <span class="number">0xeaa127fa</span>); <span class="comment">/* 42 */</span></span><br><span class="line">	HH(c, d, a, b, x[<span class="number">3</span>], <span class="number">16</span>, <span class="number">0xd4ef3085</span>); <span class="comment">/* 43 */</span></span><br><span class="line">	HH(b, c, d, a, x[<span class="number">6</span>], <span class="number">23</span>, <span class="number">0x4881d05</span>); <span class="comment">/* 44 */</span></span><br><span class="line">	HH(a, b, c, d, x[<span class="number">9</span>], <span class="number">4</span>, <span class="number">0xd9d4d039</span>); <span class="comment">/* 45 */</span></span><br><span class="line">	HH(d, a, b, c, x[<span class="number">12</span>], <span class="number">11</span>, <span class="number">0xe6db99e5</span>); <span class="comment">/* 46 */</span></span><br><span class="line">	HH(c, d, a, b, x[<span class="number">15</span>], <span class="number">16</span>, <span class="number">0x1fa27cf8</span>); <span class="comment">/* 47 */</span></span><br><span class="line">	HH(b, c, d, a, x[<span class="number">2</span>], <span class="number">23</span>, <span class="number">0xc4ac5665</span>); <span class="comment">/* 48 */</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/* Round 4 */</span></span><br><span class="line">	II(a, b, c, d, x[<span class="number">0</span>], <span class="number">6</span>, <span class="number">0xf4292244</span>); <span class="comment">/* 49 */</span></span><br><span class="line">	II(d, a, b, c, x[<span class="number">7</span>], <span class="number">10</span>, <span class="number">0x432aff97</span>); <span class="comment">/* 50 */</span></span><br><span class="line">	II(c, d, a, b, x[<span class="number">14</span>], <span class="number">15</span>, <span class="number">0xab9423a7</span>); <span class="comment">/* 51 */</span></span><br><span class="line">	II(b, c, d, a, x[<span class="number">5</span>], <span class="number">21</span>, <span class="number">0xfc93a039</span>); <span class="comment">/* 52 */</span></span><br><span class="line">	II(a, b, c, d, x[<span class="number">12</span>], <span class="number">6</span>, <span class="number">0x655b59c3</span>); <span class="comment">/* 53 */</span></span><br><span class="line">	II(d, a, b, c, x[<span class="number">3</span>], <span class="number">10</span>, <span class="number">0x8f0ccc92</span>); <span class="comment">/* 54 */</span></span><br><span class="line">	II(c, d, a, b, x[<span class="number">10</span>], <span class="number">15</span>, <span class="number">0xffeff47d</span>); <span class="comment">/* 55 */</span></span><br><span class="line">	II(b, c, d, a, x[<span class="number">1</span>], <span class="number">21</span>, <span class="number">0x85845dd1</span>); <span class="comment">/* 56 */</span></span><br><span class="line">	II(a, b, c, d, x[<span class="number">8</span>], <span class="number">6</span>, <span class="number">0x6fa87e4f</span>); <span class="comment">/* 57 */</span></span><br><span class="line">	II(d, a, b, c, x[<span class="number">15</span>], <span class="number">10</span>, <span class="number">0xfe2ce6e0</span>); <span class="comment">/* 58 */</span></span><br><span class="line">	II(c, d, a, b, x[<span class="number">6</span>], <span class="number">15</span>, <span class="number">0xa3014314</span>); <span class="comment">/* 59 */</span></span><br><span class="line">	II(b, c, d, a, x[<span class="number">13</span>], <span class="number">21</span>, <span class="number">0x4e0811a1</span>); <span class="comment">/* 60 */</span></span><br><span class="line">	II(a, b, c, d, x[<span class="number">4</span>], <span class="number">6</span>, <span class="number">0xf7537e82</span>); <span class="comment">/* 61 */</span></span><br><span class="line">	II(d, a, b, c, x[<span class="number">11</span>], <span class="number">10</span>, <span class="number">0xbd3af235</span>); <span class="comment">/* 62 */</span></span><br><span class="line">	II(c, d, a, b, x[<span class="number">2</span>], <span class="number">15</span>, <span class="number">0x2ad7d2bb</span>); <span class="comment">/* 63 */</span></span><br><span class="line">	II(b, c, d, a, x[<span class="number">9</span>], <span class="number">21</span>, <span class="number">0xeb86d391</span>); <span class="comment">/* 64 */</span></span><br><span class="line">	state[<span class="number">0</span>] += a;</span><br><span class="line">	state[<span class="number">1</span>] += b;</span><br><span class="line">	state[<span class="number">2</span>] += c;</span><br><span class="line">	state[<span class="number">3</span>] += d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">FA</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">FB</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">FC</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">FD</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">FE</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Ff</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Cipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* input, <span class="type">unsigned</span> <span class="type">char</span>* output, <span class="type">unsigned</span> <span class="type">char</span>* w)</span>;<span class="comment">//åŠ å¯† </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">InvCipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* input, <span class="type">unsigned</span> <span class="type">char</span>* output, <span class="type">unsigned</span> <span class="type">char</span>* w)</span>;<span class="comment">//è§£å¯† </span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> AesSbox[<span class="number">16</span> * <span class="number">16</span>] =</span><br><span class="line">&#123;</span><br><span class="line">	<span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>,</span><br><span class="line">	<span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>,</span><br><span class="line">	<span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">	<span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>,</span><br><span class="line">	<span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>,</span><br><span class="line">	<span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>,</span><br><span class="line">	<span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>,</span><br><span class="line">	<span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>,</span><br><span class="line">	<span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>,</span><br><span class="line">	<span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>,</span><br><span class="line">	<span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>,</span><br><span class="line">	<span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>,</span><br><span class="line">	<span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>,</span><br><span class="line">	<span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>,</span><br><span class="line">	<span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> AesiSbox[<span class="number">16</span> * <span class="number">16</span>] =</span><br><span class="line">&#123;</span><br><span class="line">	<span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span>,</span><br><span class="line">	<span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span>,</span><br><span class="line">	<span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span>,</span><br><span class="line">	<span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span>,</span><br><span class="line">	<span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span>,</span><br><span class="line">	<span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span>,</span><br><span class="line">	<span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">	<span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span>,</span><br><span class="line">	<span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span>,</span><br><span class="line">	<span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span>,</span><br><span class="line">	<span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span>,</span><br><span class="line">	<span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span>,</span><br><span class="line">	<span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span>,</span><br><span class="line">	<span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">	<span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> AesRcon[<span class="number">11</span> * <span class="number">4</span>] =</span><br><span class="line">&#123;</span><br><span class="line">	<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x1b</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x36</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>  <span class="title function_">FA</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span> &#123; <span class="keyword">if</span> (b &lt; <span class="number">0x80</span>) <span class="keyword">return</span> (b &lt;&lt; <span class="number">1</span>);<span class="keyword">else</span> <span class="keyword">return</span> ((b &lt;&lt; <span class="number">1</span>) ^ (<span class="number">0x1b</span>)); &#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>  <span class="title function_">FB</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span> &#123; <span class="keyword">return</span>  FA(b) ^ b; &#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>  <span class="title function_">FC</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span> &#123; <span class="keyword">return</span>  FA(FA(FA(b))) ^ b; &#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>  <span class="title function_">FD</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span> &#123; <span class="keyword">return</span>  FA(FA(FA(b))) ^ FA(b) ^ b; &#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>  <span class="title function_">FE</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span> &#123; <span class="keyword">return</span>  FA(FA(FA(b))) ^ FA(FA(b)) ^ b; &#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>  <span class="title function_">Ff</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> b)</span> &#123; <span class="keyword">return</span>  FA(FA(FA(b))) ^ FA(FA(b)) ^ FA(b); &#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span>  <span class="title function_">Cipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* input, <span class="type">unsigned</span> <span class="type">char</span>* output, <span class="type">unsigned</span> <span class="type">char</span>* exp_key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line">	<span class="type">int</span> round;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> ttt[<span class="number">4</span> * <span class="number">4</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> State[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">16</span>;i++)  State[i % <span class="number">4</span>][i / <span class="number">4</span>] = input[i];</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = State[i][j] ^ exp_key[<span class="number">4</span> * j + i];</span><br><span class="line">	<span class="keyword">for</span> (round = <span class="number">1</span>; round &lt;= <span class="number">9</span>; round++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = AesSbox[State[i][j]];</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)ttt[<span class="number">4</span> * i + j] = State[i][j];</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span>;i &lt; <span class="number">4</span>;i++)<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (i == <span class="number">1</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">1</span>) % <span class="number">4</span>];<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">2</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">2</span>) % <span class="number">4</span>];<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">3</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">3</span>) % <span class="number">4</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)  <span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)	ttt[<span class="number">4</span> * i + j] = State[i][j];</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			State[<span class="number">0</span>][j] = FA(ttt[<span class="number">0</span> + j]) ^ FB(ttt[<span class="number">4</span> * <span class="number">1</span> + j]) ^ ttt[<span class="number">4</span> * <span class="number">2</span> + j] ^ ttt[<span class="number">4</span> * <span class="number">3</span> + j];</span><br><span class="line">			State[<span class="number">1</span>][j] = ttt[<span class="number">0</span> + j] ^ FA(ttt[<span class="number">4</span> * <span class="number">1</span> + j]) ^ FB(ttt[<span class="number">4</span> * <span class="number">2</span> + j]) ^ ttt[<span class="number">4</span> * <span class="number">3</span> + j];</span><br><span class="line">			State[<span class="number">2</span>][j] = ttt[<span class="number">0</span> + j] ^ ttt[<span class="number">4</span> * <span class="number">1</span> + j] ^ FA(ttt[<span class="number">4</span> * <span class="number">2</span> + j]) ^ FB(ttt[<span class="number">4</span> * <span class="number">3</span> + j]);</span><br><span class="line">			State[<span class="number">3</span>][j] = FB(ttt[<span class="number">0</span> + j]) ^ ttt[<span class="number">4</span> * <span class="number">1</span> + j] ^ ttt[<span class="number">4</span> * <span class="number">2</span> + j] ^ FA(ttt[<span class="number">4</span> * <span class="number">3</span> + j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = State[i][j] ^ exp_key[<span class="number">4</span> * ((round * <span class="number">4</span>) + j) + i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = AesSbox[State[i][j]];</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)ttt[<span class="number">4</span> * i + j] = State[i][j];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>;i &lt; <span class="number">4</span>;i++)<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (i == <span class="number">1</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">1</span>) % <span class="number">4</span>];<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">2</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">2</span>) % <span class="number">4</span>];<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">3</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">3</span>) % <span class="number">4</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = State[i][j] ^ exp_key[<span class="number">4</span> * (<span class="number">40</span> + j) + i];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)output[i] = State[i % <span class="number">4</span>][i / <span class="number">4</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Aesè§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="type">void</span>  <span class="title function_">InvCipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* input, <span class="type">unsigned</span> <span class="type">char</span>* output, <span class="type">unsigned</span> <span class="type">char</span>* exp_key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> round;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> ttt[<span class="number">4</span> * <span class="number">4</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> State[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)State[i % <span class="number">4</span>][i / <span class="number">4</span>] = input[i];</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = State[i][j] ^ exp_key[<span class="number">4</span> * (<span class="number">40</span> + j) + i];</span><br><span class="line">	<span class="keyword">for</span> (round = <span class="number">9</span>; round &gt;= <span class="number">1</span>; round--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)ttt[<span class="number">4</span> * i + j] = State[i][j];</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span>;i &lt; <span class="number">4</span>;i++)<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (i == <span class="number">1</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">3</span>) % <span class="number">4</span>];<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">2</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">2</span>) % <span class="number">4</span>];<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">3</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">1</span>) % <span class="number">4</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = AesiSbox[State[i][j]];</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = State[i][j] ^ exp_key[<span class="number">4</span> * ((round * <span class="number">4</span>) + j) + i];</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) ttt[<span class="number">4</span> * i + j] = State[i][j];</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			State[<span class="number">0</span>][j] = Ff(ttt[j]) ^ FD(ttt[<span class="number">4</span> + j]) ^ FE(ttt[<span class="number">4</span> * <span class="number">2</span> + j]) ^ FC(ttt[<span class="number">4</span> * <span class="number">3</span> + j]);</span><br><span class="line">			State[<span class="number">1</span>][j] = FC(ttt[j]) ^ Ff(ttt[<span class="number">4</span> + j]) ^ FD(ttt[<span class="number">4</span> * <span class="number">2</span> + j]) ^ FE(ttt[<span class="number">4</span> * <span class="number">3</span> + j]);</span><br><span class="line">			State[<span class="number">2</span>][j] = FE(ttt[j]) ^ FC(ttt[<span class="number">4</span> + j]) ^ Ff(ttt[<span class="number">4</span> * <span class="number">2</span> + j]) ^ FD(ttt[<span class="number">4</span> * <span class="number">3</span> + j]);</span><br><span class="line">			State[<span class="number">3</span>][j] = FD(ttt[j]) ^ FE(ttt[<span class="number">4</span> + j]) ^ FC(ttt[<span class="number">4</span> * <span class="number">2</span> + j]) ^ Ff(ttt[<span class="number">4</span> * <span class="number">3</span> + j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)ttt[<span class="number">4</span> * i + j] = State[i][j];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>;i &lt; <span class="number">4</span>;i++)<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (i == <span class="number">1</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">3</span>) % <span class="number">4</span>];<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">2</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">2</span>) % <span class="number">4</span>];<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">3</span>)State[i][j] = ttt[<span class="number">4</span> * i + (j + <span class="number">1</span>) % <span class="number">4</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = AesiSbox[State[i][j]];</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j++)<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)State[i][j] = State[i][j] ^ exp_key[<span class="number">4</span> * j + i];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)output[i] = State[i % <span class="number">4</span>][i / <span class="number">4</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*****************************************************</span></span><br><span class="line"><span class="comment">*å‡½æ•°åŠŸèƒ½: AESåŠ å¯†, æ¨¡å¼CBC,æ•°æ®å—128ä½,å¡«å……æ–¹å¼:pkcs5padding</span></span><br><span class="line"><span class="comment">* å‚æ•°:</span></span><br><span class="line"><span class="comment">* input_buff:éœ€è¦åŠ å¯†çš„æ•°ç»„æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">* InputLen:åŠ å¯†æ•°æ®çš„å­—èŠ‚é•¿åº¦</span></span><br><span class="line"><span class="comment">* p_key:   æŒ‡å‘å¯†é’¥æ•°æ®çš„æŒ‡é’ˆ,  1~16å­—èŠ‚é•¿åº¦</span></span><br><span class="line"><span class="comment">* output_buff:åŠ å¯†ç»“æœè¾“å‡ºæŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* è¿”å›å€¼: OutLength åŠ å¯†åçš„è¾“å‡ºé•¿åº¦</span></span><br><span class="line"><span class="comment">*********************************************************/</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">AES128_CBC_Encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* input_buff, <span class="type">unsigned</span> <span class="type">long</span> InputLen, <span class="type">unsigned</span> <span class="type">char</span>* p_key, <span class="type">unsigned</span> <span class="type">char</span>* output_buff, <span class="type">unsigned</span> <span class="type">char</span>* iv)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> OutLength = <span class="number">0</span>;</span><br><span class="line">	<span class="type">long</span> i, j;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* lpCurInBuff = input_buff;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* lpCurOutBuff = output_buff;</span><br><span class="line">	<span class="type">long</span> blocknum = InputLen / <span class="number">16</span>;</span><br><span class="line">	<span class="type">long</span> leftnum = InputLen % <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> row;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">4</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> ex_key[<span class="number">16</span> * <span class="number">15</span>];</span><br><span class="line">	<span class="keyword">for</span> (row = <span class="number">0</span>;row &lt; <span class="number">4</span>;row++)       <span class="comment">//æ‹·è´seed å¯†é’¥</span></span><br><span class="line">	&#123;</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">0</span>] = *(p_key + <span class="number">4</span> * row);</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">1</span>] = *(p_key + <span class="number">4</span> * row + <span class="number">1</span>);</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">2</span>] = *(p_key + <span class="number">4</span> * row + <span class="number">2</span>);</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">3</span>] = *(p_key + <span class="number">4</span> * row + <span class="number">3</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (row = <span class="number">4</span>;row &lt; <span class="number">44</span>;row++)</span><br><span class="line">	&#123;</span><br><span class="line">		temp[<span class="number">0</span>] = ex_key[<span class="number">4</span> * row - <span class="number">4</span>];     <span class="comment">//å½“å‰åˆ—çš„å‰ä¸€åˆ—  </span></span><br><span class="line">		temp[<span class="number">1</span>] = ex_key[<span class="number">4</span> * row - <span class="number">3</span>];</span><br><span class="line">		temp[<span class="number">2</span>] = ex_key[<span class="number">4</span> * row - <span class="number">2</span>];</span><br><span class="line">		temp[<span class="number">3</span>] = ex_key[<span class="number">4</span> * row - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (row % <span class="number">4</span> == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">char</span> exchange_buff = <span class="number">0</span>;</span><br><span class="line">			exchange_buff = temp[<span class="number">0</span>];</span><br><span class="line">			temp[<span class="number">0</span>] = AesSbox[<span class="number">16</span> * (temp[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>) + (temp[<span class="number">1</span>] &amp; <span class="number">0x0f</span>)];</span><br><span class="line">			temp[<span class="number">1</span>] = AesSbox[<span class="number">16</span> * (temp[<span class="number">2</span>] &gt;&gt; <span class="number">4</span>) + (temp[<span class="number">2</span>] &amp; <span class="number">0x0f</span>)];</span><br><span class="line">			temp[<span class="number">2</span>] = AesSbox[<span class="number">16</span> * (temp[<span class="number">3</span>] &gt;&gt; <span class="number">4</span>) + (temp[<span class="number">3</span>] &amp; <span class="number">0x0f</span>)];</span><br><span class="line">			temp[<span class="number">3</span>] = AesSbox[<span class="number">16</span> * (exchange_buff &gt;&gt; <span class="number">4</span>) + (exchange_buff &amp; <span class="number">0x0f</span>)];</span><br><span class="line"></span><br><span class="line">			temp[<span class="number">0</span>] = temp[<span class="number">0</span>] ^ AesRcon[<span class="number">4</span> * (row / <span class="number">4</span>) + <span class="number">0</span>];</span><br><span class="line">			temp[<span class="number">1</span>] = temp[<span class="number">1</span>] ^ AesRcon[<span class="number">4</span> * (row / <span class="number">4</span>) + <span class="number">1</span>];</span><br><span class="line">			temp[<span class="number">2</span>] = temp[<span class="number">2</span>] ^ AesRcon[<span class="number">4</span> * (row / <span class="number">4</span>) + <span class="number">2</span>];</span><br><span class="line">			temp[<span class="number">3</span>] = temp[<span class="number">3</span>] ^ AesRcon[<span class="number">4</span> * (row / <span class="number">4</span>) + <span class="number">3</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">0</span>] = ex_key[<span class="number">4</span> * (row - <span class="number">4</span>) + <span class="number">0</span>] ^ temp[<span class="number">0</span>];</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">1</span>] = ex_key[<span class="number">4</span> * (row - <span class="number">4</span>) + <span class="number">1</span>] ^ temp[<span class="number">1</span>];</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">2</span>] = ex_key[<span class="number">4</span> * (row - <span class="number">4</span>) + <span class="number">2</span>] ^ temp[<span class="number">2</span>];</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">3</span>] = ex_key[<span class="number">4</span> * (row - <span class="number">4</span>) + <span class="number">3</span>] ^ temp[<span class="number">3</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; blocknum;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)lpCurOutBuff[j] = lpCurInBuff[j] ^ iv[j];</span><br><span class="line">		Cipher(lpCurOutBuff, lpCurOutBuff, ex_key);</span><br><span class="line">		<span class="built_in">memcpy</span>(iv, lpCurOutBuff, <span class="number">16</span>);</span><br><span class="line">		lpCurInBuff += <span class="number">16</span>;</span><br><span class="line">		lpCurOutBuff += <span class="number">16</span>;</span><br><span class="line">		OutLength += <span class="number">16</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (leftnum)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">char</span> inbuff[<span class="number">16</span>];</span><br><span class="line">		<span class="built_in">memset</span>(inbuff, <span class="number">16</span> - leftnum, <span class="number">16</span>);</span><br><span class="line">		<span class="built_in">memcpy</span>(inbuff, lpCurInBuff, leftnum);</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)lpCurOutBuff[j] = inbuff[j] ^ iv[j];</span><br><span class="line">		Cipher(lpCurOutBuff, lpCurOutBuff, ex_key);</span><br><span class="line">		<span class="built_in">memcpy</span>(iv, lpCurOutBuff, <span class="number">16</span>);</span><br><span class="line">		lpCurOutBuff += <span class="number">16</span>;</span><br><span class="line">		OutLength += <span class="number">16</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">char</span> extrabuff[<span class="number">16</span>];</span><br><span class="line">		<span class="built_in">memset</span>(extrabuff, <span class="number">16</span>, <span class="number">16</span>);</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)lpCurOutBuff[j] = extrabuff[j] ^ iv[j];</span><br><span class="line">		Cipher(lpCurOutBuff, lpCurOutBuff, ex_key);</span><br><span class="line">		<span class="built_in">memcpy</span>(iv, lpCurOutBuff, <span class="number">16</span>);</span><br><span class="line">		OutLength += <span class="number">16</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> OutLength;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*******************************************************</span></span><br><span class="line"><span class="comment">*å‡½æ•°åŠŸèƒ½: AESè§£å¯†, æ¨¡å¼CBC,æ•°æ®å—128ä½,å¡«å……æ–¹å¼:pkcs5padding</span></span><br><span class="line"><span class="comment">* å‚æ•°:</span></span><br><span class="line"><span class="comment">* input_buff:éœ€è¦è§£å¯†çš„æ•°ç»„æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">* InputLen:éœ€è¦è§£å¯†æ•°æ®çš„å­—èŠ‚é•¿åº¦</span></span><br><span class="line"><span class="comment">* p_key:   æŒ‡å‘å¯†é’¥æ•°æ®çš„æŒ‡é’ˆ,  1~16å­—èŠ‚é•¿åº¦</span></span><br><span class="line"><span class="comment">* output_buff:åŠ å¯†ç»“æœè¾“å‡ºæŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* è¿”å›å€¼: OutLength åŠ å¯†åçš„è¾“å‡ºé•¿åº¦</span></span><br><span class="line"><span class="comment">********************************************************/</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">AES128_CBC_Decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* input_buff, <span class="type">unsigned</span> <span class="type">long</span> InputLen, <span class="type">unsigned</span> <span class="type">char</span>* p_key, <span class="type">unsigned</span> <span class="type">char</span>* output_buff, <span class="type">unsigned</span> <span class="type">char</span>* iv)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> OutLength = <span class="number">0</span>;</span><br><span class="line">	<span class="type">long</span> blocknum = InputLen / <span class="number">16</span>;</span><br><span class="line">	<span class="type">long</span> leftnum = InputLen % <span class="number">16</span>;</span><br><span class="line">	<span class="type">long</span> i, j;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* pCurInBuf = input_buff;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* pCurOutBuf = output_buff;</span><br><span class="line">	<span class="type">int</span> row;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> ex_key[<span class="number">16</span> * <span class="number">15</span>];</span><br><span class="line">	<span class="keyword">for</span> (row = <span class="number">0</span>;row &lt; <span class="number">4</span>;row++)</span><br><span class="line">	&#123;</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">0</span>] = *(p_key + <span class="number">4</span> * row);</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">1</span>] = *(p_key + <span class="number">4</span> * row + <span class="number">1</span>);</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">2</span>] = *(p_key + <span class="number">4</span> * row + <span class="number">2</span>);</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">3</span>] = *(p_key + <span class="number">4</span> * row + <span class="number">3</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (row = <span class="number">4</span>;row &lt; <span class="number">44</span>;row++)</span><br><span class="line">	&#123;</span><br><span class="line">		temp[<span class="number">0</span>] = ex_key[<span class="number">4</span> * row - <span class="number">4</span>];     <span class="comment">//å½“å‰åˆ—çš„å‰ä¸€åˆ—  </span></span><br><span class="line">		temp[<span class="number">1</span>] = ex_key[<span class="number">4</span> * row - <span class="number">3</span>];</span><br><span class="line">		temp[<span class="number">2</span>] = ex_key[<span class="number">4</span> * row - <span class="number">2</span>];</span><br><span class="line">		temp[<span class="number">3</span>] = ex_key[<span class="number">4</span> * row - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (row % <span class="number">4</span> == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">char</span> exchange_buff = <span class="number">0</span>;</span><br><span class="line">			exchange_buff = temp[<span class="number">0</span>];</span><br><span class="line">			temp[<span class="number">0</span>] = AesSbox[<span class="number">16</span> * (temp[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>) + (temp[<span class="number">1</span>] &amp; <span class="number">0x0f</span>)];</span><br><span class="line">			temp[<span class="number">1</span>] = AesSbox[<span class="number">16</span> * (temp[<span class="number">2</span>] &gt;&gt; <span class="number">4</span>) + (temp[<span class="number">2</span>] &amp; <span class="number">0x0f</span>)];</span><br><span class="line">			temp[<span class="number">2</span>] = AesSbox[<span class="number">16</span> * (temp[<span class="number">3</span>] &gt;&gt; <span class="number">4</span>) + (temp[<span class="number">3</span>] &amp; <span class="number">0x0f</span>)];</span><br><span class="line">			temp[<span class="number">3</span>] = AesSbox[<span class="number">16</span> * (exchange_buff &gt;&gt; <span class="number">4</span>) + (exchange_buff &amp; <span class="number">0x0f</span>)];</span><br><span class="line">			temp[<span class="number">0</span>] = temp[<span class="number">0</span>] ^ AesRcon[<span class="number">4</span> * (row / <span class="number">4</span>) + <span class="number">0</span>];</span><br><span class="line">			temp[<span class="number">1</span>] = temp[<span class="number">1</span>] ^ AesRcon[<span class="number">4</span> * (row / <span class="number">4</span>) + <span class="number">1</span>];</span><br><span class="line">			temp[<span class="number">2</span>] = temp[<span class="number">2</span>] ^ AesRcon[<span class="number">4</span> * (row / <span class="number">4</span>) + <span class="number">2</span>];</span><br><span class="line">			temp[<span class="number">3</span>] = temp[<span class="number">3</span>] ^ AesRcon[<span class="number">4</span> * (row / <span class="number">4</span>) + <span class="number">3</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">0</span>] = ex_key[<span class="number">4</span> * (row - <span class="number">4</span>) + <span class="number">0</span>] ^ temp[<span class="number">0</span>];</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">1</span>] = ex_key[<span class="number">4</span> * (row - <span class="number">4</span>) + <span class="number">1</span>] ^ temp[<span class="number">1</span>];</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">2</span>] = ex_key[<span class="number">4</span> * (row - <span class="number">4</span>) + <span class="number">2</span>] ^ temp[<span class="number">2</span>];</span><br><span class="line">		ex_key[<span class="number">4</span> * row + <span class="number">3</span>] = ex_key[<span class="number">4</span> * (row - <span class="number">4</span>) + <span class="number">3</span>] ^ temp[<span class="number">3</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; blocknum;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		InvCipher(pCurInBuf, pCurOutBuf, ex_key);</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			pCurOutBuf[j] = pCurOutBuf[j] ^ iv[j];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">memcpy</span>(iv, pCurInBuf, <span class="number">16</span>);</span><br><span class="line">		<span class="keyword">if</span> (i == (blocknum - <span class="number">1</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">			<span class="keyword">if</span> (pCurOutBuf[<span class="number">15</span>] != <span class="number">0x10</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (pCurOutBuf[<span class="number">15</span>] &lt; <span class="number">0x10</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					OutLength = InputLen - pCurOutBuf[<span class="number">15</span>];</span><br><span class="line">					<span class="built_in">memcpy</span>(temp, pCurOutBuf, <span class="number">16</span> - pCurOutBuf[<span class="number">15</span>]);</span><br><span class="line">					<span class="built_in">memcpy</span>(pCurOutBuf, temp, <span class="number">16</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				OutLength = InputLen - <span class="number">16</span>;</span><br><span class="line">				<span class="built_in">memcpy</span>(pCurOutBuf, temp, <span class="number">16</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		pCurInBuf += <span class="number">16</span>;</span><br><span class="line">		pCurOutBuf += <span class="number">16</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> OutLength;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">md5</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* encrypt,<span class="type">unsigned</span> <span class="type">char</span>* decrypt)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	MD5_CTX md5;</span><br><span class="line">	MD5Init(&amp;md5);</span><br><span class="line">	MD5Update(&amp;md5, encrypt, <span class="number">0xc</span>);</span><br><span class="line">	MD5Final(&amp;md5, decrypt);</span><br><span class="line">	<span class="comment">//for (i = 0; i &lt; 16; i++)</span></span><br><span class="line">	<span class="comment">//&#123;</span></span><br><span class="line">	<span class="comment">//	printf(&quot;%02x&quot;, decrypt[i]);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">initkey</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* a1, <span class="type">char</span> day, <span class="type">char</span> month)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> year = <span class="number">2024</span><span class="number">-1900</span>;</span><br><span class="line">	<span class="type">int</span> j; <span class="comment">// [esp+4h] [ebp-24h]</span></span><br><span class="line">	<span class="type">int</span> i; <span class="comment">// [esp+8h] [ebp-20h]</span></span><br><span class="line">	<span class="type">char</span> Src[<span class="number">12</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">// [esp+18h] [ebp-10h] BYREF</span></span><br><span class="line">	<span class="type">char</span>* src = Src;</span><br><span class="line">	<span class="built_in">memset</span>(Src, <span class="number">0</span>, <span class="keyword">sizeof</span>(Src));</span><br><span class="line">	Src[<span class="number">0</span>] = day;</span><br><span class="line">	Src[<span class="number">4</span>] = month - <span class="number">1</span>;</span><br><span class="line">	Src[<span class="number">8</span>] = year;</span><br><span class="line">	<span class="comment">//for (int i = 0; i &lt; 0xc; i++)</span></span><br><span class="line">	<span class="comment">//&#123;</span></span><br><span class="line">	<span class="comment">//	printf(&quot;%02x &quot;, Src[i]);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">	md5(Src, a1);</span><br><span class="line">	<span class="comment">//for (int i = 0; i &lt; 16; i++)</span></span><br><span class="line">	<span class="comment">//&#123;</span></span><br><span class="line">	<span class="comment">//	printf(&quot;%x &quot;, a1[i]);	</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i)</span><br><span class="line">		a1[i] ^= <span class="number">0x14u</span>;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">16</span>; ++j)</span><br><span class="line">		a1[j] ^= <span class="number">0x11u</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">de1</span><span class="params">(<span class="type">char</span>* flag)</span> &#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		flag[i] ^= <span class="number">0x11</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">de2</span><span class="params">(<span class="type">char</span>* a1)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+0h] [ebp-8h]</span></span><br><span class="line">	<span class="type">char</span> v2; <span class="comment">// [esp+7h] [ebp-1h]</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>; i += <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		v2 = a1[i] ^ <span class="number">5</span>;</span><br><span class="line">		a1[i] = a1[i + <span class="number">1</span>] ^ <span class="number">5</span>;</span><br><span class="line">		a1[i + <span class="number">1</span>] = v2;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">de3</span><span class="params">(<span class="type">char</span>* a1)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+0h] [ebp-Ch]</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// [esp+4h] [ebp-8h]</span></span><br><span class="line">	<span class="type">char</span> v3; <span class="comment">// [esp+Bh] [ebp-1h]</span></span><br><span class="line"></span><br><span class="line">	v2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">15</span>; v2 &lt; i; --i)</span><br><span class="line">	&#123;</span><br><span class="line">		v3 = a1[v2] ^ <span class="number">0xF</span>;</span><br><span class="line">		a1[v2] = a1[i] ^ <span class="number">0xF</span>;</span><br><span class="line">		a1[i] = v3;</span><br><span class="line">		++v2;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> day=<span class="number">6</span>, month=<span class="number">3</span>;</span><br><span class="line">	<span class="keyword">for</span> (month = <span class="number">0</span>; month &lt; <span class="number">13</span>; month++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> ( day = <span class="number">0</span>; day &lt; <span class="number">31</span>; day++)</span><br><span class="line">		&#123;</span><br><span class="line">			initkey(key, day, month);</span><br><span class="line">			de2(key);</span><br><span class="line">			<span class="comment">//for (int i = 0; i &lt; 16; i++)</span></span><br><span class="line">			<span class="comment">//&#123;</span></span><br><span class="line">			<span class="comment">//	printf(&quot;%x &quot;, key[i]);</span></span><br><span class="line">			<span class="comment">//&#125;</span></span><br><span class="line">			<span class="type">unsigned</span> <span class="type">char</span> iv[<span class="number">32</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">char</span> flag[] = &#123; <span class="number">0xCD</span>, <span class="number">0x16</span>, <span class="number">0xDB</span>, <span class="number">0xB5</span>, <span class="number">0xD1</span>, <span class="number">0x02</span>, <span class="number">0xA4</span>, <span class="number">0x82</span>, <span class="number">0x8E</span>, <span class="number">0x59</span>, <span class="number">0x73</span>, <span class="number">0x9E</span>, <span class="number">0x96</span>, <span class="number">0x26</span>, <span class="number">0x56</span>, <span class="number">0xF2</span>,</span><br><span class="line">									<span class="number">0x16</span>, <span class="number">0x8E</span>, <span class="number">0x46</span>, <span class="number">0xF2</span>, <span class="number">0x55</span>, <span class="number">0x7B</span>, <span class="number">0x92</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0xDC</span>, <span class="number">0xAA</span>, <span class="number">0x8A</span>, <span class="number">0xF3</span>, <span class="number">0x1C</span>, <span class="number">0xA0</span>, <span class="number">0xAA</span></span><br><span class="line">			&#125;;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">char</span> okflag[<span class="number">33</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">char</span>* f = flag;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">char</span>* ii = iv;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">char</span>* ff = okflag;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i+=<span class="number">16</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">//de1(f);</span></span><br><span class="line">				de2(f);</span><br><span class="line">				AES128_CBC_Decrypt(f, <span class="number">16</span>, key, ff, ii);</span><br><span class="line">				de3(ff);</span><br><span class="line">				f += <span class="number">16</span>;</span><br><span class="line">				ii += <span class="number">16</span>;</span><br><span class="line">				ff += <span class="number">16</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(okflag[<span class="number">0</span>]==<span class="string">&#x27;N&#x27;</span>&amp;&amp;okflag[<span class="number">1</span>]==<span class="string">&#x27;S&#x27;</span>) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n%d %d:&quot;</span>, month, day);</span><br><span class="line">				<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, okflag[i]);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">//NSSCTF&#123;W0w_Y0u&#x27;re_@n_AE5_M@5t3r&#125;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Room0"><a href="#Room0" class="headerlink" title="Room0"></a>Room0</h2><p>å¼‚å¸¸+SMC+rc4å˜</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+18h] [ebp-234h]</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+18h] [ebp-234h]</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [esp+18h] [ebp-234h]</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [esp+18h] [ebp-234h]</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// [esp+18h] [ebp-234h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+2Ch] [ebp-220h]</span></span><br><span class="line">  <span class="type">char</span> v10[<span class="number">256</span>]; <span class="comment">// [esp+30h] [ebp-21Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">256</span>]; <span class="comment">// [esp+130h] [ebp-11Ch] BYREF</span></span><br><span class="line">  CPPEH_RECORD ms_exc; <span class="comment">// [esp+234h] [ebp-18h]</span></span><br><span class="line"></span><br><span class="line">  ms_exc.registration.TryLevel = <span class="number">0</span>;</span><br><span class="line">  sub_4028C0(<span class="string">&quot;Welcome to the hostel!\n&quot;</span>, v4);</span><br><span class="line">  sub_4028C0(<span class="string">&quot;Please input your informatioin to enter your room.\n&quot;</span>, v5);</span><br><span class="line">  sub_4028C0(<span class="string">&quot;Input your flag:&quot;</span>, v6);</span><br><span class="line">  <span class="built_in">memset</span>(Str, <span class="number">0</span>, <span class="keyword">sizeof</span>(Str));</span><br><span class="line">  sub_402900(<span class="string">&quot;%s&quot;</span>, (<span class="type">char</span>)Str);</span><br><span class="line">  sub_4028C0(<span class="string">&quot;Input your Key:&quot;</span>, v7);</span><br><span class="line">  <span class="built_in">memset</span>(v10, <span class="number">0</span>, <span class="keyword">sizeof</span>(v10));</span><br><span class="line">  sub_402900(<span class="string">&quot;%s&quot;</span>, (<span class="type">char</span>)v10);</span><br><span class="line">  <span class="keyword">if</span> ( sub_402000(v10) != <span class="number">0x11451419</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_4028C0(<span class="string">&quot;Not the key.\n&quot;</span>, v8);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_402130(Str, <span class="number">0x19</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( Str[i] != (<span class="type">unsigned</span> __int8)byte_405000[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_4028C0(<span class="string">&quot;Your flag is incorrect.\n&quot;</span>, v8);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_4028C0(<span class="string">&quot;Welcome into your room\n&quot;</span>, v8);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥åˆ†ä¸¤ä¸ªä¸€ä¸ªkeyä¸€ä¸ªinputï¼Œçœ‹æ±‡ç¼–ç ä¼šå‘ç°<img src="/.io//tool\blog\source\postpic\ghctf2025\4.png" loading="lazy"></p>
<p>è¿™é‡Œæ˜¯æœ‰å¼‚å¸¸å¤„ç†çš„ï¼Œå¹¶ä¸”è¿˜æ˜¯æœ‰æ¨¡æœ‰æ ·åœ°ï¼Œä¸éš¾çŒœæµ‹ä¼šæœ‰åœ°æ–¹è§¦å‘å¼‚å¸¸ï¼Œè‚‰çœ¼å¯è§çš„æ²¡æœ‰ï¼Œå°±çœ‹çœ‹å‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_402000</span><span class="params">(<span class="type">char</span> *Str)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [esp+0h] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+4h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+8h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+Ch] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+10h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+10h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [esp+14h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+18h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = sub_402590(Str);</span><br><span class="line">  <span class="keyword">if</span> ( !v2 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v9 = v2;</span><br><span class="line">  v8 = HIBYTE(v2);</span><br><span class="line">  v5 = BYTE2(v2);</span><br><span class="line">  v4 = BYTE1(v2);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = v6 * (v8 + <span class="number">1415881080</span>) * (v9 - <span class="number">1467486175</span>) * ((v8 - v9) ^ (v8 &gt;&gt; <span class="number">4</span>));</span><br><span class="line">    v5 = (v9 + v5) ^ (<span class="number">8</span> * v4);</span><br><span class="line">    v4 = (v9 + v8) ^ (<span class="number">8</span> * v5);</span><br><span class="line">    v8 = (v9 + v4) ^ (<span class="number">8</span> * v5);</span><br><span class="line">    v9 -= v4 + v5 + v8;</span><br><span class="line">    v6 = v7 + (v8 + <span class="number">1467486175</span>) * (((v8 - v9) ^ (<span class="type">unsigned</span> __int64)(v8 &gt;&gt; <span class="number">4</span>)) / (<span class="type">unsigned</span> <span class="type">int</span>)(v9 - <span class="number">1415881080</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v9 ^ v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>&#x2F;-divï¼Œèƒ½å¤Ÿå¼•å‘é™¤é›¶å¼‚å¸¸ï¼Œæ‰€ä»¥è¿™é‡Œå¿…ç„¶ä¼šå¼•èµ·å¼‚å¸¸åˆ°å¼‚å¸¸å¤„ç†æ¨¡å—ï¼Œè¿™ä¹ˆä¸€çœ‹é¢˜ç›®åå­—room 0 åŸæ¥æ„æ€æ˜¯å¼‚å¸¸æç¤ºï¼ŒçœŸæ˜¯æ—è§‚è€…æ¸…å•Š</p>
<p>é‚£ä¹ˆçœ‹å¼‚å¸¸æ€ä¹ˆåšäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mov     esp, [ebp+ms_exc.old_esp]</span><br><span class="line">mov     ebx, [esp+224h+var_23C]</span><br><span class="line">mov     eax, ebp</span><br><span class="line">sub     eax, 21Ch</span><br><span class="line">push    eax             ; Str</span><br><span class="line">call    sub_402590</span><br><span class="line">push    eax</span><br><span class="line">call    loc_402410</span><br><span class="line">mov     eax, ebp</span><br><span class="line">sub     eax, 11Ch</span><br><span class="line">push    ebx</span><br><span class="line">push    eax</span><br><span class="line">call    sub_401000</span><br><span class="line">mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh</span><br></pre></td></tr></table></figure>

<p>ä¸‰ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªä¹‹å‰åœ¨éªŒè¯å‡½æ•°å°±å‡ºç°äº†ï¼Œæ˜¯asciiç è½¬16è¿›åˆ¶ï¼Œæ¯”å¦‚ä½ è¾“å…¥çš„æ˜¯1aï¼Œå°±ä¼šå˜æˆ0x1aï¼Œç±»ä¼¼äºpythonä»£ç çš„int(â€˜1aâ€™,16)å®ç°äº†</p>
<p>ç¬¬äºŒä¸ªå‡½æ•°æœ‰èŠ±æŒ‡ä»¤å»ä¸€ä¸‹</p>
<p><img src="/.io//tool\blog\source\postpic\ghctf2025\5.png" loading="lazy">è¿™é‡Œæ˜¯æ°¸çœŸä¸çˆ†çº¢èŠ±ï¼Œéœ€è¦æŠŠretnå»æ‰</p>
<p><img src="/.io//tool\blog\source\postpic\ghctf2025\6.png" loading="lazy">åé¢æ˜¯æ°¸çœŸè·³è½¬</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __stdcall <span class="title function_">sub_402410</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">    <span class="type">int</span> v2; <span class="comment">// [esp+10h] [ebp-30h]</span></span><br><span class="line">    <span class="type">char</span> *v3; <span class="comment">// [esp+18h] [ebp-28h]</span></span><br><span class="line">    <span class="type">int</span> j; <span class="comment">// [esp+20h] [ebp-20h]</span></span><br><span class="line">    __int16 v5; <span class="comment">// [esp+24h] [ebp-1Ch]</span></span><br><span class="line">    HMODULE ModuleHandleW; <span class="comment">// [esp+28h] [ebp-18h]</span></span><br><span class="line">    <span class="type">char</span> *Str1; <span class="comment">// [esp+2Ch] [ebp-14h]</span></span><br><span class="line">    <span class="type">int</span> i; <span class="comment">// [esp+30h] [ebp-10h]</span></span><br><span class="line">    <span class="type">int</span> k; <span class="comment">// [esp+34h] [ebp-Ch]</span></span><br><span class="line">    <span class="type">int</span> v10; <span class="comment">// [esp+38h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">    ModuleHandleW = GetModuleHandleW(<span class="number">0</span>);</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">        *((_BYTE *)&amp;v10 + i) = a1 &gt;&gt; (<span class="number">8</span> * (<span class="number">3</span> - i));</span><br><span class="line">    v5 = *(_WORD *)((<span class="type">char</span> *)ModuleHandleW + *((_DWORD *)ModuleHandleW + <span class="number">15</span>) + <span class="number">6</span>);</span><br><span class="line">    result = (<span class="type">int</span>)ModuleHandleW + *((_DWORD *)ModuleHandleW + <span class="number">15</span>) + <span class="number">248</span>;</span><br><span class="line">    Str1 = (<span class="type">char</span> *)result;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v5; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(Str1, <span class="string">&quot;.enc&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">            v2 = *((_DWORD *)Str1 + <span class="number">4</span>);</span><br><span class="line">            v3 = (<span class="type">char</span> *)ModuleHandleW + *((_DWORD *)Str1 + <span class="number">3</span>);</span><br><span class="line">            <span class="keyword">for</span> ( k = <span class="number">0</span>; ; ++k )</span><br><span class="line">            &#123;</span><br><span class="line">                result = k;</span><br><span class="line">                <span class="keyword">if</span> ( k &gt;= v2 )</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                v3[k] ^= *((_BYTE *)&amp;v10 + k % <span class="number">4</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        result = (<span class="type">int</span>)(Str1 + <span class="number">40</span>);</span><br><span class="line">        Str1 += <span class="number">40</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ£€æµ‹å½“å‰å—æ˜¯ä¸æ˜¯encï¼Œå¦‚æœæ˜¯çš„è¯å°±è¿›è¡ŒSMCï¼Œè§£å¯†è€ŒSMCå¼‚æˆ–çš„å¯¹è±¡å°±æ˜¯å‰é¢è¾“å…¥çš„keyï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œkeyåº”è¯¥æ˜¯å¤šå°‘å‘¢ï¼Œè¿™é‡Œæˆ‘åŠ¨è°ƒå‘ç°SMCè§£å¯†çš„å¯¹è±¡å°±æ˜¯ä¸‹ä¸€ä¸ªè¦è°ƒç”¨çš„å‡½æ•°ï¼Œå†å› ä¸ºä¸€èˆ¬å‡½æ•°çš„å¼€å¤´éƒ½æ˜¯55 8B EC ç¬¬å››ä¸ªæœ‰å¤šç§å¯èƒ½ï¼Œæˆ‘åæ¥å°è¯•å‘ç°å¯¹åº”å¼‚æˆ–åº”è¯¥æ˜¯d3ï¼Œå¹¶ä¸”</p>
<p><img src="/.io//tool\blog\source\postpic\ghctf2025\7.png" loading="lazy">æˆ‘ä»¬èƒ½å‘ç°ï¼Œè¿™ä¸ªå‡½æ•°åç»­éƒ½æ˜¯75 5f f0 d3å¹¶ä¸”æˆ‘è®¡ç®—å‡ºkeyçš„å‰å‡ ä½ä¹Ÿæ˜¯75 5f f0ï¼Œè¿™ä¹ŸéªŒè¯äº†ç¬¬å››ä½æ˜¯d3çš„æ€è·¯ï¼Œè¿™æ ·è¿™é‡ŒSMCè§£å¯†åå°±æ˜¯0äº†ï¼Œæ‰€ä»¥keyå°±æ˜¯755ff0d3</p>
<p>idcè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">start=<span class="number">0x00401000</span></span><br><span class="line">key=[<span class="number">0x75</span>, <span class="number">0x5F</span>, <span class="number">0xF0</span>, <span class="number">0xD3</span>]</span><br><span class="line">end=<span class="number">0x00401600</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(end-start):</span><br><span class="line">    patch_byte(start+i,get_wide_byte(start+i)^key[i%<span class="number">4</span>])</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¦‚æœæ˜¯åŠ¨è°ƒçœ‹çš„è¯æœ‰ä¸¤ç§èŠ±å„ä¸¤ä¸ªï¼Œä¸€ç§æ˜¯çˆ†çº¢çš„æ°¸çœŸè·³ï¼Œå¦ä¸€ç§æ˜¯ä¸çˆ†çº¢çš„èŠ±ï¼Œä½†æ˜¯å¦‚æœæ˜¯è„šæœ¬é™æ€çš„çœ‹å¥½åƒå°±ä¸æŠ¥é”™</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_401000</span><span class="params">(<span class="type">char</span> *Str, <span class="type">unsigned</span> <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> __int8 v2; <span class="comment">// al</span></span><br><span class="line">    <span class="type">char</span> v4; <span class="comment">// [esp-10h] [ebp-244h]</span></span><br><span class="line">    <span class="type">size_t</span> v5; <span class="comment">// [esp+0h] [ebp-234h]</span></span><br><span class="line">    <span class="type">char</span> v6; <span class="comment">// [esp+4h] [ebp-230h]</span></span><br><span class="line">    <span class="type">int</span> v7; <span class="comment">// [esp+8h] [ebp-22Ch]</span></span><br><span class="line">    <span class="type">int</span> ii; <span class="comment">// [esp+Ch] [ebp-228h]</span></span><br><span class="line">    <span class="type">size_t</span> n; <span class="comment">// [esp+10h] [ebp-224h]</span></span><br><span class="line">    <span class="type">int</span> k; <span class="comment">// [esp+14h] [ebp-220h]</span></span><br><span class="line">    <span class="type">int</span> j; <span class="comment">// [esp+18h] [ebp-21Ch]</span></span><br><span class="line">    <span class="type">int</span> m; <span class="comment">// [esp+1Ch] [ebp-218h]</span></span><br><span class="line">    <span class="type">int</span> i; <span class="comment">// [esp+20h] [ebp-214h]</span></span><br><span class="line">    <span class="type">char</span> v14; <span class="comment">// [esp+24h] [ebp-210h]</span></span><br><span class="line">    <span class="type">char</span> v15; <span class="comment">// [esp+25h] [ebp-20Fh]</span></span><br><span class="line">    <span class="type">unsigned</span> __int8 v16; <span class="comment">// [esp+26h] [ebp-20Eh]</span></span><br><span class="line">    <span class="type">unsigned</span> __int8 v17; <span class="comment">// [esp+27h] [ebp-20Dh]</span></span><br><span class="line">    <span class="type">char</span> v18[<span class="number">256</span>]; <span class="comment">// [esp+28h] [ebp-20Ch] BYREF</span></span><br><span class="line">    <span class="type">char</span> v19[<span class="number">256</span>]; <span class="comment">// [esp+128h] [ebp-10Ch] BYREF</span></span><br><span class="line">    <span class="type">int</span> v20[<span class="number">2</span>]; <span class="comment">// [esp+228h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">    v20[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    v20[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    v2 = (<span class="type">unsigned</span> __int8)<span class="built_in">memset</span>(v19, <span class="number">0</span>, <span class="keyword">sizeof</span>(v19));</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ( i &gt;= <span class="number">4</span> )</span><br><span class="line">            v6 = <span class="number">7</span> - i;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            v6 = i;</span><br><span class="line">        v2 = i;</span><br><span class="line">        *((_BYTE *)v20 + i) = a2 &gt;&gt; (<span class="number">8</span> * v6);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">        v2 = j;</span><br><span class="line">        v19[j] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    v4 = v2;</span><br><span class="line">    <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="keyword">sizeof</span>(v18));</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">256</span>; ++k )</span><br><span class="line">        v18[k] = *((_BYTE *)v20 + k % <span class="number">8</span>);</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">256</span>; ++m )</span><br><span class="line">    &#123;</span><br><span class="line">        v7 = ((<span class="type">unsigned</span> __int8)v18[m] + v7 + (<span class="type">unsigned</span> __int8)v19[m]) % <span class="number">256</span>;</span><br><span class="line">        v15 = v19[m];</span><br><span class="line">        v19[m] = v19[v7];</span><br><span class="line">        v19[v7] = v15;</span><br><span class="line">    &#125;</span><br><span class="line">    v17 = <span class="number">0</span>;</span><br><span class="line">    v16 = <span class="number">0</span>;</span><br><span class="line">    v5 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">    <span class="keyword">for</span> ( n = <span class="number">0</span>; n &lt; v5; ++n )</span><br><span class="line">    &#123;</span><br><span class="line">        v16 += v19[++v17];</span><br><span class="line">        v14 = v19[v17];</span><br><span class="line">        v19[v17] = v19[v16];</span><br><span class="line">        v19[v16] = v14;</span><br><span class="line">        Str[n] ^= *((_BYTE *)v20 + (v17 &amp; <span class="number">7</span>)) ^ v19[((<span class="type">unsigned</span> __int8)v19[v16] + (<span class="type">unsigned</span> __int8)v19[v17]) % <span class="number">256</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( ii = <span class="number">0</span>; ii &lt; <span class="number">32</span>; ++ii )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ( byte_405020[ii] != Str[ii] )</span><br><span class="line">        &#123;</span><br><span class="line">            sub_4028C0(<span class="string">&quot;You shouldn&#x27;t come here, get out of that room!\n&quot;</span>, v4);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºæ¥æ—¶rc4ï¼Œä½†æ˜¯å†rc4æœ€åä¸€æ­¥å¼‚æˆ–çš„æ—¶å€™å¤šå¼‚æˆ–äº†ä¸€ä¸ªkeyï¼Œé€»è¾‘å°±æ˜¯æŠŠa2 01233210çš„æ–¹å¼åŠ å€ç”Ÿæˆ8ä½keyï¼Œç„¶årc4ï¼Œæ‰€ä»¥ç°åœ¨åªéœ€è¦çŸ¥é“keyå°±å¯ä»¥è§£å¯†äº†ï¼ŒåŠ¨è°ƒçœ‹æŠŠ</p>
<p>åé¢æˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå¦‚æœé™¤é›¶å¼‚å¸¸æ—¶æ‰‹åŠ¨å°†div ecxé‡Œé¢çš„ecxæ”¹æˆäº†0ï¼Œåˆ™æœ€ç»ˆebxï¼Œä¹Ÿå°±æ˜¯a2ä¼ å‚å°±æ˜¯0ï¼Œä½†å¦‚æœæ˜¯æ­£å¸¸çš„è¾“å…¥æ­£ç¡®keyç„¶åè¿è¡Œè¿‡ç¨‹ä¸­çˆ†é™¤é›¶å¼‚å¸¸ï¼Œé‚£ä¹ˆebxå°±ä¼šæ˜¯æ­£ç¡®çš„key</p>
<p><img src="/.io//tool\blog\source\postpic\ghctf2025\8.png" loading="lazy"><img src="/.io//tool\blog\source\postpic\ghctf2025\9.png" loading="lazy"></p>
<p>å¯ä»¥çœ‹åˆ°å¦‚æœæ˜¯æ­£å¸¸è¾“å…¥çš„è¯ï¼Œi&#x3D;&#x3D;0xfçš„æ—¶å€™ä¼šå˜æˆ0ï¼Œè¿™æ—¶å€™<img src="/.io//tool\blog\source\postpic\ghctf2025\11.png" loading="lazy"></p>
<p>ebxä¼šæ˜¯æ­£ç¡®keyï¼Œå¤§æ¦‚èƒ½çŒœåˆ°ï¼Œè¿™é‡Œçš„ebxå°±æ˜¯ä¹‹å‰é‚£äº›è®¡ç®—ç•™ä¸‹æ¥çš„æ•°</p>
<p>è§£é¢˜è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> keybox[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="comment">//æ ‡å‡†RC4</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> keyk[<span class="number">8</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">int</span> key_Len, <span class="type">unsigned</span> <span class="type">char</span>* data, <span class="type">int</span> data_Len)</span> <span class="comment">//åŠ è§£å¯†</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span>  <span class="type">char</span> s[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* ps = s;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">256</span>;i++) &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        j = (j + s[i] + keybox[i]) % <span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; <span class="comment">//äº¤æ¢s[i]å’Œs[j]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> q = <span class="number">0</span>;</span><br><span class="line">    i = j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (q = <span class="number">0</span>;q &lt; data_Len;q++) &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + s[i]) % <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; <span class="comment">//äº¤æ¢s[x]å’Œs[y]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t = (s[i] + s[j]) % <span class="number">256</span>;</span><br><span class="line">        data[q] ^= s[t]^ keyk[i % <span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> flag[] = &#123;</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0xC4</span>, <span class="number">0xA0</span>, <span class="number">0x5A</span>, <span class="number">0xDE</span>, <span class="number">0xED</span>, <span class="number">0x62</span>, <span class="number">0x5E</span>, <span class="number">0x25</span>, <span class="number">0xE2</span>, <span class="number">0x6D</span>, <span class="number">0xA6</span>, <span class="number">0x05</span>, <span class="number">0xA7</span>, <span class="number">0x20</span>, <span class="number">0x8D</span>,</span><br><span class="line">    <span class="number">0x7D</span>, <span class="number">0x99</span>, <span class="number">0x52</span>, <span class="number">0x3E</span>, <span class="number">0x8C</span>, <span class="number">0xA7</span>, <span class="number">0x7F</span>, <span class="number">0xFA</span>, <span class="number">0x09</span>, <span class="number">0xD8</span>, <span class="number">0x62</span>, <span class="number">0xDB</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0xC2</span>, <span class="number">0xA9</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//10E70D20C9D7B5FF171710364C502E6A0EFF70CEF380835E605587810080C2A9A9</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key = <span class="number">0xF86D35D4</span>;</span><br><span class="line">    <span class="comment">//755FF0D3</span></span><br><span class="line">    <span class="type">char</span> v6;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= <span class="number">4</span>)</span><br><span class="line">            v6 = <span class="number">7</span> - i;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            v6 = i;</span><br><span class="line">        keyk[i] = key &gt;&gt; (<span class="number">8</span> * v6);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//for (i = 0; i &lt; 8; i++)</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    printf(&quot;%x &quot;, keyk[i]);</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        keybox[i] = keyk[i % <span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    rc4(keyk, <span class="number">8</span>, flag, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//NSSCTF&#123;Int3r3st1ng_5MC_Pr0gr@m?&#125;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="canno"><a href="#canno" class="headerlink" title="canno"></a>canno</h2><p>å°±æ˜¯è€ƒåŠ è§£å¯†çš„ï¼Œæ‹–è¿›ida</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">    __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">    __int64 v4; <span class="comment">// r8</span></span><br><span class="line">    __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">    __int64 v7; <span class="comment">// r8</span></span><br><span class="line">    <span class="type">int</span> j; <span class="comment">// [rsp+20h] [rbp-1F8h]</span></span><br><span class="line">    <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp-1F4h]</span></span><br><span class="line">    <span class="type">int</span> v10; <span class="comment">// [rsp+28h] [rbp-1F0h]</span></span><br><span class="line">    <span class="type">int</span> v11[<span class="number">4</span>]; <span class="comment">// [rsp+30h] [rbp-1E8h]</span></span><br><span class="line">    __int64 v12; <span class="comment">// [rsp+40h] [rbp-1D8h]</span></span><br><span class="line">    __int64 v13; <span class="comment">// [rsp+48h] [rbp-1D0h]</span></span><br><span class="line">    __int64 v14; <span class="comment">// [rsp+50h] [rbp-1C8h]</span></span><br><span class="line">    <span class="type">int</span> v15[<span class="number">8</span>]; <span class="comment">// [rsp+58h] [rbp-1C0h]</span></span><br><span class="line">    <span class="type">int</span> v16[<span class="number">4</span>]; <span class="comment">// [rsp+78h] [rbp-1A0h]</span></span><br><span class="line">    <span class="type">char</span> input1[<span class="number">12</span>]; <span class="comment">// [rsp+88h] [rbp-190h] BYREF</span></span><br><span class="line">    <span class="type">char</span> input2[<span class="number">12</span>]; <span class="comment">// [rsp+94h] [rbp-184h] BYREF</span></span><br><span class="line">    <span class="type">char</span> input3[<span class="number">16</span>]; <span class="comment">// [rsp+A0h] [rbp-178h] BYREF</span></span><br><span class="line">    <span class="type">char</span> i1[<span class="number">112</span>]; <span class="comment">// [rsp+B0h] [rbp-168h] BYREF</span></span><br><span class="line">    <span class="type">char</span> i2[<span class="number">112</span>]; <span class="comment">// [rsp+120h] [rbp-F8h] BYREF</span></span><br><span class="line">    <span class="type">char</span> i3[<span class="number">112</span>]; <span class="comment">// [rsp+190h] [rbp-88h] BYREF</span></span><br><span class="line"></span><br><span class="line">    sub_7FF68C1A2470(<span class="string">&quot;Enter the flag: &quot;</span>, argv, envp);</span><br><span class="line">    sub_7FF68C1A24F0(<span class="string">&quot;%36s&quot;</span>, input1);             <span class="comment">// aaaaaaaaaaaabbbbbbbbbbbbcccccccccccc</span></span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(input1) == <span class="number">0x24</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">strncpy</span>(i1, input1, <span class="number">0xCu</span>i64);</span><br><span class="line">        v12 = <span class="number">12</span>i64;</span><br><span class="line">        i1[<span class="number">12</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">strncpy</span>(i2, input2, <span class="number">0xCu</span>i64);</span><br><span class="line">        v13 = <span class="number">12</span>i64;</span><br><span class="line">        i2[<span class="number">12</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">strncpy</span>(i3, input3, <span class="number">0xCu</span>i64);</span><br><span class="line">        v14 = <span class="number">12</span>i64;</span><br><span class="line">        i3[<span class="number">12</span>] = <span class="number">0</span>;                                 <span class="comment">// åˆ†ä¸‰ä»½</span></span><br><span class="line">        v15[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        v15[<span class="number">1</span>] = <span class="number">5</span>;</span><br><span class="line">        v15[<span class="number">2</span>] = <span class="number">6</span>;</span><br><span class="line">        v15[<span class="number">3</span>] = <span class="number">3</span>;</span><br><span class="line">        v15[<span class="number">4</span>] = <span class="number">4</span>;</span><br><span class="line">        v15[<span class="number">5</span>] = <span class="number">1</span>;</span><br><span class="line">        v15[<span class="number">6</span>] = <span class="number">4</span>;</span><br><span class="line">        v15[<span class="number">7</span>] = <span class="number">5</span>;</span><br><span class="line">        v16[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        v16[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        v16[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line">        v11[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        v11[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        v11[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j )</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> ( i &gt;= v16[j] )</span><br><span class="line">                &#123;</span><br><span class="line">                    v10 = v11[j];</span><br><span class="line">                    <span class="keyword">if</span> ( v10 &lt; <span class="number">8</span> )</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> ( j )</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span> ( j == <span class="number">1</span> )</span><br><span class="line">                            &#123;</span><br><span class="line">                                crypt(i2, i3, v15[v10]);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> <span class="keyword">if</span> ( j == <span class="number">2</span> )</span><br><span class="line">                            &#123;</span><br><span class="line">                                crypt(i3, i1, v15[v10]);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            crypt(i1, i2, v15[v10]);</span><br><span class="line">                        &#125;</span><br><span class="line">                        ++v11[j];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(i1, <span class="string">&quot;WgvDmssEvcY326bHo3nNro3vXvvfmgrz&quot;</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(i2, <span class="string">&quot;gX+Ri9PG=bt5=00B6hscPQOL&quot;</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(i3, <span class="string">&quot;T6bHgUPL2gXUd=xT=FNHtPzV&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">            sub_7FF68C1A2470(<span class="string">&quot;Congratulations! You have found the flag!\n&quot;</span>, v6, v7);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            sub_7FF68C1A2470(<span class="string">&quot;Invalid flag!\n&quot;</span>, v6, v7);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        sub_7FF68C1A2470(<span class="string">&quot;Invalid flag!\n&quot;</span>, v3, v4);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠè¾“å…¥æ‹†æˆä¸‰éƒ¨åˆ†(i1,i2,i3)ï¼Œç„¶åæ ¹æ® j 012å†³å®šè°åškeyè°åšå¯†æ–‡ï¼Œçœ‹åŠ å¯†å‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">crypt</span><span class="params">(<span class="type">char</span> *a1, <span class="type">const</span> <span class="type">char</span> *a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-F8h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp-F4h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> lena1; <span class="comment">// [rsp+28h] [rbp-F0h]</span></span><br><span class="line">  <span class="type">int</span> num6; <span class="comment">// [rsp+2Ch] [rbp-ECh]</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// [rsp+30h] [rbp-E8h]</span></span><br><span class="line">  <span class="type">int</span> m; <span class="comment">// [rsp+34h] [rbp-E4h]</span></span><br><span class="line">  <span class="type">int</span> n; <span class="comment">// [rsp+38h] [rbp-E0h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i1; <span class="comment">// [rsp+3Ch] [rbp-DCh]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+40h] [rbp-D8h]</span></span><br><span class="line">  <span class="type">int</span> ii; <span class="comment">// [rsp+44h] [rbp-D4h]</span></span><br><span class="line">  <span class="type">int</span> jj; <span class="comment">// [rsp+48h] [rbp-D0h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v18; <span class="comment">// [rsp+4Ch] [rbp-CCh]</span></span><br><span class="line">  <span class="type">int</span> nn; <span class="comment">// [rsp+50h] [rbp-C8h]</span></span><br><span class="line">  <span class="type">int</span> kk; <span class="comment">// [rsp+54h] [rbp-C4h]</span></span><br><span class="line">  <span class="type">int</span> lena2; <span class="comment">// [rsp+58h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [rsp+5Ch] [rbp-BCh]</span></span><br><span class="line">  <span class="type">int</span> mm; <span class="comment">// [rsp+60h] [rbp-B8h]</span></span><br><span class="line">  <span class="type">char</span> **Block; <span class="comment">// [rsp+68h] [rbp-B0h]</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// [rsp+7Ch] [rbp-9Ch]</span></span><br><span class="line">  <span class="type">int</span> *a1_1; <span class="comment">// [rsp+88h] [rbp-90h]</span></span><br><span class="line">  <span class="type">int</span> *out2; <span class="comment">// [rsp+90h] [rbp-88h]</span></span><br><span class="line">  <span class="type">int</span> *out; <span class="comment">// [rsp+98h] [rbp-80h]</span></span><br><span class="line">  <span class="type">char</span> *Source; <span class="comment">// [rsp+A0h] [rbp-78h]</span></span><br><span class="line">  <span class="type">char</span> *v30; <span class="comment">// [rsp+A8h] [rbp-70h]</span></span><br><span class="line">  <span class="type">char</span> *v31; <span class="comment">// [rsp+B0h] [rbp-68h]</span></span><br><span class="line">  <span class="type">int</span> num[<span class="number">12</span>]; <span class="comment">// [rsp+B8h] [rbp-60h]</span></span><br><span class="line">  __int64 v33; <span class="comment">// [rsp+E8h] [rbp-30h]</span></span><br><span class="line">  __int64 v34; <span class="comment">// [rsp+F0h] [rbp-28h]</span></span><br><span class="line"></span><br><span class="line">  lena1 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  lena2 = <span class="built_in">strlen</span>(a2);</span><br><span class="line">  <span class="keyword">switch</span> ( a3 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; lena1; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        v22 = a2[i % lena2];</span><br><span class="line">        <span class="keyword">if</span> ( a1[i] &lt; <span class="number">65</span> || a1[i] &gt; <span class="number">90</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( a1[i] &lt; <span class="number">97</span> || a1[i] &gt; <span class="number">122</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( a1[i] &gt;= <span class="number">48</span> &amp;&amp; a1[i] &lt;= <span class="number">57</span> )</span><br><span class="line">              a1[i] = (a1[i] + v22 - <span class="number">48</span>) % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            a1[i] = (a1[i] + v22 - <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          a1[i] = (a1[i] + v22 - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      num[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">      num[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">      num[<span class="number">2</span>] = <span class="number">5</span>;</span><br><span class="line">      num[<span class="number">3</span>] = <span class="number">7</span>;</span><br><span class="line">      num[<span class="number">4</span>] = <span class="number">9</span>;</span><br><span class="line">      num[<span class="number">5</span>] = <span class="number">11</span>;</span><br><span class="line">      num[<span class="number">6</span>] = <span class="number">15</span>;</span><br><span class="line">      num[<span class="number">7</span>] = <span class="number">17</span>;</span><br><span class="line">      num[<span class="number">8</span>] = <span class="number">19</span>;</span><br><span class="line">      num[<span class="number">9</span>] = <span class="number">21</span>;</span><br><span class="line">      num[<span class="number">10</span>] = <span class="number">23</span>;</span><br><span class="line">      num[<span class="number">11</span>] = <span class="number">25</span>;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; lena1; ++j )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( a1[j] &lt; <span class="number">65</span> || a1[j] &gt; <span class="number">90</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( a1[j] &gt;= <span class="number">97</span> &amp;&amp; a1[j] &lt;= <span class="number">122</span> )</span><br><span class="line">            a1[j] = (a2[j % lena2] + num[j % <span class="number">12</span>] * (a1[j] - <span class="number">97</span>)) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          a1[j] = (a2[j % lena2] + num[j % <span class="number">12</span>] * (a1[j] - <span class="number">65</span>)) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      num6 = *a2 % <span class="number">10</span> + <span class="number">2</span>;</span><br><span class="line">      v33 = num6;</span><br><span class="line">      Block = <span class="built_in">malloc</span>(saturated_mul(num6, <span class="number">8u</span>i64));</span><br><span class="line">      <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; num6; ++k )</span><br><span class="line">      &#123;</span><br><span class="line">        Block[k] = <span class="built_in">malloc</span>(lena1 + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">memset</span>(Block[k], <span class="number">0</span>, lena1 + <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> ( m = <span class="number">0</span>; num6 * m &lt; lena1; ++m )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">for</span> ( n = <span class="number">0</span>; n &lt; num6 &amp;&amp; n + num6 * m &lt; lena1; ++n )</span><br><span class="line">          Block[n][m] = a1[n + num6 * m];</span><br><span class="line">      &#125;</span><br><span class="line">      v18 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> ( ii = <span class="number">0</span>; ii &lt; num6; ++ii )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">for</span> ( jj = <span class="number">0</span>; jj &lt; m; ++jj )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( Block[ii][jj] &amp;&amp; v18 &lt; lena1 )</span><br><span class="line">            a1[v18++] = Block[ii][jj];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      a1[v18] = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> ( kk = <span class="number">0</span>; kk &lt; num6; ++kk )</span><br><span class="line">        <span class="built_in">free</span>(Block[kk]);</span><br><span class="line">      <span class="built_in">free</span>(Block);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">      v25 = *a2 % <span class="number">10</span> + <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">for</span> ( mm = <span class="number">0</span>; mm &lt; v25; ++mm )</span><br><span class="line">      &#123;</span><br><span class="line">        v11 = a1[lena1 - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> ( nn = lena1 - <span class="number">1</span>; nn &gt; <span class="number">0</span>; --nn )</span><br><span class="line">          a1[nn] = a1[nn - <span class="number">1</span>];</span><br><span class="line">        *a1 = v11;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">      v34 = lena1;</span><br><span class="line">      a1_1 = <span class="built_in">malloc</span>(saturated_mul(lena1, <span class="number">4u</span>i64));</span><br><span class="line">      <span class="keyword">for</span> ( i1 = <span class="number">0</span>; i1 &lt; lena1; ++i1 )</span><br><span class="line">        a1_1[i1] = (a2[i1 % lena2] + <span class="number">57</span>) ^ a1[i1];</span><br><span class="line">      Source = base64(a1_1, lena1);</span><br><span class="line">      <span class="built_in">strcpy</span>(a1, Source);</span><br><span class="line">      <span class="built_in">free</span>(a1_1);</span><br><span class="line">      <span class="built_in">free</span>(Source);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">      v3 = saturated_mul(<span class="built_in">strlen</span>(a1), <span class="number">4u</span>i64);</span><br><span class="line">      out2 = <span class="built_in">malloc</span>(v3);</span><br><span class="line">      rc4(a1, a2, out2);</span><br><span class="line">      v4 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">      v30 = base64(out2, v4);</span><br><span class="line">      <span class="built_in">strcpy</span>(a1, v30);</span><br><span class="line">      <span class="built_in">free</span>(out2);</span><br><span class="line">      <span class="built_in">free</span>(v30);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">      v5 = saturated_mul(<span class="built_in">strlen</span>(a1), <span class="number">4u</span>i64);</span><br><span class="line">      out = <span class="built_in">malloc</span>(v5);</span><br><span class="line">      rc4_0(a1, a2, out);</span><br><span class="line">      v6 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">      v31 = base64(out, v6);</span><br><span class="line">      <span class="built_in">strcpy</span>(a1, v31);</span><br><span class="line">      <span class="built_in">free</span>(out);</span><br><span class="line">      <span class="built_in">free</span>(v31);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æ ¹æ®å‰æ–‡çš„v15æ¥å†³å®šè¿™é‡Œæ˜¯å“ªç§åŠ å¯†ï¼Œä¸€å…±7ç§caseï¼Œæ‰€ä»¥å…ˆæ¨¡æ‹Ÿå‡ºæ¯ä¸€ç§çš„jå¯¹åº”çš„caseï¼Œç„¶åå†™æ¯ä¸€ç§çš„è§£å¯†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>* <span class="title function_">base64_encode</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str0)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* str = (<span class="type">unsigned</span> <span class="type">char</span>*)str0;	<span class="comment">//è½¬ä¸ºunsigned charæ— ç¬¦å·,ç§»ä½æ“ä½œæ—¶å¯ä»¥é˜²æ­¢é”™è¯¯</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> base64_map[] = <span class="string">&quot;stuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqr&quot;</span>;<span class="comment">//æ•°ç»„å½¢å¼,æ–¹ä¾¿ä¿®æ”¹</span></span><br><span class="line">	<span class="type">long</span> len;				<span class="comment">//base64å¤„ç†åçš„å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">	<span class="type">long</span> str_len;			<span class="comment">//æºå­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">	<span class="type">long</span> flag;				<span class="comment">//ç”¨äºæ ‡è¯†æ¨¡3åçš„ä½™æ•°</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* res;		<span class="comment">//è¿”å›çš„å­—ç¬¦ä¸²</span></span><br><span class="line">	str_len = <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span>*)str);</span><br><span class="line">	<span class="keyword">switch</span> (str_len % <span class="number">3</span>)	<span class="comment">//åˆ¤æ–­æ¨¡3çš„ä½™æ•°</span></span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">0</span>:flag = <span class="number">0</span>; len = str_len / <span class="number">3</span> * <span class="number">4</span>; <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:flag = <span class="number">1</span>; len = (str_len / <span class="number">3</span> + <span class="number">1</span>) * <span class="number">4</span>; <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:flag = <span class="number">2</span>; len = (str_len / <span class="number">3</span> + <span class="number">1</span>) * <span class="number">4</span>; <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	res = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * len + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; j &lt; str_len - flag; j += <span class="number">3</span>, i += <span class="number">4</span>)<span class="comment">//å…ˆå¤„ç†æ•´é™¤éƒ¨åˆ†</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//æ³¨æ„&amp;è¿ç®—å’Œä½ç§»è¿ç®—çš„ä¼˜å…ˆçº§,æ˜¯å…ˆä½ç§»åä¸æˆ–é</span></span><br><span class="line">		res[i] = base64_map[str[j] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">		res[i + <span class="number">1</span>] = base64_map[(str[j] &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span> | str[j + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>];</span><br><span class="line">		res[i + <span class="number">2</span>] = base64_map[(str[j + <span class="number">1</span>] &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">2</span> | (str[j + <span class="number">2</span>] &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">		res[i + <span class="number">3</span>] = base64_map[str[j + <span class="number">2</span>] &amp; <span class="number">0x3f</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//ä¸æ»¡è¶³è¢«ä¸‰æ•´é™¤æ—¶,è¦çŸ«æ­£</span></span><br><span class="line">	<span class="keyword">switch</span> (flag)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">0</span>:<span class="keyword">break</span>;	<span class="comment">//æ»¡è¶³æ—¶ç›´æ¥é€€å‡º</span></span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:res[len - <span class="number">4</span>] = base64_map[str[str_len - <span class="number">1</span>] &gt;&gt; <span class="number">2</span>];	<span class="comment">//åªå‰©ä¸€ä¸ªå­—ç¬¦æ—¶,å³ç§»ä¸¤ä½å¾—åˆ°é«˜å…­ä½</span></span><br><span class="line">		res[len - <span class="number">3</span>] = base64_map[(str[str_len - <span class="number">1</span>] &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span>];<span class="comment">//è·å¾—ä½äºŒä½å†å³ç§»å››ä½,è‡ªåŠ¨è¡¥0</span></span><br><span class="line">		res[len - <span class="number">2</span>] = res[len - <span class="number">1</span>] = <span class="string">&#x27;=&#x27;</span>; <span class="keyword">break</span>;				<span class="comment">//æœ€åä¸¤ä¸ªè¡¥=</span></span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		res[len - <span class="number">4</span>] = base64_map[str[str_len - <span class="number">2</span>] &gt;&gt; <span class="number">2</span>];				<span class="comment">//å‰©ä¸¤ä¸ªå­—ç¬¦æ—¶,å³ç§»ä¸¤ä½å¾—é«˜å…­ä½</span></span><br><span class="line">		res[len - <span class="number">3</span>] = base64_map[(str[str_len - <span class="number">2</span>] &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span> | str[str_len - <span class="number">1</span>] &gt;&gt; <span class="number">4</span>];	<span class="comment">//ç¬¬ä¸€ä¸ªå­—ç¬¦ä½äºŒä½å’Œç¬¬äºŒä¸ªå­—ç¬¦é«˜å››ä½</span></span><br><span class="line">		res[len - <span class="number">2</span>] = base64_map[(str[str_len - <span class="number">1</span>] &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">2</span>];	<span class="comment">//ç¬¬äºŒä¸ªå­—ç¬¦ä½å››ä½,å·¦ç§»ä¸¤ä½è‡ªåŠ¨è¡¥0</span></span><br><span class="line">		res[len - <span class="number">1</span>] = <span class="string">&#x27;=&#x27;</span>;											<span class="comment">//æœ€åä¸€ä¸ªè¡¥=</span></span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	res[len] = <span class="string">&#x27;\0&#x27;</span>;	<span class="comment">//è¡¥ä¸Šå­—ç¬¦ä¸²ç»“æŸæ ‡è¯†</span></span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">findPos</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span>* base64_map, <span class="type">unsigned</span> <span class="type">char</span> c)</span><span class="comment">//æŸ¥æ‰¾ä¸‹æ ‡æ‰€åœ¨ä½ç½®</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span>*)base64_map); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (base64_map[i] == c)</span><br><span class="line">			<span class="keyword">return</span> i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">base64_decode</span><span class="params">(<span class="type">char</span>* code0)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* code = (<span class="type">unsigned</span> <span class="type">char</span>*)code0;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> base64_map[] = <span class="string">&quot;stuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqr&quot;</span>;</span><br><span class="line">	<span class="type">long</span> len, str_len, flag = <span class="number">0</span>;</span><br><span class="line">	<span class="type">char</span>* res;</span><br><span class="line">	len = <span class="built_in">strlen</span>((<span class="type">char</span>*)code);</span><br><span class="line">	<span class="keyword">if</span> (code[len - <span class="number">1</span>] == <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (code[len - <span class="number">2</span>] == <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			flag = <span class="number">1</span>;</span><br><span class="line">			str_len = len / <span class="number">4</span> * <span class="number">3</span> - <span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			flag = <span class="number">2</span>;</span><br><span class="line">			str_len = len / <span class="number">4</span> * <span class="number">3</span> - <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		str_len = len / <span class="number">4</span> * <span class="number">3</span>;</span><br><span class="line">	res = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * str_len + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; j &lt; str_len - flag; j += <span class="number">3</span>, i += <span class="number">4</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">4</span>];</span><br><span class="line">		a[<span class="number">0</span>] = findPos(base64_map, code[i]);		<span class="comment">//code[]æ¯ä¸€ä¸ªå­—ç¬¦å¯¹åº”base64è¡¨ä¸­çš„ä½ç½®,ç”¨ä½ç½®å€¼åæ¨åŸå§‹æ•°æ®å€¼</span></span><br><span class="line">		a[<span class="number">1</span>] = findPos(base64_map, code[i + <span class="number">1</span>]);</span><br><span class="line">		a[<span class="number">2</span>] = findPos(base64_map, code[i + <span class="number">2</span>]);</span><br><span class="line">		a[<span class="number">3</span>] = findPos(base64_map, code[i + <span class="number">3</span>]);</span><br><span class="line">		res[j] = a[<span class="number">0</span>] &lt;&lt; <span class="number">2</span> | a[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>;		<span class="comment">//å–å‡ºç¬¬ä¸€ä¸ªå­—ç¬¦å¯¹åº”base64è¡¨çš„åè¿›åˆ¶æ•°çš„å‰6ä½ä¸ç¬¬äºŒä¸ªå­—ç¬¦å¯¹åº”base64è¡¨çš„åè¿›åˆ¶æ•°çš„å2ä½è¿›è¡Œç»„åˆ  </span></span><br><span class="line">		res[j + <span class="number">1</span>] = a[<span class="number">1</span>] &lt;&lt; <span class="number">4</span> | a[<span class="number">2</span>] &gt;&gt; <span class="number">2</span>;	<span class="comment">//å–å‡ºç¬¬äºŒä¸ªå­—ç¬¦å¯¹åº”base64è¡¨çš„åè¿›åˆ¶æ•°çš„å4ä½ä¸ç¬¬ä¸‰ä¸ªå­—ç¬¦å¯¹åº”bas464è¡¨çš„åè¿›åˆ¶æ•°çš„å4ä½è¿›è¡Œç»„åˆ  </span></span><br><span class="line">		res[j + <span class="number">2</span>] = a[<span class="number">2</span>] &lt;&lt; <span class="number">6</span> | a[<span class="number">3</span>];	   <span class="comment">//å–å‡ºç¬¬ä¸‰ä¸ªå­—ç¬¦å¯¹åº”base64è¡¨çš„åè¿›åˆ¶æ•°çš„å2ä½ä¸ç¬¬4ä¸ªå­—ç¬¦è¿›è¡Œç»„åˆ </span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> (flag)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">char</span> a[<span class="number">1024</span>];</span><br><span class="line">	<span class="keyword">case</span> <span class="number">0</span>:<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		a[<span class="number">0</span>] = findPos(base64_map, code[len - <span class="number">4</span>]);</span><br><span class="line">		a[<span class="number">1</span>] = findPos(base64_map, code[len - <span class="number">3</span>]);</span><br><span class="line">		res[str_len - <span class="number">1</span>] = a[<span class="number">0</span>] &lt;&lt; <span class="number">2</span> | a[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">		a[<span class="number">0</span>] = findPos(base64_map, code[len - <span class="number">4</span>]);</span><br><span class="line">		a[<span class="number">1</span>] = findPos(base64_map, code[len - <span class="number">3</span>]);</span><br><span class="line">		a[<span class="number">2</span>] = findPos(base64_map, code[len - <span class="number">2</span>]);</span><br><span class="line">		res[str_len - <span class="number">2</span>] = a[<span class="number">0</span>] &lt;&lt; <span class="number">2</span> | a[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">		res[str_len - <span class="number">1</span>] = a[<span class="number">1</span>] &lt;&lt; <span class="number">4</span> | a[<span class="number">2</span>] &gt;&gt; <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	res[str_len] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">	<span class="built_in">memcpy</span>(code0, res, str_len);</span><br><span class="line">	<span class="keyword">return</span> str_len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> __fastcall <span class="title function_">rc41</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* a1, <span class="type">const</span> <span class="type">char</span>* a2, <span class="type">unsigned</span> <span class="type">int</span>* a3, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">	__int64 v3; <span class="comment">// kr00_8</span></span><br><span class="line">	<span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-438h]</span></span><br><span class="line">	<span class="type">int</span> j; <span class="comment">// [rsp+20h] [rbp-438h]</span></span><br><span class="line">	<span class="type">int</span> v6; <span class="comment">// [rsp+20h] [rbp-438h]</span></span><br><span class="line">	<span class="type">int</span> v7; <span class="comment">// [rsp+24h] [rbp-434h]</span></span><br><span class="line">	<span class="type">int</span> v8; <span class="comment">// [rsp+24h] [rbp-434h]</span></span><br><span class="line">	<span class="type">int</span> k; <span class="comment">// [rsp+28h] [rbp-430h]</span></span><br><span class="line">	<span class="type">int</span> v10; <span class="comment">// [rsp+30h] [rbp-428h]</span></span><br><span class="line">	<span class="type">int</span> v11; <span class="comment">// [rsp+34h] [rbp-424h]</span></span><br><span class="line">	<span class="type">int</span> v12[<span class="number">258</span>]; <span class="comment">// [rsp+50h] [rbp-408h]</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a3[i] = a1[i];</span><br><span class="line">	&#125;</span><br><span class="line">	v7 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i)</span><br><span class="line">		v12[i] = i;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j)</span><br><span class="line">	&#123;</span><br><span class="line">		v3 = a2[j % <span class="built_in">strlen</span>(a2)] + v12[j] + v7;</span><br><span class="line">		v7 = v3 % <span class="number">256</span>;</span><br><span class="line">		v10 = v12[j];</span><br><span class="line">		v12[j] = v12[v7];</span><br><span class="line">		v12[v7] = v10;</span><br><span class="line">	&#125;</span><br><span class="line">	v8 = <span class="number">0</span>;</span><br><span class="line">	v6 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (k = <span class="number">0</span>; k&lt;size; ++k)</span><br><span class="line">	&#123;</span><br><span class="line">		v6 = (v6 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">		v8 = (v12[v6] + v8) % <span class="number">256</span>;</span><br><span class="line">		v11 = v12[v6];</span><br><span class="line">		v12[v6] = v12[v8];</span><br><span class="line">		v12[v8] = v11;</span><br><span class="line">		a1[k] = v12[(v12[v6] + v12[v8]) % <span class="number">256</span>] ^ (a3[k] - <span class="number">57</span> + <span class="number">256</span>) % <span class="number">256</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> __fastcall <span class="title function_">rc42</span><span class="params">(<span class="type">char</span>* a1, <span class="type">const</span> <span class="type">char</span>* a2, <span class="type">int</span>* a3, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">	__int64 v3; <span class="comment">// kr00_8</span></span><br><span class="line">	<span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-438h]</span></span><br><span class="line">	<span class="type">int</span> j; <span class="comment">// [rsp+20h] [rbp-438h]</span></span><br><span class="line">	<span class="type">int</span> v6; <span class="comment">// [rsp+20h] [rbp-438h]</span></span><br><span class="line">	<span class="type">int</span> v7; <span class="comment">// [rsp+24h] [rbp-434h]</span></span><br><span class="line">	<span class="type">int</span> v8; <span class="comment">// [rsp+24h] [rbp-434h]</span></span><br><span class="line">	<span class="type">int</span> k; <span class="comment">// [rsp+28h] [rbp-430h]</span></span><br><span class="line">	<span class="type">int</span> v10; <span class="comment">// [rsp+30h] [rbp-428h]</span></span><br><span class="line">	<span class="type">int</span> v11; <span class="comment">// [rsp+34h] [rbp-424h]</span></span><br><span class="line">	<span class="type">int</span> v12[<span class="number">258</span>]; <span class="comment">// [rsp+50h] [rbp-408h]</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a3[i] = a1[i];</span><br><span class="line">	&#125;</span><br><span class="line">	v7 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i)</span><br><span class="line">		v12[i] = i;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j)</span><br><span class="line">	&#123;</span><br><span class="line">		v3 = a2[j % <span class="built_in">strlen</span>(a2)] + v12[j] + v7;</span><br><span class="line">		v7 = v3 % <span class="number">256</span>;</span><br><span class="line">		v10 = v12[j];</span><br><span class="line">		v12[j] = v12[v7];</span><br><span class="line">		v12[v7] = v10;</span><br><span class="line">	&#125;</span><br><span class="line">	v8 = <span class="number">0</span>;</span><br><span class="line">	v6 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; size; ++k)</span><br><span class="line">	&#123;</span><br><span class="line">		v6 = (v6 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">		v8 = (v12[v6] + v8) % <span class="number">256</span>;</span><br><span class="line">		v11 = v12[v6];</span><br><span class="line">		v12[v6] = v12[v8];</span><br><span class="line">		v12[v8] = v11;</span><br><span class="line">		a1[k] = v12[(v12[v8] + v12[v6]) % <span class="number">256</span>] ^ a3[k] ^ <span class="number">0x39</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt_case1</span><span class="params">(<span class="type">char</span>* a1, <span class="type">const</span> <span class="type">char</span>* a2)</span> &#123;</span><br><span class="line">	<span class="type">int</span> lena1 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">	<span class="type">int</span> lena2 = <span class="built_in">strlen</span>(a2);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lena1; ++i) &#123;</span><br><span class="line">		<span class="type">int</span> key = a2[i % lena2];</span><br><span class="line">		<span class="keyword">if</span> (a1[i] &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; a1[i] &lt;= <span class="string">&#x27;Z&#x27;</span>) &#123;</span><br><span class="line">			a1[i] = (a1[i] - (key % <span class="number">26</span>) - <span class="string">&#x27;A&#x27;</span> + <span class="number">26</span>) % <span class="number">26</span> + <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (a1[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; a1[i] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">			a1[i] = (a1[i] - (key % <span class="number">26</span>) - <span class="string">&#x27;a&#x27;</span> + <span class="number">26</span>) % <span class="number">26</span> + <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (a1[i] &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; a1[i] &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">			a1[i] = (a1[i] - (key % <span class="number">10</span>) - <span class="string">&#x27;0&#x27;</span> + <span class="number">10</span>) % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt_case2</span><span class="params">(<span class="type">char</span>* a1, <span class="type">const</span> <span class="type">char</span>* a2)</span> &#123;</span><br><span class="line">	<span class="type">int</span> num_inv[] = &#123; <span class="number">1</span>,<span class="number">9</span>,<span class="number">21</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">19</span>,<span class="number">7</span>,<span class="number">23</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">17</span>,<span class="number">25</span> &#125;;</span><br><span class="line">	<span class="type">int</span> lena1 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">	<span class="type">int</span> lena2 = <span class="built_in">strlen</span>(a2);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; lena1; ++j) &#123;</span><br><span class="line">		<span class="type">char</span> base = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (a1[j] &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; a1[j] &lt;= <span class="string">&#x27;Z&#x27;</span>) &#123;</span><br><span class="line">			base = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (a1[j] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; a1[j] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">			base = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		<span class="type">int</span> inv = num_inv[j % <span class="number">12</span>];</span><br><span class="line">		<span class="type">int</span> shift = a2[j % lena2];</span><br><span class="line">		<span class="type">int</span> val = (a1[j] - base - shift + <span class="number">26</span>) % <span class="number">26</span>;</span><br><span class="line">		a1[j] = (val * inv) % <span class="number">26</span> + base;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt_case3</span><span class="params">(<span class="type">char</span>* a1, <span class="type">const</span> <span class="type">char</span>* a2)</span> &#123;</span><br><span class="line">	<span class="type">int</span> lena1 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">	<span class="type">int</span> v10 = a2[<span class="number">0</span>] % <span class="number">10</span> + <span class="number">2</span>;  <span class="comment">// å¿…é¡»ä¸åŠ å¯†æ—¶ç›¸åŒçš„è¡Œæ•°</span></span><br><span class="line">	<span class="type">int</span> cols = (lena1 + v10 - <span class="number">1</span>) / v10; <span class="comment">// æœ€å¤§åˆ—æ•°</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// åˆ†é…äºŒç»´çŸ©é˜µï¼ˆè€ƒè™‘ä¸å®Œæ•´è¡Œï¼‰</span></span><br><span class="line">	<span class="type">char</span>** Block = <span class="built_in">malloc</span>(v10 * <span class="keyword">sizeof</span>(<span class="type">char</span>*));</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; v10; ++i) &#123;</span><br><span class="line">		Block[i] = <span class="built_in">malloc</span>(cols + <span class="number">1</span>); <span class="comment">// æ¯è¡Œåˆ†é…æœ€å¤§å¯èƒ½é•¿åº¦+1</span></span><br><span class="line">		<span class="built_in">memset</span>(Block[i], <span class="number">0</span>, cols + <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// åŠ¨æ€è®¡ç®—æ¯è¡Œçš„å®é™…åˆ—æ•°</span></span><br><span class="line">	<span class="type">int</span>* row_lengths = <span class="built_in">malloc</span>(v10 * <span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; v10; ++i) &#123;</span><br><span class="line">		row_lengths[i] = lena1 / v10; <span class="comment">// åŸºæœ¬åˆ—æ•°</span></span><br><span class="line">		<span class="keyword">if</span> (i &lt; lena1 % v10) row_lengths[i]++; <span class="comment">// å¤„ç†ä½™æ•°åˆ†é…</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æŒ‰è¡Œå¡«å……æ•°æ®ï¼ˆè€ƒè™‘ä¸ç­‰é•¿è¡Œï¼‰</span></span><br><span class="line">	<span class="type">int</span> pos = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> row = <span class="number">0</span>; row &lt; v10; ++row) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> col = <span class="number">0</span>; col &lt; row_lengths[row]; ++col) &#123;</span><br><span class="line">			<span class="keyword">if</span> (pos &lt; lena1) &#123;</span><br><span class="line">				Block[row][col] = a1[pos++];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æŒ‰åˆ—è¯»å–æ¢å¤åŸå§‹æ•°æ®ï¼ˆå¤„ç†ä¸è§„åˆ™å½¢çŠ¶ï¼‰</span></span><br><span class="line">	pos = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> col = <span class="number">0</span>; col &lt; cols; ++col) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> row = <span class="number">0</span>; row &lt; v10; ++row) &#123;</span><br><span class="line">			<span class="comment">// åªè¯»å–æœ‰æ•ˆåˆ—èŒƒå›´å†…çš„æ•°æ®</span></span><br><span class="line">			<span class="keyword">if</span> (col &lt; row_lengths[row] &amp;&amp; pos &lt; lena1) &#123;</span><br><span class="line">				a1[pos++] = Block[row][col];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	a1[pos] = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">// ç»ˆæ­¢å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ¸…ç†å†…å­˜</span></span><br><span class="line">	<span class="built_in">free</span>(row_lengths);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; v10; ++i) <span class="built_in">free</span>(Block[i]);</span><br><span class="line">	<span class="built_in">free</span>(Block);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt_case4</span><span class="params">(<span class="type">char</span>* str, <span class="type">const</span> <span class="type">char</span>* key)</span> &#123;</span><br><span class="line">	<span class="comment">// æ‰‹åŠ¨è®¡ç®—æœ‰æ•ˆå­—ç¬¦ä¸²é•¿åº¦ï¼ˆåŒ…å«ç©ºæ ¼ï¼‰</span></span><br><span class="line">	<span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (str[len] != <span class="string">&#x27;\0&#x27;</span>) len++;</span><br><span class="line">	<span class="keyword">if</span> (len == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">	<span class="comment">// è®¡ç®—ç­‰æ•ˆé€†å‘ç§»ä½æ¬¡æ•°</span></span><br><span class="line">	<span class="type">int</span> shift = (key[<span class="number">0</span>] % <span class="number">10</span> + <span class="number">2</span>) % len; <span class="comment">// åŠ å¯†æ—¶çš„å®é™…æœ‰æ•ˆç§»ä½</span></span><br><span class="line">	<span class="type">int</span> decrypt_shift = (len - shift) % len;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ‰§è¡Œé€†å‘å¾ªç¯å³ç§»</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; decrypt_shift; ++i) &#123;</span><br><span class="line">		<span class="comment">// ä¿å­˜æœ€åä¸€ä¸ªæœ‰æ•ˆå­—ç¬¦ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰</span></span><br><span class="line">		<span class="type">char</span> last = str[len - <span class="number">1</span>];</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// æ•´ä½“å³ç§»ä¸€ä½</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = len - <span class="number">1</span>; j &gt; <span class="number">0</span>; --j) &#123;</span><br><span class="line">			str[j] = str[j - <span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// æ¢å¤é¦–å­—ç¬¦</span></span><br><span class="line">		str[<span class="number">0</span>] = last;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt_case5</span><span class="params">(<span class="type">char</span>* a1, <span class="type">const</span> <span class="type">char</span>* a2)</span> &#123;</span><br><span class="line">	<span class="type">int</span> lena2 = <span class="built_in">strlen</span>(a2);</span><br><span class="line">	<span class="type">int</span> lena1 = base64_decode(a1);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = lena1; i &lt; lena1 + <span class="number">10</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a1[i] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lena1; ++i) &#123;</span><br><span class="line">		 a1[i] ^= (a2[i % lena2] + <span class="number">57</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//printf(&quot;%s&quot;, a1);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt_case6</span><span class="params">(<span class="type">char</span>* a1,<span class="type">const</span> <span class="type">char</span>* a2)</span> &#123;</span><br><span class="line">	<span class="type">int</span> lena1 = base64_decode(a1);</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span>* a3 = <span class="built_in">malloc</span>(<span class="number">100</span>);</span><br><span class="line">	<span class="built_in">memset</span>(a3, <span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = lena1; i &lt; lena1 + <span class="number">10</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a1[i] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	rc41(a1, a2, a3, lena1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt_case7</span><span class="params">(<span class="type">char</span> *a1,<span class="type">const</span> <span class="type">char</span>* a2)</span> &#123;</span><br><span class="line">	<span class="type">int</span> lena1 = base64_decode(a1);</span><br><span class="line">	<span class="type">int</span>* a3 = <span class="built_in">malloc</span>(<span class="number">100</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = lena1; i &lt; lena1 + <span class="number">10</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a1[i] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	rc42(a1, a2, a3, lena1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">crypt</span><span class="params">(<span class="type">char</span> *a1,<span class="type">const</span> <span class="type">char</span>* a2,<span class="type">int</span> a3)</span> &#123;</span><br><span class="line">	<span class="keyword">switch</span> (a3) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">		decrypt_case1(a1, a2);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		decrypt_case2(a1, a2);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		decrypt_case3(a1, a2);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">		decrypt_case4(a1, a2);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">		decrypt_case5(a1, a2);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">		decrypt_case6(a1, a2);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">		decrypt_case7(a1, a2);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">char</span> v15[<span class="number">8</span>];</span><br><span class="line">	<span class="type">char</span> v16[<span class="number">3</span>];</span><br><span class="line">	<span class="type">char</span> v11[<span class="number">3</span>];</span><br><span class="line">	<span class="type">int</span> i, j, v10;</span><br><span class="line">	<span class="type">char</span> i1[<span class="number">100</span>] = <span class="string">&quot;WgvDmssEvcY326bHo3nNro3vXvvfmgrz&quot;</span>;</span><br><span class="line">	<span class="type">char</span> i2[<span class="number">100</span>] = <span class="string">&quot;gX+Ri9PG=bt5=00B6hscPQOL&quot;</span>;</span><br><span class="line">	<span class="type">char</span> i3[<span class="number">100</span>] = <span class="string">&quot;T6bHgUPL2gXUd=xT=FNHtPzV&quot;</span>;</span><br><span class="line">	<span class="comment">//aaaaaaaaaaaabbbbbbbbbbbbcccccccccccc</span></span><br><span class="line">	v15[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	v15[<span class="number">1</span>] = <span class="number">5</span>;</span><br><span class="line">	v15[<span class="number">2</span>] = <span class="number">6</span>;</span><br><span class="line">	v15[<span class="number">3</span>] = <span class="number">3</span>;</span><br><span class="line">	v15[<span class="number">4</span>] = <span class="number">4</span>;</span><br><span class="line">	v15[<span class="number">5</span>] = <span class="number">1</span>;</span><br><span class="line">	v15[<span class="number">6</span>] = <span class="number">4</span>;</span><br><span class="line">	v15[<span class="number">7</span>] = <span class="number">5</span>;</span><br><span class="line">	v16[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	v16[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	v16[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line">	v11[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	v11[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	v11[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="type">char</span> ca1[] = &#123; <span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">1</span>, &#125;;</span><br><span class="line">	<span class="type">char</span> jj[] = &#123; <span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>, &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">21</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">switch</span> (jj[i]) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">			crypt(i1, i2, ca1[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;i1 i2\n%d-%d:&quot;</span>, jj[i], ca1[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, i1);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">			crypt(i2, i3, ca1[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;i2 i3\n%d-%d:&quot;</span>, jj[i], ca1[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, i2);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">			crypt(i3, i1, ca1[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;i3 i1\n%d-%d:&quot;</span>, jj[i], ca1[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, i3);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;i1:%s\ni2:%s\ni3:%s\n\n&quot;</span>, i1, i2, i3);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//for (i = 0; i &lt; 8; ++i)</span></span><br><span class="line">	<span class="comment">//&#123;</span></span><br><span class="line">	<span class="comment">//	for (j = 0; j &lt; 3; ++j)</span></span><br><span class="line">	<span class="comment">//	&#123;</span></span><br><span class="line">	<span class="comment">//		if (i &gt;= v16[j])</span></span><br><span class="line">	<span class="comment">//		&#123;</span></span><br><span class="line">	<span class="comment">//			v10 = v11[j];</span></span><br><span class="line">	<span class="comment">//			if (v10 &lt; 8)</span></span><br><span class="line">	<span class="comment">//			&#123;</span></span><br><span class="line">	<span class="comment">//				if (j)</span></span><br><span class="line">	<span class="comment">//				&#123;</span></span><br><span class="line">	<span class="comment">//					if (j == 1)</span></span><br><span class="line">	<span class="comment">//					&#123;</span></span><br><span class="line">	<span class="comment">//						//crypt(i2, i3, ca1);</span></span><br><span class="line">	<span class="comment">//						printf(&quot;%d,&quot;, j);</span></span><br><span class="line">	<span class="comment">//					&#125;</span></span><br><span class="line">	<span class="comment">//					else if (j == 2)</span></span><br><span class="line">	<span class="comment">//					&#123;</span></span><br><span class="line">	<span class="comment">//						//crypt(i3, i1, ca1);</span></span><br><span class="line">	<span class="comment">//						printf(&quot;%d,&quot;, j);</span></span><br><span class="line">	<span class="comment">//					&#125;</span></span><br><span class="line">	<span class="comment">//				&#125;</span></span><br><span class="line">	<span class="comment">//				else</span></span><br><span class="line">	<span class="comment">//				&#123;</span></span><br><span class="line">	<span class="comment">//					//crypt(i1, i2, ca1);</span></span><br><span class="line">	<span class="comment">//					printf(&quot;%d,&quot;, j);</span></span><br><span class="line">	<span class="comment">//				&#125;</span></span><br><span class="line">	<span class="comment">//				++v11[j];</span></span><br><span class="line">	<span class="comment">//			&#125;</span></span><br><span class="line">	<span class="comment">//		&#125;</span></span><br><span class="line">	<span class="comment">//	&#125;</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, i1[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, i2[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, i3[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//char ca[] = &#123; 0,0,1,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2, &#125;;</span></span><br><span class="line">	<span class="comment">//for (int i = 0; i &lt; 21; i++)</span></span><br><span class="line">	<span class="comment">//&#123;</span></span><br><span class="line">	<span class="comment">//	printf(&quot;%d,&quot;,ca[21 -1- i]);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="comment">//for (int i = strlen(ca)-1; i &gt;= 0; i--)</span></span><br><span class="line">	<span class="comment">//&#123;</span></span><br><span class="line">	<span class="comment">//	switch (ca[i]) &#123;</span></span><br><span class="line">	<span class="comment">//	case 1:</span></span><br><span class="line">	<span class="comment">//		decrypt_case1();</span></span><br><span class="line">	<span class="comment">//	&#125;</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//NSSCTF&#123;P4ch3Lbel&#x27;s_C@n0n_1n_D_mAjOr&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£å†³äº†</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>l1pmoluy,1392181761@qq.com</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://l1pmoluy.github.io/2025/03/26/2025ghctf/" title="ghctf2025-re-wp">https://l1pmoluy.github.io/2025/03/26/2025ghctf/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2025/03/27/2025n1ctf/" rel="prev" title="n1ctf2025-re-wp"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">n1ctf2025-re-wp</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2025/03/26/main/" rel="next" title="'main'"><span class="post-nav-text">'main'</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2025 </span><a class="with-love" id="animate" href="https://l1pmoluy.github.io" title="l1pmoluy's blog"><span class="icon iconify" data-icon="ri:cloud-line"></span></a><span class="author"> l1pmoluy</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v7.3.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#f5b8d5" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://fastly.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://fastly.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js" type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div></body></html>