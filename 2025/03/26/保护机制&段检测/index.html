<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#f5b8d5"><meta name="author" content="l1pmoluy,1392181761@qq.com"><meta name="copyright" content="l1pmoluy"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>ä¿æŠ¤æœºåˆ¶&amp;æ®µæ£€æµ‹ | l1pmoluy</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#f5b8d5"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"l1pmoluy.github.io","root":"/","title":"è¸ç€æ¢¦èµ°è¿‡æ—¶å…‰","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"algolia":{"hits":{"per_page":8}},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="l1pmoluy" type="application/atom+xml"><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="windows2-ä¿æŠ¤æœºåˆ¶">
<meta property="og:type" content="article">
<meta property="og:title" content="ä¿æŠ¤æœºåˆ¶&amp;æ®µæ£€æµ‹">
<meta property="og:url" content="https://l1pmoluy.github.io/2025/03/26/%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6&%E6%AE%B5%E6%A3%80%E6%B5%8B/index.html">
<meta property="og:site_name" content="l1pmoluy">
<meta property="og:description" content="windows2-ä¿æŠ¤æœºåˆ¶">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="d:\tool\blog\source\postpic\windows2\1.png">
<meta property="og:image" content="d:\tool\blog\source\postpic\windows2\2.png">
<meta property="article:published_time" content="2025-03-26T07:55:14.000Z">
<meta property="article:modified_time" content="2025-03-26T09:08:43.118Z">
<meta property="article:author" content="l1pmoluy">
<meta property="article:tag" content="windowsæ·±åº¦å­¦ä¹ ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="d:\tool\blog\source\postpic\windows2\1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="l1pmoluy"><img width="96" loading="lazy" src="/images/rika.jpg" alt="l1pmoluy"><span class="site-author-status" title="Looking for dawn.">ğŸ¥°</span></a><div class="site-author-name"><a href="/about/">l1pmoluy</a></div><span class="site-name">l1pmoluy</span><sub class="site-subtitle">Dawing...</sub><div class="site-description">l1pmoluy's blog</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">8</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">2</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">3</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="1392181761" target="_blank" style="color:#12B7F5"><span class="icon iconify" data-icon="ri:qq-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://blog.csdn.net/dawn_ing_" title="csdn" target="_blank" style="color:#e83b07"><span class="icon iconify" data-icon="ri:terminal-box-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://bbs.kanxue.com/user-home-1012312.htm" title="çœ‹é›ª" target="_blank" style="color:#e83b07"><span class="icon iconify" data-icon="ri:snowflake-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="1392181761@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/hututu-mknzl" title="è¯­é›€" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:yuque-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="å‹é“¾" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:user-community-line"></span></a><a class="links-item hty-icon-button" href="/girl/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><span class="icon iconify" data-icon="ri:women-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AE%B5%E6%A3%80%E6%B5%8B"><span class="toc-number">1.</span> <span class="toc-text">æ®µæ£€æµ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AE%B5"><span class="toc-number">1.1.</span> <span class="toc-text">æ®µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windbg%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8C%87%E4%BB%A4"><span class="toc-number">1.2.</span> <span class="toc-text">windbgçš„ä¸€äº›æŒ‡ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AE%B5%E9%80%89%E6%8B%A9%E7%AC%A6"><span class="toc-number">1.3.</span> <span class="toc-text">æ®µé€‰æ‹©ç¬¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AE%B5%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">1.4.</span> <span class="toc-text">æ®µæè¿°ç¬¦</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%E4%BB%A3%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">ç»ƒä¹ ä»£ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89"><span class="toc-number">3.</span> <span class="toc-text">ä¸‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#d-b"><span class="toc-number">3.1.</span> <span class="toc-text">d&#x2F;b</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#f5b8d5;"><link itemprop="mainEntityOfPage" href="https://l1pmoluy.github.io/2025/03/26/%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6&amp;%E6%AE%B5%E6%A3%80%E6%B5%8B/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="l1pmoluy,1392181761@qq.com"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="l1pmoluy"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ä¿æŠ¤æœºåˆ¶&amp;æ®µæ£€æµ‹</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2025-3-26 15:55:14" itemprop="dateCreated datePublished" datetime="2025-03-26T15:55:14+08:00">2025-3-26</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="æœ¬æ–‡å­—æ•°">1.6k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="é˜…è¯»æ—¶é•¿">6m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E9%80%86%E5%90%91%E8%A1%8C%E9%A9%B6/" style="--text-color:#FF0000" itemprop="url" rel="index"><span itemprop="text">é€†å‘è¡Œé©¶</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/windows%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="--text-color:#416482"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">windowsæ·±åº¦å­¦ä¹ </span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>windows2-ä¿æŠ¤æœºåˆ¶</p>
<span id="more"></span>

<p>é¦–å…ˆé“ºå«ï¼Œåœ¨å‰é¢å­¦è¿‡peæ–‡ä»¶æ ¼å¼ï¼Œä¸”å†™è¿‡åå°„å‹æ³¨å…¥ï¼Œæœ‰ä¸€å®šçŸ¥è¯†å‰ç½®</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªè½¯ä»¶åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¼šåˆ†é…ä¸€ä¸ªå†…å­˜ä¸­çš„åŸºåœ°å€ï¼ˆè™šæ‹Ÿåœ°å€ï¼‰ï¼Œå¾ˆå¥½ï¼Œé‚£ä¹ˆæ˜æ˜æ˜¯åœ¨å†…å­˜ä¸­å®ä½“å­˜åœ¨çš„ä¸ºä»€ä¹ˆå«è™šæ‹Ÿåœ°å€ï¼Ÿæˆ‘ä»¬è¿˜çŸ¥é“ï¼Œåœ°å€æ˜¯çº¿æ€§çš„0 1 2 â€¦â€¦ 0xffffffffhï¼Œçº¿æ€§æ’å¸ƒï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘çš„ç¨‹åºåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå‡å¦‚è¯´æ˜¯0x87654321ï¼Œæ¬¸ï¼Ÿæ­¤æ—¶æˆ‘æœ‰ä¸€ä¸ªæŒ‡ä»¤æ˜¯mov dword ptr [0] , 1ï¼Œé‚£ä¹ˆä¼šæŠŠå†…å­˜å¼€å§‹åœ°æ–¹çš„ä¸œè¥¿æ”¹åŠ¨æ‰ï¼Œä½†æ˜¯å†…å­˜æœ€å¼€å§‹çš„ä¸œè¥¿è‚¯å®šæ˜¯å¾ˆå†…æ ¸çš„ä¸œè¥¿ï¼Œä»€ä¹ˆå¯¹ç¨‹åºçš„è°ƒç”¨å•Šï¼Œä»€ä¹ˆçš„ä¹‹å‰åœ¨åè°ƒè¯•æœ‰æ¥è§¦è¿‡</p>
<p>è‡ªç„¶æ˜¯ä¸èƒ½è®©ä½ éšä¾¿åŠ¨ä»–çš„ï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰èƒ½å¾ˆå®‰å…¨çš„åšåˆ°å‘¢</p>
<p>ç›®å‰æˆ‘å­¦åˆ°çš„æ˜¯åˆ†æ®µåˆ†é¡µï¼Œç›¸å½“äºåœ¨åŸæœ¬çš„0x55555555hçš„åœ°æ–¹ä¸€åˆ€æ–©æ–­ï¼Œåé¢åˆå¼€å§‹0x0hï¼ˆåº”è¯¥å¦‚æ­¤ï¼Œåç»­å›æ¥è¡¥å……ï¼‰</p>
<p>å—¯ä¸æ˜¯è¿™æ ·çš„ï¼Œæ˜¯åˆ†æˆä¸€æ®µä¸€æ®µç„¶åé€šè¿‡ä»£ç æ®µï¼Œæ•°æ®æ®µæ¥åŒºåˆ†ï¼Œè¿™æ˜¯æ®µä¿æŠ¤æœºåˆ¶</p>
<p>é¡µä¿æŠ¤ä¼°è®¡å°±æ˜¯è¿›ç¨‹çº¿ç¨‹çš„å§ã€‚ã€‚ã€‚</p>
<h2 id="æ®µæ£€æµ‹"><a href="#æ®µæ£€æµ‹" class="headerlink" title="æ®µæ£€æµ‹"></a>æ®µæ£€æµ‹</h2><h3 id="æ®µ"><a href="#æ®µ" class="headerlink" title="æ®µ"></a>æ®µ</h3><p>CS	1B ä»£ç æ®µ</p>
<p>SS	23 æ ˆæ®µ(æ ˆï¼Œå±€éƒ¨å˜é‡)</p>
<p>DS	23 æ•°æ®æ®µ(å †ï¼Œå…¨å±€å˜é‡)</p>
<p>ES	23 æ‰©å±•æ®µ(å¯ä»¥è¿˜åŸds)</p>
<p>FS	ä¸Šä¸‹æ–‡ç¯å¢ƒæ®µ	R3ä»£è¡¨TEB R0ä»£ç æ˜¯KPCR</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// study02.cpp : å®šä¹‰æ§åˆ¶å°åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> val=<span class="number">0x100</span>;</span><br><span class="line"><span class="type">int</span> val2=<span class="number">0x1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> _tmain(<span class="type">int</span> argc, _TCHAR* argv[])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        mov ax,cs;</span><br><span class="line">        mov dword ptr ds:[val2],eax;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>,val2);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯¥ç¨‹åºç»“æœæ˜¯1bï¼Œæ‰€ä»¥csçš„å€¼æ˜¯1b</p>
<h3 id="windbgçš„ä¸€äº›æŒ‡ä»¤"><a href="#windbgçš„ä¸€äº›æŒ‡ä»¤" class="headerlink" title="windbgçš„ä¸€äº›æŒ‡ä»¤"></a>windbgçš„ä¸€äº›æŒ‡ä»¤</h3><p>r	æŸ¥çœ‹ä¸€äº›å¯„å­˜å™¨(r eax | r al | r gdtr)</p>
<p>d	æŸ¥çœ‹åœ°å€(byte(db) | word(dw) | â€¦ ) | (L limit é™åˆ¶è¦çœ‹å¤šé•¿) | (s ç«–ç€çœ‹)</p>
<p>e	å†™å†…å­˜(ç”¨æ³•å’Œdä¸€è‡´)</p>
<h3 id="æ®µé€‰æ‹©ç¬¦"><a href="#æ®µé€‰æ‹©ç¬¦" class="headerlink" title="æ®µé€‰æ‹©ç¬¦"></a>æ®µé€‰æ‹©ç¬¦</h3><p>é•¿åº¦ä¸€å­—èŠ‚ï¼Œæ¯”å¦‚å‰é¢çš„CSé‡Œçš„1Bå€¼å°±æ˜¯æ®µé€‰æ‹©ç¬¦ï¼ˆ0x18æ˜¯æ‰“å°cså€¼ä¼šæ‰“å°å‡ºæ¥çš„ï¼‰</p>
<p>1Bï¼š0000 0000 0001 1      0 		11</p>
<p>0011		       æŸ¥æ‰¾è¡¨	   è¯·æ±‚æƒé™</p>
<p>   3ï¼Œåœ¨è¡¨ä¸­çš„ç¬¬3ä½	  0&#x3D;GDT	  Global Decsrctor Table(å…¨å±€æè¿°è¡¨)</p>
<p> 1&#x3D;LDT	Local Decsrctor Table(æœ¬åœ°æè¿°è¡¨)</p>
<h3 id="æ®µæè¿°ç¬¦"><a href="#æ®µæè¿°ç¬¦" class="headerlink" title="æ®µæè¿°ç¬¦"></a>æ®µæè¿°ç¬¦</h3><p>ä¹Ÿå°±æ˜¯å‰é¢çš„GDTå’ŒLDTè¡¨çš„å†…å®¹</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<blockquote>
<p>kd&gt; r gdtr</p>
<p>gdtr&#x3D;80b98800</p>
</blockquote>
<p>é€šè¿‡æŸ¥æ‰¾æŒ‡ä»¤æ‰¾åˆ°gdtè¡¨ï¼Œgdtè¡¨æ˜¯æŒ‰ç…§1å­—ä¹Ÿå°±æ˜¯ä¸¤å­—èŠ‚çš„å½¢å¼ä¸ºæœ€å°å•ä½ï¼Œæ‰€ä»¥æŸ¥æ‰¾çš„æ—¶å€™è¦ç”¨dq</p>
<blockquote>
<p>kd&gt; dq 80b98800</p>
<p>80b98800  00000000<code>00000000 00cf9b00</code>0000ffff</p>
<p>80b98810  00cf9300<code>0000ffff 00cffb00</code>0000ffff</p>
<p>80b98820  00cff300<code>0000ffff 80008bb9</code>8c0020ab</p>
<p>80b98830  804093b9<code>b0004fff 0040f300</code>00000fff</p>
<p>80b98840  0000f200<code>0400ffff 00000000</code>00000000</p>
<p>80b98850  800089b9<code>ad200067 800089b9</code>acb00067</p>
<p>80b98860  00000000<code>00000000 00000000</code>00000000</p>
<p>80b98870  800092b9<code>880003ff 00000000</code>00000000</p>
</blockquote>
<p>æŒ‰ç…§ä¸Šé¢ç´¢å¼•ç¬¬ä¸‰ä¸ª(æ³¨æ„ï¼Œä»0å¼€å§‹æ•°)  00cffb00&#96;0000ffffï¼Œå’Œæ®µé€‰æ‹©ç¬¦ä¸€æ ·ï¼Œè¦æ‹†åˆ†åˆ†æ</p>
<p><img src="D:\tool\blog\source\postpic\windows2\1.png" loading="lazy"></p>
<p>å¯¹ç…§ä¸Šè¡¨ï¼Œé«˜å­—èŠ‚éƒ¨åˆ†å’Œä½å­—èŠ‚éƒ¨åˆ†</p>
<p>31    24   		   19     16            12     8     0</p>
<pre><code>00	c		f	f		b	00
</code></pre>
<p>   1100 		   1111</p>
<p>h: b   	gb0a	l  	 hd s	t	b</p>
<p>  0000	ffff</p>
<p>l: b  		l</p>
<p>limit:f+ffff&#x3D;0xfffff	æ®µé™åˆ¶å¤§å°(sizeof(cs)):(h&amp;l)+(l&amp;l)</p>
<p>base:00+00+0000	åŸºå€å¤§å°(base):(h&amp;b)+(h&amp;b)+(l&amp;b)</p>
<p>type:(h&amp;t)b	tpyeä½œç”¨è§ä¸‹è¡¨</p>
<p>s:(h&amp;s)1</p>
<p>DPL:(h&amp;d)3</p>
<p>p:(h&amp;p)1		pç”¨æ¥è¯æ˜è¯¥æ®µæ˜¯å¦æœ‰æ•ˆï¼Œ1æœ‰æ•ˆï¼Œ0æ— æ•ˆ</p>
<p>avl:(h&amp;a)0</p>
<p>0:(h&amp;0)0</p>
<p>D&#x2F;B:(h&amp;b)1</p>
<p>G:(h&amp;g)1		è‹¥ä¸º1ï¼Œåˆ™ä»¥é¡µä¸ºå•ä½ï¼ˆå½±å“çš„æ˜¯æ®µé™åˆ¶çš„å•ä½ï¼‰ï¼ˆä¸€ä¸ªé¡µ4096å­—èŠ‚ï¼‰ è½¬æ¢ä¸ºhex-&gt;0x1000</p>
<p>æ•…çœŸæ­£é™åˆ¶å¤§å°ï¼š(limit+1)*(g)		æŒ‰ç…§ä¸Šé¢çš„è®¡ç®—ä¹Ÿå°±æ˜¯(0xfffff+1)*0x1000&#x3D;0x1 0000 0000ï¼ŒèŒƒå›´å°±æ˜¯0-0xf ffff fff	ä¹Ÿå°±æ˜¯4ä¸ªg</p>
<p>typeä½œç”¨ï¼š<img src="D:\tool\blog\source\postpic\windows2\2.png" loading="lazy"></p>
<h2 id="ç»ƒä¹ ä»£ç "><a href="#ç»ƒä¹ ä»£ç " class="headerlink" title="ç»ƒä¹ ä»£ç "></a>ç»ƒä¹ ä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// study02.cpp : å®šä¹‰æ§åˆ¶å°åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> val=<span class="number">0x100</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> _tmain(<span class="type">int</span> argc, _TCHAR* argv[])</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> val2=<span class="number">0x1</span>;</span><br><span class="line">	<span class="comment">//æ®µä¿æŠ¤</span></span><br><span class="line">	__asm&#123;</span><br><span class="line">		mov ax,cs;</span><br><span class="line">		mov ds,ax;</span><br><span class="line">		mov eax,dword ptr ds:[val];	<span class="comment">//ds:[val]å°±æ˜¯å…¨å±€å˜é‡val</span></span><br><span class="line">		<span class="comment">//mov dword ptr ds:[val2],eax;//ç›´æ¥è¿™æ ·ä¼šæŠ¥é”™ï¼Œå› ä¸ºcsç»™äº†dsï¼Œcsæ®µæ˜¯å¯è¯»å¯æ‰§è¡Œä¸å¯å†™ï¼Œè¿™é‡Œç›¸å½“äºå†™å…¥æ‰€ä»¥ä¸å¯ä»¥</span></span><br><span class="line">		<span class="comment">//æ¢å¤dsç¯å¢ƒ</span></span><br><span class="line">		mov ax,es;</span><br><span class="line">		mov ds,ax;</span><br><span class="line">		<span class="comment">//å¯ä»¥èµ‹å€¼</span></span><br><span class="line">		mov [val2],eax;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;val2=%x\n&quot;</span>,val2);</span><br><span class="line">	<span class="comment">//0x100</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//æŸ¥çœ‹æ®µé€‰æ‹©ç¬¦</span></span><br><span class="line">	__asm</span><br><span class="line">	&#123;</span><br><span class="line">		mov ax,cs;</span><br><span class="line">		mov [val2],eax;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;cs=0x%x\n&quot;</span>,val2);</span><br><span class="line">	<span class="comment">//0x1b</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//å¯¹baseçš„æ¢æµ‹</span></span><br><span class="line">	__asm</span><br><span class="line">	&#123;</span><br><span class="line">		mov ax,<span class="number">0x4b</span>;		<span class="comment">//è¿™é‡Œç”¨windbgå°†å¯¹åº”gdtè¡¨åŠ¨è¿‡ï¼Œä¹Ÿå°±æ˜¯è®©base+1äº†</span></span><br><span class="line">		mov ds,ax;</span><br><span class="line">		mov eax,dword ptr ds:[val];</span><br><span class="line">		mov dword ptr ss:[val2],eax;</span><br><span class="line">		<span class="comment">//mov cx,es;</span></span><br><span class="line">		<span class="comment">//mov ds,cx;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;0x%x\n&quot;</span>,val2);</span><br><span class="line">	<span class="comment">//æ­£å¸¸æ¥è¯´è¿™é‡Œæ˜¯100ï¼Œä½†æ˜¯å¦‚æœæ”¹å˜baseåŸºåœ°å€ï¼Œé‚£ä¹ˆèµ‹å€¼çš„æ—¶å€™eaxç»™çš„å°±æ˜¯base+offset val2+1ï¼Œï¼Œæ²¡æœ‰æ”¹å˜val2åœ°å€çš„å€¼ï¼Œåé¢æ¢å¤äº†dså°±æ­£å¸¸äº†</span></span><br><span class="line">	<span class="comment">//åŒç†ï¼Œå°†å‰é¢çš„æ¢å¤ç¯å¢ƒæ³¨é‡Šæ‰ï¼Œåé¢å†æ¢å¤</span></span><br><span class="line">	__asm</span><br><span class="line">	&#123;</span><br><span class="line">		mov cx,es;</span><br><span class="line">		mov ds,cx;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//è‹¥æ˜¯è¿™æ ·å­ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰å˜åŒ–çš„</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">////å¯¹æ®µé•¿åº¦çš„æ¢æµ‹</span></span><br><span class="line">	__asm</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//limit</span></span><br><span class="line">		<span class="comment">//mov eax,fs:[0x1000-4];//è¿™é‡Œå¦‚æœæ˜¯0x1000-4 - 0x1000ä¹‹å†…çš„éƒ½ä¼šå‡ºé”™ï¼Œå› ä¸ºè¶…å‡ºå¤§å°äº†</span></span><br><span class="line">		<span class="comment">//mov val2,eax;</span></span><br><span class="line">		<span class="comment">//p</span></span><br><span class="line">		<span class="comment">//åœ¨gdtè¡¨ä¸­å°†pæ”¹æˆ0å°±å¯ä»¥æ— æ•ˆäº†ï¼Œè¿™é‡Œæ­£å¸¸è¿è¡Œä¸Šé¢çš„é‚£ä¸ªä»£ç å°±ä¼šæŠ¥é”™</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;fs:[0]=0x%x\n&quot;</span>,val2);</span><br><span class="line"></span><br><span class="line">	system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰"><a href="#ä¸‰" class="headerlink" title="ä¸‰"></a>ä¸‰</h2><p>å†æ¬¡æ€»ç»“ä¸€ä¸‹ï¼Œcs,dsè¿™äº›æ®µå¦‚æœæ˜¯cs:[x]ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨ä»£ç æ®µä¸­çš„xåœ°å€ï¼Œä½†æ˜¯å¦‚æœåªæ˜¯csï¼Œä¹Ÿå°±æ˜¯csä¸­çš„å€¼ï¼Œå¹¶ä¸æ˜¯åŸºåœ°å€ï¼Œè€Œæ˜¯æ®µé€‰æ‹©ç¬¦ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥æ‹†è§£çš„ï¼Œæœ‰æ—¶å€™å°±ä¼šå»å¯¹ç…§gdtè¡¨ï¼Œç„¶åæŸ¥çœ‹gdté‡Œçš„ä¸œè¥¿</p>
<h3 id="d-b"><a href="#d-b" class="headerlink" title="d&#x2F;b"></a>d&#x2F;b</h3><p>è¯è§£ä¸Šé¢˜ï¼Œé€šè¿‡windbgæ›´æ”¹ç«¯æ®µæè¿°ç¬¦cs,dså¯ä»¥åšåˆ°å…¨å±€æ”¹å˜ï¼Œd&#x2F;bçš„ä½œç”¨æ˜¯ç”¨æ¥è§„å®šæ“ä½œç¬¦å¤§å°çš„ï¼Œæ¯”å¦‚æ­£å¸¸pushæŒ‡ä»¤pushçš„æ˜¯ä¸€å­—èŠ‚ï¼Œä½†æ˜¯å¦‚æœd&#x2F;bä½æ”¹å˜ï¼Œè¿™é‡Œæœ‰å¯èƒ½åªpushä¸€å­—ç­‰ï¼Œä¹Ÿå°±æ˜¯æœ¬æ¥çš„push xx xx xx xxå°±ä¼šå˜æˆpush xx xx</p>
<p>ä¸ªäººæ„Ÿè§‰å°±åƒæ˜¯æ”¹å˜è¿™ä¸ªç”µè„‘æ˜¯32ä½è¿˜æ˜¯16ä½è¿˜æ˜¯64ä½ï¼Œå­˜åœ¨ç”¨å¤„ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯å¯ä»¥å…¼å®¹ä½ç‰ˆæœ¬ï¼ˆè¿™é‡Œæ³¨æ„æ”¹å˜çš„æ˜¯æ®µæè¿°ç¬¦é‡Œçš„d&#x2F;bä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥æ®µç›¸å…³æ”¹å˜ï¼Œæ¯”å¦‚ss(æ ˆ)æ”¹äº†çš„è¯ï¼ŒcallæŒ‡ä»¤å°±ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºcallç›¸å½“äºpop jmpï¼Œä½†æ˜¯æ“ä½œå­—èŠ‚å˜å°‘äº†ï¼ŒåŸæœ¬æ˜¯call 0x12345678ï¼Œpopå‡ºæ¥å°±åªæœ‰0x1234ï¼Œjmp 0x1234ï¼Œæ‰€ä»¥å°±ä¼šå‡ºç°é—®é¢˜</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>l1pmoluy,1392181761@qq.com</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://l1pmoluy.github.io/2025/03/26/%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6&amp;%E6%AE%B5%E6%A3%80%E6%B5%8B/" title="ä¿æŠ¤æœºåˆ¶&amp;æ®µæ£€æµ‹">https://l1pmoluy.github.io/2025/03/26/%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6&%E6%AE%B5%E6%A3%80%E6%B5%8B/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2025/03/26/%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83/" rel="prev" title="é…ç½®ç¯å¢ƒ"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">é…ç½®ç¯å¢ƒ</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2025/03/26/2025nctf/" rel="next" title="nctf2025-re-wp"><span class="post-nav-text">nctf2025-re-wp</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2025 </span><a class="with-love" id="animate" href="https://l1pmoluy.github.io" title="l1pmoluy's blog"><span class="icon iconify" data-icon="ri:cloud-line"></span></a><span class="author"> l1pmoluy</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v7.3.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#f5b8d5" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://fastly.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://fastly.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js" type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div></body></html>