<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#f5b8d5"><meta name="author" content="l1pmoluy,1392181761@qq.com"><meta name="copyright" content="l1pmoluy"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>TGctf2025-re-wp | l1pmoluy</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#f5b8d5"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"l1pmoluy.github.io","root":"/","title":"踏着梦走过时光","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"algolia":{"hits":{"per_page":8}},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="l1pmoluy" type="application/atom+xml"><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="写了逆向方向5&#x2F;7个题">
<meta property="og:type" content="article">
<meta property="og:title" content="TGctf2025-re-wp">
<meta property="og:url" content="https://l1pmoluy.github.io/2025/06/02/2025TGCTF/index.html">
<meta property="og:site_name" content="l1pmoluy">
<meta property="og:description" content="写了逆向方向5&#x2F;7个题">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-06-02T12:14:14.000Z">
<meta property="article:modified_time" content="2025-10-08T10:00:22.117Z">
<meta property="article:author" content="l1pmoluy">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="l1pmoluy"><img width="96" loading="lazy" src="/images/rika.jpg" alt="l1pmoluy"><span class="site-author-status" title="Looking for dawn.">🥰</span></a><div class="site-author-name"><a href="/about/">l1pmoluy</a></div><span class="site-name">l1pmoluy</span><sub class="site-subtitle">Dawing...</sub><div class="site-description">l1pmoluy's blog</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">17</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">2</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">3</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="留言板"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="1392181761" target="_blank" style="color:#12B7F5"><span class="icon iconify" data-icon="ri:qq-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://blog.csdn.net/dawn_ing_" title="csdn" target="_blank" style="color:#e83b07"><span class="icon iconify" data-icon="ri:terminal-box-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://bbs.kanxue.com/user-home-1012312.htm" title="看雪" target="_blank" style="color:#e83b07"><span class="icon iconify" data-icon="ri:snowflake-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="1392181761@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/l1pmpluy" title="语雀" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:yuque-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="友链" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:user-community-line"></span></a><a class="links-item hty-icon-button" href="/girl/" title="喜欢的女孩子" style="color:hotpink"><span class="icon iconify" data-icon="ri:women-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Base64"><span class="toc-number">1.</span> <span class="toc-text">Base64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XTEA"><span class="toc-number">2.</span> <span class="toc-text">XTEA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E5%BF%8D%E8%80%85"><span class="toc-number">3.</span> <span class="toc-text">水果忍者</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%9B%87%E5%B9%B4%E7%9A%84%E6%9C%AC%E5%90%8D%E8%AF%AD%E8%A8%80"><span class="toc-number">4.</span> <span class="toc-text">蛇年的本名语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#randomsystem"><span class="toc-number">5.</span> <span class="toc-text">randomsystem</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#f5b8d5;"><link itemprop="mainEntityOfPage" href="https://l1pmoluy.github.io/2025/06/02/2025TGCTF/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="l1pmoluy,1392181761@qq.com"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="l1pmoluy"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">TGctf2025-re-wp</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2025-6-2 20:14:14" itemprop="dateCreated datePublished" datetime="2025-06-02T20:14:14+08:00">2025-6-2</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2025-10-8 18:00:22" itemprop="dateModified" datetime="2025-10-08T18:00:22+08:00">2025-10-8</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">3.5k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">20m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/ctf/" style="--text-color:#416482" itemprop="url" rel="index"><span itemprop="text">ctf</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/wp/" style="--text-color:#1E90FF"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">wp</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>写了逆向方向5&#x2F;7个题</p>
<span id="more"></span>


<h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h2><p>改变过的base64，在base64 8 -&gt; 6 寻址前加了个凯撒</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">b64_decode</span><span class="params">(<span class="type">uint8_t</span>* input, <span class="type">uint8_t</span>* output)</span> &#123;</span><br><span class="line">	<span class="type">uint32_t</span> len = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (input[len] != <span class="number">0</span>) len++;</span><br><span class="line">	<span class="type">uint8_t</span> flen = len / <span class="number">4</span>;</span><br><span class="line">	<span class="type">uint32_t</span> i;</span><br><span class="line">	<span class="type">uint8_t</span> basebox[] = <span class="string">&quot;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;</span>;</span><br><span class="line">	<span class="type">uint8_t</span> b64unbox[<span class="number">0x100</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		b64unbox[basebox[i]] = i;</span><br><span class="line">	&#125;</span><br><span class="line">	b64unbox[<span class="string">&#x27;=&#x27;</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">100</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* b = a;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a[i] = b64unbox[input[i]];</span><br><span class="line">		a[i] = (a[i] + <span class="number">40</span>) % <span class="number">64</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;i=%d\n&quot;</span>, i);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;flen=%d\n&quot;</span>, flen);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; flen; i++)</span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		output[i * <span class="number">3</span>] = ((a[i * <span class="number">4</span>]) &lt;&lt; <span class="number">2</span>) | ((a[i * <span class="number">4</span> + <span class="number">1</span>]) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">		output[i * <span class="number">3</span> + <span class="number">1</span>] = ((a[i * <span class="number">4</span> + <span class="number">1</span>]) &lt;&lt; <span class="number">4</span>) | (a[i * <span class="number">4</span> + <span class="number">2</span>] &gt;&gt; <span class="number">2</span>);</span><br><span class="line">		output[i * <span class="number">3</span> + <span class="number">2</span>] = (a[i * <span class="number">4</span> + <span class="number">2</span>] &lt;&lt; <span class="number">6</span>) | (a[i * <span class="number">4</span> + <span class="number">3</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	output[i * <span class="number">3</span> - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123; </span><br><span class="line">	<span class="type">uint8_t</span>* input = <span class="string">&quot;AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=&quot;</span>;</span><br><span class="line">	<span class="type">uint8_t</span>* intoutput = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">	b64_decode(input, intoutput);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, intoutput);</span><br><span class="line">	<span class="comment">//HZNUCTF&#123;ad162c-2d94-434d-9222-b65dc76a32&#125;</span></span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h2><p>是xtea</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">srand(<span class="number">0x7E8u</span>);</span><br><span class="line">sub_7FF754A41181();</span><br><span class="line">sub_7FF754A411A9(<span class="string">&quot;Welcome to HZNUCTF!!!\n&quot;</span>);</span><br><span class="line">sub_7FF754A411A9(<span class="string">&quot;Plz input the cipher:\n&quot;</span>);</span><br><span class="line">v10 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> ( sub_7FF754A41217(<span class="string">&quot;%d&quot;</span>, &amp;v10) == <span class="number">1</span> )</span><br></pre></td></tr></table></figure>

<p>开头让自己输入一个delta，根据这题提示misc？并且还有一个很奇怪的解压密码，能猜出来解压密码就是delta并且解压密码其实就是标准xtea的delta，key是随机数做出来的，随机数的srand就在开头，注意到这句代码下还有一个未知函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">sub_7FF754A42130</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  sub_7FF754A413A2(&amp;unk_7FF754A520A7);</span><br><span class="line">  <span class="keyword">if</span> ( isd() )</span><br><span class="line">    srand(<span class="number">0x7E9u</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反调试改变key，那么就可以解密了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>], <span class="type">unsigned</span> <span class="type">int</span> a1)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span>* result; <span class="comment">// rax</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">	<span class="type">int</span> i; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">	v5 = v[<span class="number">0</span>];</span><br><span class="line">	v6 = v[<span class="number">1</span>];</span><br><span class="line">	v7 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		v7 -= a1;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		v6 -= (key[(v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)));</span><br><span class="line">		v7 += a1;</span><br><span class="line">		v5 -= (key[v7 &amp; <span class="number">3</span>] + v7) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)));</span><br><span class="line">	&#125;</span><br><span class="line">	v[<span class="number">0</span>] = v5;</span><br><span class="line">	v[<span class="number">1</span>] = v6;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> flag[<span class="number">8</span>] = &#123;</span><br><span class="line">		<span class="number">0x8CCB2324</span>, <span class="number">0x09A7741A</span>, <span class="number">0xFB3C678D</span>, <span class="number">0xF6083A79</span>, <span class="number">0xF1CC241B</span>, <span class="number">0x39FA59F2</span>, <span class="number">0xF2ABE1CC</span>, <span class="number">0x17189F72</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> flag1[<span class="number">8</span>] = &#123;</span><br><span class="line">		<span class="number">0x95645282</span>, <span class="number">0x73E66F8D</span>, <span class="number">0xDA948666</span>, <span class="number">0xEB4B1C9A</span>, <span class="number">0x6FC4FB97</span>, <span class="number">0xC787553D</span>, <span class="number">0xAA16C12B</span>, <span class="number">0x30138D36</span></span><br><span class="line">	&#125;;</span><br><span class="line">	srand(<span class="number">0x7e8</span>);</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		key[i] = rand();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span>* pf;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">33</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">7</span>; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">	&#123;</span><br><span class="line">		pf = &amp;flag[i];</span><br><span class="line">		decipher(<span class="number">32</span>, &amp;flag[i - <span class="number">1</span>], key, <span class="number">0x9E3779B9</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">8</span>; k++) &#123;</span><br><span class="line">		a[k * <span class="number">4</span>] = (flag[k] &gt;&gt; <span class="number">24</span>);</span><br><span class="line">		a[k * <span class="number">4</span> + <span class="number">1</span>] = (flag[k] &gt;&gt; <span class="number">16</span>);</span><br><span class="line">		a[k * <span class="number">4</span> + <span class="number">2</span>] = (flag[k] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">		a[k * <span class="number">4</span> + <span class="number">3</span>] = (flag[k]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, a);</span><br><span class="line">	<span class="comment">//HZNUCTF&#123;ae6-9f57-4b74-b423-98eb&#125;</span></span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="水果忍者"><a href="#水果忍者" class="headerlink" title="水果忍者"></a>水果忍者</h2><p>unity游戏，可以在dnspy里看看Fruit Ninja_Data-&gt;Managed-&gt;Assembly-CSharp.dll用dnspy打开</p>
<p>在gamemanager中有一段代码在检测分数</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">IncreaseScore</span>(<span class="params"><span class="built_in">int</span> points</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">this</span>.score += points;</span><br><span class="line">    <span class="keyword">this</span>.scoreText.text = <span class="keyword">this</span>.score.ToString();</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.score &gt;= <span class="number">999999999</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] cipherText = <span class="keyword">this</span>.ConvertHexStringToByteArray(GameManager.encryptedHexData);</span><br><span class="line">        <span class="built_in">string</span> text = <span class="keyword">this</span>.Decrypt(cipherText, GameManager.encryptionKey, GameManager.iv);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.decryptedTextDisplay != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.decryptedTextDisplay.text = text;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.decryptedTextDisplay != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.decryptedTextDisplay.text = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">float</span> num = PlayerPrefs.GetFloat(<span class="string">&quot;hiscore&quot;</span>, <span class="number">0f</span>);</span><br><span class="line">    <span class="keyword">if</span> ((<span class="built_in">float</span>)<span class="keyword">this</span>.score &gt; num)</span><br><span class="line">    &#123;</span><br><span class="line">        num = (<span class="built_in">float</span>)<span class="keyword">this</span>.score;</span><br><span class="line">        PlayerPrefs.SetFloat(<span class="string">&quot;hiscore&quot;</span>, num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">byte</span>[] cipherText, <span class="built_in">string</span> key, <span class="built_in">string</span> iv</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> result;</span><br><span class="line">    <span class="keyword">using</span> (Aes aes = Aes.Create())</span><br><span class="line">        <span class="comment">// Token: 0x04000015 RID: 21</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span> encryptionKey = <span class="string">&quot;HZNUHZNUHZNUHZNU&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000016 RID: 22</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span> iv = <span class="string">&quot;0202005503081501&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000017 RID: 23</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span> encryptedHexData = <span class="string">&quot;cecadff28e93aa5d6f65128ae33e734d3f47b4b8a050d326c534a732d51b96e2a6a80dca0d5a704a216c2e0c3cc6aaaf&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>可以看到分数大于999999999会有自解密并且弹出，两个方法，1.ce改分数（我试过改了也没有弹不知为什么），2.自己解密，厨子一把锁HZNUCTF{de20-70dd-4e62-b8d0-06e}</p>
<h2 id="蛇年的本名语言"><a href="#蛇年的本名语言" class="headerlink" title="蛇年的本名语言"></a>蛇年的本名语言</h2><p>python逆向</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.9.2</span></span><br><span class="line"><span class="comment"># Python bytecode version base 3.8.0 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.8.8 (tags/v3.8.8:024d805, Feb 19 2021, 13:18:16) [MSC v.1928 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: output.py</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to HZNUCTF!!!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Plz input the flag:&quot;</span>)</span><br><span class="line">a1 = <span class="built_in">input</span>()</span><br><span class="line">a2 = Counter(a1)</span><br><span class="line">O0o00 = <span class="string">&quot;&quot;</span>.join((<span class="built_in">str</span>(a2[i]) <span class="keyword">for</span> i <span class="keyword">in</span> a1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ans1: &quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(O0o00)</span><br><span class="line">            <span class="comment">#HZNUCTF&#123;16                         &#125;</span></span><br><span class="line"><span class="keyword">if</span> O0o00 != <span class="string">&quot;111111116257645365477364777645752361&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;wrong_wrong!!!&quot;</span>)</span><br><span class="line">    exit(<span class="number">1</span>)</span><br><span class="line">iiIII = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a1:</span><br><span class="line">    <span class="keyword">if</span> a2[i] &gt; <span class="number">0</span>:</span><br><span class="line">        iiIII += i + <span class="built_in">str</span>(a2[i])</span><br><span class="line">        a2[i] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> iiIII]</span><br><span class="line">        result = [</span><br><span class="line">         <span class="number">7</span> * flag[<span class="number">0</span>] == <span class="number">504</span>,</span><br><span class="line">         <span class="number">9</span> * flag[<span class="number">0</span>] - <span class="number">5</span> * flag[<span class="number">1</span>] == <span class="number">403</span>,</span><br><span class="line">         <span class="number">2</span> * flag[<span class="number">0</span>] - <span class="number">5</span> * flag[<span class="number">1</span>] + <span class="number">10</span> * flag[<span class="number">2</span>] == <span class="number">799</span>,</span><br><span class="line">         <span class="number">3</span> * flag[<span class="number">0</span>] + <span class="number">8</span> * flag[<span class="number">1</span>] + <span class="number">15</span> * flag[<span class="number">2</span>] + <span class="number">20</span> * flag[<span class="number">3</span>] == <span class="number">2938</span>,</span><br><span class="line">         <span class="number">5</span> * flag[<span class="number">0</span>] + <span class="number">15</span> * flag[<span class="number">1</span>] + <span class="number">20</span> * flag[<span class="number">2</span>] - <span class="number">19</span> * flag[<span class="number">3</span>] + <span class="number">1</span> * flag[<span class="number">4</span>] == <span class="number">2042</span>,</span><br><span class="line">         <span class="number">7</span> * flag[<span class="number">0</span>] + <span class="number">1</span> * flag[<span class="number">1</span>] + <span class="number">9</span> * flag[<span class="number">2</span>] - <span class="number">11</span> * flag[<span class="number">3</span>] + <span class="number">2</span> * flag[<span class="number">4</span>] + <span class="number">5</span> * flag[<span class="number">5</span>] == <span class="number">1225</span>,</span><br><span class="line">         <span class="number">11</span> * flag[<span class="number">0</span>] + <span class="number">22</span> * flag[<span class="number">1</span>] + <span class="number">33</span> * flag[<span class="number">2</span>] + <span class="number">44</span> * flag[<span class="number">3</span>] + <span class="number">55</span> * flag[<span class="number">4</span>] + <span class="number">66</span> * flag[<span class="number">5</span>] - <span class="number">77</span> * flag[<span class="number">6</span>] == <span class="number">7975</span>,</span><br><span class="line">         <span class="number">21</span> * flag[<span class="number">0</span>] + <span class="number">23</span> * flag[<span class="number">1</span>] + <span class="number">3</span> * flag[<span class="number">2</span>] + <span class="number">24</span> * flag[<span class="number">3</span>] - <span class="number">55</span> * flag[<span class="number">4</span>] + <span class="number">6</span> * flag[<span class="number">5</span>] - <span class="number">7</span> * flag[<span class="number">6</span>] + <span class="number">15</span> * flag[<span class="number">7</span>] == <span class="number">229</span>,</span><br><span class="line">         <span class="number">2</span> * flag[<span class="number">0</span>] + <span class="number">26</span> * flag[<span class="number">1</span>] + <span class="number">13</span> * flag[<span class="number">2</span>] + <span class="number">0</span> * flag[<span class="number">3</span>] - <span class="number">65</span> * flag[<span class="number">4</span>] + <span class="number">15</span> * flag[<span class="number">5</span>] + <span class="number">29</span> * flag[<span class="number">6</span>] + <span class="number">1</span> * flag[<span class="number">7</span>] + <span class="number">20</span> * flag[<span class="number">8</span>] == <span class="number">2107</span>,</span><br><span class="line">         <span class="number">10</span> * flag[<span class="number">0</span>] + <span class="number">7</span> * flag[<span class="number">1</span>] + -<span class="number">9</span> * flag[<span class="number">2</span>] + <span class="number">6</span> * flag[<span class="number">3</span>] + <span class="number">7</span> * flag[<span class="number">4</span>] + <span class="number">1</span> * flag[<span class="number">5</span>] + <span class="number">22</span> * flag[<span class="number">6</span>] + <span class="number">21</span> * flag[<span class="number">7</span>] - <span class="number">22</span> * flag[<span class="number">8</span>] + <span class="number">30</span> * flag[<span class="number">9</span>] == <span class="number">4037</span>,</span><br><span class="line">         <span class="number">15</span> * flag[<span class="number">0</span>] + <span class="number">59</span> * flag[<span class="number">1</span>] + <span class="number">56</span> * flag[<span class="number">2</span>] + <span class="number">66</span> * flag[<span class="number">3</span>] + <span class="number">7</span> * flag[<span class="number">4</span>] + <span class="number">1</span> * flag[<span class="number">5</span>] - <span class="number">122</span> * flag[<span class="number">6</span>] + <span class="number">21</span> * flag[<span class="number">7</span>] + <span class="number">32</span> * flag[<span class="number">8</span>] + <span class="number">3</span> * flag[<span class="number">9</span>] - <span class="number">10</span> * flag[<span class="number">10</span>] == <span class="number">4950</span>,</span><br><span class="line">         <span class="number">13</span> * flag[<span class="number">0</span>] + <span class="number">66</span> * flag[<span class="number">1</span>] + <span class="number">29</span> * flag[<span class="number">2</span>] + <span class="number">39</span> * flag[<span class="number">3</span>] - <span class="number">33</span> * flag[<span class="number">4</span>] + <span class="number">13</span> * flag[<span class="number">5</span>] - <span class="number">2</span> * flag[<span class="number">6</span>] + <span class="number">42</span> * flag[<span class="number">7</span>] + <span class="number">62</span> * flag[<span class="number">8</span>] + <span class="number">1</span> * flag[<span class="number">9</span>] - <span class="number">10</span> * flag[<span class="number">10</span>] + <span class="number">11</span> * flag[<span class="number">11</span>] == <span class="number">12544</span>,</span><br><span class="line">         <span class="number">23</span> * flag[<span class="number">0</span>] + <span class="number">6</span> * flag[<span class="number">1</span>] + <span class="number">29</span> * flag[<span class="number">2</span>] + <span class="number">3</span> * flag[<span class="number">3</span>] - <span class="number">3</span> * flag[<span class="number">4</span>] + <span class="number">63</span> * flag[<span class="number">5</span>] - <span class="number">25</span> * flag[<span class="number">6</span>] + <span class="number">2</span> * flag[<span class="number">7</span>] + <span class="number">32</span> * flag[<span class="number">8</span>] + <span class="number">1</span> * flag[<span class="number">9</span>] - <span class="number">10</span> * flag[<span class="number">10</span>] + <span class="number">11</span> * flag[<span class="number">11</span>] - <span class="number">12</span> * flag[<span class="number">12</span>] == <span class="number">6585</span>,</span><br><span class="line">         <span class="number">223</span> * flag[<span class="number">0</span>] + <span class="number">6</span> * flag[<span class="number">1</span>] - <span class="number">29</span> * flag[<span class="number">2</span>] - <span class="number">53</span> * flag[<span class="number">3</span>] - <span class="number">3</span> * flag[<span class="number">4</span>] + <span class="number">3</span> * flag[<span class="number">5</span>] - <span class="number">65</span> * flag[<span class="number">6</span>] + <span class="number">0</span> * flag[<span class="number">7</span>] + <span class="number">36</span> * flag[<span class="number">8</span>] + <span class="number">1</span> * flag[<span class="number">9</span>] - <span class="number">15</span> * flag[<span class="number">10</span>] + <span class="number">16</span> * flag[<span class="number">11</span>] - <span class="number">18</span> * flag[<span class="number">12</span>] + <span class="number">13</span> * flag[<span class="number">13</span>] == <span class="number">6893</span>,</span><br><span class="line">         <span class="number">29</span> * flag[<span class="number">0</span>] + <span class="number">13</span> * flag[<span class="number">1</span>] - <span class="number">9</span> * flag[<span class="number">2</span>] - <span class="number">93</span> * flag[<span class="number">3</span>] + <span class="number">33</span> * flag[<span class="number">4</span>] + <span class="number">6</span> * flag[<span class="number">5</span>] + <span class="number">65</span> * flag[<span class="number">6</span>] + <span class="number">1</span> * flag[<span class="number">7</span>] - <span class="number">36</span> * flag[<span class="number">8</span>] + <span class="number">0</span> * flag[<span class="number">9</span>] - <span class="number">16</span> * flag[<span class="number">10</span>] + <span class="number">96</span> * flag[<span class="number">11</span>] - <span class="number">68</span> * flag[<span class="number">12</span>] + <span class="number">33</span> * flag[<span class="number">13</span>] - <span class="number">14</span> * flag[<span class="number">14</span>] == <span class="number">1883</span>,</span><br><span class="line">         <span class="number">69</span> * flag[<span class="number">0</span>] + <span class="number">77</span> * flag[<span class="number">1</span>] - <span class="number">93</span> * flag[<span class="number">2</span>] - <span class="number">12</span> * flag[<span class="number">3</span>] + <span class="number">0</span> * flag[<span class="number">4</span>] + <span class="number">0</span> * flag[<span class="number">5</span>] + <span class="number">1</span> * flag[<span class="number">6</span>] + <span class="number">16</span> * flag[<span class="number">7</span>] + <span class="number">36</span> * flag[<span class="number">8</span>] + <span class="number">6</span> * flag[<span class="number">9</span>] + <span class="number">19</span> * flag[<span class="number">10</span>] + <span class="number">66</span> * flag[<span class="number">11</span>] - <span class="number">8</span> * flag[<span class="number">12</span>] + <span class="number">38</span> * flag[<span class="number">13</span>] - <span class="number">16</span> * flag[<span class="number">14</span>] + <span class="number">15</span> * flag[<span class="number">15</span>] == <span class="number">8257</span>,</span><br><span class="line">         <span class="number">23</span> * flag[<span class="number">0</span>] + <span class="number">2</span> * flag[<span class="number">1</span>] - <span class="number">3</span> * flag[<span class="number">2</span>] - <span class="number">11</span> * flag[<span class="number">3</span>] + <span class="number">12</span> * flag[<span class="number">4</span>] + <span class="number">24</span> * flag[<span class="number">5</span>] + <span class="number">1</span> * flag[<span class="number">6</span>] + <span class="number">6</span> * flag[<span class="number">7</span>] + <span class="number">14</span> * flag[<span class="number">8</span>] - <span class="number">0</span> * flag[<span class="number">9</span>] + <span class="number">1</span> * flag[<span class="number">10</span>] + <span class="number">68</span> * flag[<span class="number">11</span>] - <span class="number">18</span> * flag[<span class="number">12</span>] + <span class="number">68</span> * flag[<span class="number">13</span>] - <span class="number">26</span> * flag[<span class="number">14</span>] + <span class="number">15</span> * flag[<span class="number">15</span>] - <span class="number">16</span> * flag[<span class="number">16</span>] == <span class="number">5847</span>,</span><br><span class="line">         <span class="number">24</span> * flag[<span class="number">0</span>] + <span class="number">0</span> * flag[<span class="number">1</span>] - <span class="number">1</span> * flag[<span class="number">2</span>] - <span class="number">15</span> * flag[<span class="number">3</span>] + <span class="number">13</span> * flag[<span class="number">4</span>] + <span class="number">4</span> * flag[<span class="number">5</span>] + <span class="number">16</span> * flag[<span class="number">6</span>] + <span class="number">67</span> * flag[<span class="number">7</span>] + <span class="number">146</span> * flag[<span class="number">8</span>] - <span class="number">50</span> * flag[<span class="number">9</span>] + <span class="number">16</span> * flag[<span class="number">10</span>] + <span class="number">6</span> * flag[<span class="number">11</span>] - <span class="number">1</span> * flag[<span class="number">12</span>] + <span class="number">69</span> * flag[<span class="number">13</span>] - <span class="number">27</span> * flag[<span class="number">14</span>] + <span class="number">45</span> * flag[<span class="number">15</span>] - <span class="number">6</span> * flag[<span class="number">16</span>] + <span class="number">17</span> * flag[<span class="number">17</span>] == <span class="number">18257</span>,</span><br><span class="line">         <span class="number">25</span> * flag[<span class="number">0</span>] + <span class="number">26</span> * flag[<span class="number">1</span>] - <span class="number">89</span> * flag[<span class="number">2</span>] + <span class="number">16</span> * flag[<span class="number">3</span>] + <span class="number">19</span> * flag[<span class="number">4</span>] + <span class="number">44</span> * flag[<span class="number">5</span>] + <span class="number">36</span> * flag[<span class="number">6</span>] + <span class="number">66</span> * flag[<span class="number">7</span>] - <span class="number">150</span> * flag[<span class="number">8</span>] - <span class="number">250</span> * flag[<span class="number">9</span>] + <span class="number">166</span> * flag[<span class="number">10</span>] + <span class="number">126</span> * flag[<span class="number">11</span>] - <span class="number">11</span> * flag[<span class="number">12</span>] + <span class="number">690</span> * flag[<span class="number">13</span>] - <span class="number">207</span> * flag[<span class="number">14</span>] + <span class="number">46</span> * flag[<span class="number">15</span>] + <span class="number">6</span> * flag[<span class="number">16</span>] + <span class="number">7</span> * flag[<span class="number">17</span>] - <span class="number">18</span> * flag[<span class="number">18</span>] == <span class="number">12591</span>,</span><br><span class="line">         <span class="number">5</span> * flag[<span class="number">0</span>] + <span class="number">26</span> * flag[<span class="number">1</span>] + <span class="number">8</span> * flag[<span class="number">2</span>] + <span class="number">160</span> * flag[<span class="number">3</span>] + <span class="number">9</span> * flag[<span class="number">4</span>] - <span class="number">4</span> * flag[<span class="number">5</span>] + <span class="number">36</span> * flag[<span class="number">6</span>] + <span class="number">6</span> * flag[<span class="number">7</span>] - <span class="number">15</span> * flag[<span class="number">8</span>] - <span class="number">20</span> * flag[<span class="number">9</span>] + <span class="number">66</span> * flag[<span class="number">10</span>] + <span class="number">16</span> * flag[<span class="number">11</span>] - <span class="number">1</span> * flag[<span class="number">12</span>] + <span class="number">690</span> * flag[<span class="number">13</span>] - <span class="number">20</span> * flag[<span class="number">14</span>] + <span class="number">46</span> * flag[<span class="number">15</span>] + <span class="number">6</span> * flag[<span class="number">16</span>] + <span class="number">7</span> * flag[<span class="number">17</span>] - <span class="number">18</span> * flag[<span class="number">18</span>] + <span class="number">19</span> * flag[<span class="number">19</span>] == <span class="number">52041</span>,</span><br><span class="line">         <span class="number">29</span> * flag[<span class="number">0</span>] - <span class="number">26</span> * flag[<span class="number">1</span>] + <span class="number">0</span> * flag[<span class="number">2</span>] + <span class="number">60</span> * flag[<span class="number">3</span>] + <span class="number">90</span> * flag[<span class="number">4</span>] - <span class="number">4</span> * flag[<span class="number">5</span>] + <span class="number">6</span> * flag[<span class="number">6</span>] + <span class="number">6</span> * flag[<span class="number">7</span>] - <span class="number">16</span> * flag[<span class="number">8</span>] - <span class="number">21</span> * flag[<span class="number">9</span>] + <span class="number">69</span> * flag[<span class="number">10</span>] + <span class="number">6</span> * flag[<span class="number">11</span>] - <span class="number">12</span> * flag[<span class="number">12</span>] + <span class="number">69</span> * flag[<span class="number">13</span>] - <span class="number">20</span> * flag[<span class="number">14</span>] - <span class="number">46</span> * flag[<span class="number">15</span>] + <span class="number">65</span> * flag[<span class="number">16</span>] + <span class="number">0</span> * flag[<span class="number">17</span>] - <span class="number">1</span> * flag[<span class="number">18</span>] + <span class="number">39</span> * flag[<span class="number">19</span>] - <span class="number">20</span> * flag[<span class="number">20</span>] == <span class="number">20253</span>,</span><br><span class="line">         <span class="number">45</span> * flag[<span class="number">0</span>] - <span class="number">56</span> * flag[<span class="number">1</span>] + <span class="number">10</span> * flag[<span class="number">2</span>] + <span class="number">650</span> * flag[<span class="number">3</span>] - <span class="number">900</span> * flag[<span class="number">4</span>] + <span class="number">44</span> * flag[<span class="number">5</span>] + <span class="number">66</span> * flag[<span class="number">6</span>] - <span class="number">6</span> * flag[<span class="number">7</span>] - <span class="number">6</span> * flag[<span class="number">8</span>] - <span class="number">21</span> * flag[<span class="number">9</span>] + <span class="number">9</span> * flag[<span class="number">10</span>] - <span class="number">6</span> * flag[<span class="number">11</span>] - <span class="number">12</span> * flag[<span class="number">12</span>] + <span class="number">69</span> * flag[<span class="number">13</span>] - <span class="number">2</span> * flag[<span class="number">14</span>] - <span class="number">406</span> * flag[<span class="number">15</span>] + <span class="number">651</span> * flag[<span class="number">16</span>] + <span class="number">2</span> * flag[<span class="number">17</span>] - <span class="number">10</span> * flag[<span class="number">18</span>] + <span class="number">69</span> * flag[<span class="number">19</span>] - <span class="number">0</span> * flag[<span class="number">20</span>] + <span class="number">21</span> * flag[<span class="number">21</span>] == <span class="number">18768</span>,</span><br><span class="line">         <span class="number">555</span> * flag[<span class="number">0</span>] - <span class="number">6666</span> * flag[<span class="number">1</span>] + <span class="number">70</span> * flag[<span class="number">2</span>] + <span class="number">510</span> * flag[<span class="number">3</span>] - <span class="number">90</span> * flag[<span class="number">4</span>] + <span class="number">499</span> * flag[<span class="number">5</span>] + <span class="number">66</span> * flag[<span class="number">6</span>] - <span class="number">66</span> * flag[<span class="number">7</span>] - <span class="number">610</span> * flag[<span class="number">8</span>] - <span class="number">221</span> * flag[<span class="number">9</span>] + <span class="number">9</span> * flag[<span class="number">10</span>] - <span class="number">23</span> * flag[<span class="number">11</span>] - <span class="number">102</span> * flag[<span class="number">12</span>] + <span class="number">6</span> * flag[<span class="number">13</span>] + <span class="number">2050</span> * flag[<span class="number">14</span>] - <span class="number">406</span> * flag[<span class="number">15</span>] + <span class="number">665</span> * flag[<span class="number">16</span>] + <span class="number">333</span> * flag[<span class="number">17</span>] + <span class="number">100</span> * flag[<span class="number">18</span>] + <span class="number">609</span> * flag[<span class="number">19</span>] + <span class="number">777</span> * flag[<span class="number">20</span>] + <span class="number">201</span> * flag[<span class="number">21</span>] - <span class="number">22</span> * flag[<span class="number">22</span>] == <span class="number">111844</span>,</span><br><span class="line">         <span class="number">1</span> * flag[<span class="number">0</span>] - <span class="number">22</span> * flag[<span class="number">1</span>] + <span class="number">333</span> * flag[<span class="number">2</span>] + <span class="number">4444</span> * flag[<span class="number">3</span>] - <span class="number">5555</span> * flag[<span class="number">4</span>] + <span class="number">6666</span> * flag[<span class="number">5</span>] - <span class="number">666</span> * flag[<span class="number">6</span>] + <span class="number">676</span> * flag[<span class="number">7</span>] - <span class="number">660</span> * flag[<span class="number">8</span>] - <span class="number">22</span> * flag[<span class="number">9</span>] + <span class="number">9</span> * flag[<span class="number">10</span>] - <span class="number">73</span> * flag[<span class="number">11</span>] - <span class="number">107</span> * flag[<span class="number">12</span>] + <span class="number">6</span> * flag[<span class="number">13</span>] + <span class="number">250</span> * flag[<span class="number">14</span>] - <span class="number">6</span> * flag[<span class="number">15</span>] + <span class="number">65</span> * flag[<span class="number">16</span>] + <span class="number">39</span> * flag[<span class="number">17</span>] + <span class="number">10</span> * flag[<span class="number">18</span>] + <span class="number">69</span> * flag[<span class="number">19</span>] + <span class="number">777</span> * flag[<span class="number">20</span>] + <span class="number">201</span> * flag[<span class="number">21</span>] - <span class="number">2</span> * flag[<span class="number">22</span>] + <span class="number">23</span> * flag[<span class="number">23</span>] == <span class="number">159029</span>,</span><br><span class="line">         <span class="number">520</span> * flag[<span class="number">0</span>] - <span class="number">222</span> * flag[<span class="number">1</span>] + <span class="number">333</span> * flag[<span class="number">2</span>] + <span class="number">4</span> * flag[<span class="number">3</span>] - <span class="number">56655</span> * flag[<span class="number">4</span>] + <span class="number">6666</span> * flag[<span class="number">5</span>] + <span class="number">666</span> * flag[<span class="number">6</span>] + <span class="number">66</span> * flag[<span class="number">7</span>] - <span class="number">60</span> * flag[<span class="number">8</span>] - <span class="number">220</span> * flag[<span class="number">9</span>] + <span class="number">99</span> * flag[<span class="number">10</span>] + <span class="number">73</span> * flag[<span class="number">11</span>] + <span class="number">1007</span> * flag[<span class="number">12</span>] + <span class="number">7777</span> * flag[<span class="number">13</span>] + <span class="number">2500</span> * flag[<span class="number">14</span>] + <span class="number">6666</span> * flag[<span class="number">15</span>] + <span class="number">605</span> * flag[<span class="number">16</span>] + <span class="number">390</span> * flag[<span class="number">17</span>] + <span class="number">100</span> * flag[<span class="number">18</span>] + <span class="number">609</span> * flag[<span class="number">19</span>] + <span class="number">99999</span> * flag[<span class="number">20</span>] + <span class="number">210</span> * flag[<span class="number">21</span>] + <span class="number">232</span> * flag[<span class="number">22</span>] + <span class="number">23</span> * flag[<span class="number">23</span>] - <span class="number">24</span> * flag[<span class="number">24</span>] == <span class="number">2762025</span>,</span><br><span class="line">         <span class="number">1323</span> * flag[<span class="number">0</span>] - <span class="number">22</span> * flag[<span class="number">1</span>] + <span class="number">333</span> * flag[<span class="number">2</span>] + <span class="number">4</span> * flag[<span class="number">3</span>] - <span class="number">55</span> * flag[<span class="number">4</span>] + <span class="number">666</span> * flag[<span class="number">5</span>] + <span class="number">666</span> * flag[<span class="number">6</span>] + <span class="number">66</span> * flag[<span class="number">7</span>] - <span class="number">660</span> * flag[<span class="number">8</span>] - <span class="number">220</span> * flag[<span class="number">9</span>] + <span class="number">99</span> * flag[<span class="number">10</span>] + <span class="number">3</span> * flag[<span class="number">11</span>] + <span class="number">100</span> * flag[<span class="number">12</span>] + <span class="number">777</span> * flag[<span class="number">13</span>] + <span class="number">2500</span> * flag[<span class="number">14</span>] + <span class="number">6666</span> * flag[<span class="number">15</span>] + <span class="number">605</span> * flag[<span class="number">16</span>] + <span class="number">390</span> * flag[<span class="number">17</span>] + <span class="number">100</span> * flag[<span class="number">18</span>] + <span class="number">609</span> * flag[<span class="number">19</span>] + <span class="number">9999</span> * flag[<span class="number">20</span>] + <span class="number">210</span> * flag[<span class="number">21</span>] + <span class="number">232</span> * flag[<span class="number">22</span>] + <span class="number">23</span> * flag[<span class="number">23</span>] - <span class="number">24</span> * flag[<span class="number">24</span>] + <span class="number">25</span> * flag[<span class="number">25</span>] == <span class="number">1551621</span>,</span><br><span class="line">         <span class="number">777</span> * flag[<span class="number">0</span>] - <span class="number">22</span> * flag[<span class="number">1</span>] + <span class="number">6969</span> * flag[<span class="number">2</span>] + <span class="number">4</span> * flag[<span class="number">3</span>] - <span class="number">55</span> * flag[<span class="number">4</span>] + <span class="number">666</span> * flag[<span class="number">5</span>] - <span class="number">6</span> * flag[<span class="number">6</span>] + <span class="number">96</span> * flag[<span class="number">7</span>] - <span class="number">60</span> * flag[<span class="number">8</span>] - <span class="number">220</span> * flag[<span class="number">9</span>] + <span class="number">99</span> * flag[<span class="number">10</span>] + <span class="number">3</span> * flag[<span class="number">11</span>] + <span class="number">100</span> * flag[<span class="number">12</span>] + <span class="number">777</span> * flag[<span class="number">13</span>] + <span class="number">250</span> * flag[<span class="number">14</span>] + <span class="number">666</span> * flag[<span class="number">15</span>] + <span class="number">65</span> * flag[<span class="number">16</span>] + <span class="number">90</span> * flag[<span class="number">17</span>] + <span class="number">100</span> * flag[<span class="number">18</span>] + <span class="number">609</span> * flag[<span class="number">19</span>] + <span class="number">999</span> * flag[<span class="number">20</span>] + <span class="number">21</span> * flag[<span class="number">21</span>] + <span class="number">232</span> * flag[<span class="number">22</span>] + <span class="number">23</span> * flag[<span class="number">23</span>] - <span class="number">24</span> * flag[<span class="number">24</span>] + <span class="number">25</span> * flag[<span class="number">25</span>] - <span class="number">26</span> * flag[<span class="number">26</span>] == <span class="number">948348</span>,</span><br><span class="line">         <span class="number">97</span> * flag[<span class="number">0</span>] - <span class="number">22</span> * flag[<span class="number">1</span>] + <span class="number">6969</span> * flag[<span class="number">2</span>] + <span class="number">4</span> * flag[<span class="number">3</span>] - <span class="number">56</span> * flag[<span class="number">4</span>] + <span class="number">96</span> * flag[<span class="number">5</span>] - <span class="number">6</span> * flag[<span class="number">6</span>] + <span class="number">96</span> * flag[<span class="number">7</span>] - <span class="number">60</span> * flag[<span class="number">8</span>] - <span class="number">20</span> * flag[<span class="number">9</span>] + <span class="number">99</span> * flag[<span class="number">10</span>] + <span class="number">3</span> * flag[<span class="number">11</span>] + <span class="number">10</span> * flag[<span class="number">12</span>] + <span class="number">707</span> * flag[<span class="number">13</span>] + <span class="number">250</span> * flag[<span class="number">14</span>] + <span class="number">666</span> * flag[<span class="number">15</span>] + -<span class="number">9</span> * flag[<span class="number">16</span>] + <span class="number">90</span> * flag[<span class="number">17</span>] + -<span class="number">2</span> * flag[<span class="number">18</span>] + <span class="number">609</span> * flag[<span class="number">19</span>] + <span class="number">0</span> * flag[<span class="number">20</span>] + <span class="number">21</span> * flag[<span class="number">21</span>] + <span class="number">2</span> * flag[<span class="number">22</span>] + <span class="number">23</span> * flag[<span class="number">23</span>] - <span class="number">24</span> * flag[<span class="number">24</span>] + <span class="number">25</span> * flag[<span class="number">25</span>] - <span class="number">26</span> * flag[<span class="number">26</span>] + <span class="number">27</span> * flag[<span class="number">27</span>] == <span class="number">777044</span>,</span><br><span class="line">         <span class="number">177</span> * flag[<span class="number">0</span>] - <span class="number">22</span> * flag[<span class="number">1</span>] + <span class="number">699</span> * flag[<span class="number">2</span>] + <span class="number">64</span> * flag[<span class="number">3</span>] - <span class="number">56</span> * flag[<span class="number">4</span>] - <span class="number">96</span> * flag[<span class="number">5</span>] - <span class="number">66</span> * flag[<span class="number">6</span>] + <span class="number">96</span> * flag[<span class="number">7</span>] - <span class="number">60</span> * flag[<span class="number">8</span>] - <span class="number">20</span> * flag[<span class="number">9</span>] + <span class="number">99</span> * flag[<span class="number">10</span>] + <span class="number">3</span> * flag[<span class="number">11</span>] + <span class="number">10</span> * flag[<span class="number">12</span>] + <span class="number">707</span> * flag[<span class="number">13</span>] + <span class="number">250</span> * flag[<span class="number">14</span>] + <span class="number">666</span> * flag[<span class="number">15</span>] + -<span class="number">9</span> * flag[<span class="number">16</span>] + <span class="number">0</span> * flag[<span class="number">17</span>] + -<span class="number">2</span> * flag[<span class="number">18</span>] + <span class="number">69</span> * flag[<span class="number">19</span>] + <span class="number">0</span> * flag[<span class="number">20</span>] + <span class="number">21</span> * flag[<span class="number">21</span>] + <span class="number">222</span> * flag[<span class="number">22</span>] + <span class="number">23</span> * flag[<span class="number">23</span>] - <span class="number">224</span> * flag[<span class="number">24</span>] + <span class="number">25</span> * flag[<span class="number">25</span>] - <span class="number">26</span> * flag[<span class="number">26</span>] + <span class="number">27</span> * flag[<span class="number">27</span>] - <span class="number">28</span> * flag[<span class="number">28</span>] == <span class="number">185016</span>,</span><br><span class="line">         <span class="number">77</span> * flag[<span class="number">0</span>] - <span class="number">2</span> * flag[<span class="number">1</span>] + <span class="number">6</span> * flag[<span class="number">2</span>] + <span class="number">6</span> * flag[<span class="number">3</span>] - <span class="number">96</span> * flag[<span class="number">4</span>] - <span class="number">9</span> * flag[<span class="number">5</span>] - <span class="number">6</span> * flag[<span class="number">6</span>] + <span class="number">96</span> * flag[<span class="number">7</span>] - <span class="number">0</span> * flag[<span class="number">8</span>] - <span class="number">20</span> * flag[<span class="number">9</span>] + <span class="number">99</span> * flag[<span class="number">10</span>] + <span class="number">3</span> * flag[<span class="number">11</span>] + <span class="number">10</span> * flag[<span class="number">12</span>] + <span class="number">707</span> * flag[<span class="number">13</span>] + <span class="number">250</span> * flag[<span class="number">14</span>] + <span class="number">666</span> * flag[<span class="number">15</span>] + -<span class="number">9</span> * flag[<span class="number">16</span>] + <span class="number">0</span> * flag[<span class="number">17</span>] + -<span class="number">2</span> * flag[<span class="number">18</span>] + <span class="number">9</span> * flag[<span class="number">19</span>] + <span class="number">0</span> * flag[<span class="number">20</span>] + <span class="number">21</span> * flag[<span class="number">21</span>] + <span class="number">222</span> * flag[<span class="number">22</span>] + <span class="number">23</span> * flag[<span class="number">23</span>] - <span class="number">224</span> * flag[<span class="number">24</span>] + <span class="number">26</span> * flag[<span class="number">25</span>] - -<span class="number">58</span> * flag[<span class="number">26</span>] + <span class="number">27</span> * flag[<span class="number">27</span>] - <span class="number">2</span> * flag[<span class="number">28</span>] + <span class="number">29</span> * flag[<span class="number">29</span>] == <span class="number">130106</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">all</span>(result):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Congratulation!!!&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;wrong_wrong!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># okay decompiling output.pyc</span></span><br></pre></td></tr></table></figure>

<p>z3约束一下，获得 H1Z1N1U1C1T1F1{1a6d275f7-463}1</p>
<p>前面还有111111116257645365477364777645752361 代表着出现的次数，其实z3获得的两个两个一组，第一个是字符，第二个是出现次数，然后往里面填flag就好a6 d2 75 f7 -4 63</p>
<p>得到HZNUCTF{adffa-f6af-ff6a-fffa-fffd6a}</p>
<h2 id="randomsystem"><a href="#randomsystem" class="headerlink" title="randomsystem"></a>randomsystem</h2><p>先静态分析</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//初始化省略...</span></span><br><span class="line"></span><br><span class="line">  sub_E3137A(&amp;unk_E3E0A9);</span><br><span class="line">  p_n53 = <span class="number">0</span>;</span><br><span class="line">  n53_1 = <span class="number">0</span>;</span><br><span class="line">  n53_2 = <span class="number">0</span>;</span><br><span class="line">  n53_3 = <span class="number">0</span>;</span><br><span class="line">  v30 = <span class="number">0</span>;</span><br><span class="line">  j_memset(box, <span class="number">0</span>, <span class="number">0x100u</span>);</span><br><span class="line">  j_memset(&amp;v21, <span class="number">0</span>, <span class="number">0x100u</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(KeYkEy__, <span class="string">&quot;KeYkEy!!&quot;</span>);</span><br><span class="line"><span class="comment">//flag初始化省略...</span></span><br><span class="line">  sub_E310EB(<span class="string">&quot;Welcome to HZNUCTF!!!\n&quot;</span>, v7);</span><br><span class="line">  sub_E310EB(<span class="string">&quot;Enter something: \n&quot;</span>, v8);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%64s&quot;</span>, v32);</span><br><span class="line">  sub_E31339(v32, v31);</span><br><span class="line">  sub_E3128F(v31[<span class="number">0</span>], v31[<span class="number">1</span>], &amp;p_n53);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="comment">//对第一次输入验证 )</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_E310EB(<span class="string">&quot;good_job!!!\n&quot;</span>, v9);</span><br><span class="line">    sub_E310EB(<span class="string">&quot;So, Plz input the flag:\n&quot;</span>, v10);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%73s&quot;</span>, &amp;v24);</span><br><span class="line">    strncpy_s(Destination, <span class="number">65u</span>, Source, <span class="number">64u</span>);</span><br><span class="line">    sub_E3127B();</span><br><span class="line">    srand(Seed);</span><br><span class="line">    sub_E3127B();</span><br><span class="line">    j_memset(num, <span class="number">0</span>, <span class="number">0x80u</span>);</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        rand();</span><br><span class="line">        v4 = sub_E3127B() % <span class="number">32</span>;</span><br><span class="line">        v16 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; i; ++j )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( num[j] == v4 )</span><br><span class="line">          &#123;</span><br><span class="line">            v16 = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( !v16 );</span><br><span class="line">      num[i] = v4;</span><br><span class="line">    &#125;</span><br><span class="line">    j_a2z(Destination, num);</span><br><span class="line">    j_make(box, Destination);</span><br><span class="line">    j_makekey(&amp;p_n53, KeYkEy__);</span><br><span class="line">    j_encrypt(box1, box, &amp;v21);</span><br><span class="line">    v14 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">8</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">8</span>; ++m )</span><br><span class="line">      &#123;</span><br><span class="line">        box[<span class="number">32</span> * k + m + <span class="number">64</span>] ^= KeYkEy__[v14 % j_strlen(KeYkEy__)];</span><br><span class="line">        ++v14;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( j_strcmp(&amp;v21, flag) == <span class="number">1</span> )</span><br><span class="line">      sub_E310EB(<span class="string">&quot;Congratulation!!!\n&quot;</span>, v11);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_E310EB(<span class="string">&quot;wrong_wrong!!!\n&quot;</span>, v9);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_E3120D(&amp;savedregs, &amp;dword_E32D48, <span class="number">0</span>, v3);</span><br><span class="line">  <span class="keyword">return</span> v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_E3127B函数是函数指针的调用，调用者就是上面的函数</p>
<p>那么大致流程就是先输入然后验证，在输入明文，明文被随机数打乱，然后生成8*8的矩阵，紧接着用第一次输入构造key，然后用box1和输入矩阵生成新的矩阵，然后矩阵异或key，最后验证</p>
<p>所以直接z3求解，大部分的可以dump下来</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#flag = 0x12a,0x101,0xff,0x190,0x147,0x12c,0xd8,0x133,0x17c,0x13f,0xc7,0x154,0x118,0x101,0x13e,0x160,0x162,0x167,0xf0,0x181,0x160,0x128,0x108,0x136,0xc5,0xa7,0xaf,0x10a,0xfb,0xac,0xe5,0xfd,0xfb,0xfe,0xfd,0x17b,0xcc,0x141,0xd4,0x108,0x97,0x71,0x96,0xc4,0xc6,0x58,0xaa,0xa2,0xaf,0x5c,0xa9,0xe3,0xa4,0xff,0x71,0x62,0xc8,0xd0,0xc3,0x104,0xca,0x100,0xf6,0xc5,</span></span><br><span class="line">flag=[<span class="number">0x00000178</span>, <span class="number">0x00000164</span>, <span class="number">0x000000A9</span>, <span class="number">0x000001F5</span>, <span class="number">0x00000115</span>, <span class="number">0x00000149</span>, <span class="number">0x0000008B</span>, <span class="number">0x00000156</span>, <span class="number">0x0000017C</span>, <span class="number">0x0000016D</span>, <span class="number">0x000000A2</span>, <span class="number">0x00000102</span>, <span class="number">0x0000017D</span>, <span class="number">0x00000153</span>, <span class="number">0x0000015B</span>, <span class="number">0x00000133</span>, <span class="number">0x00000107</span>, <span class="number">0x00000167</span>, <span class="number">0x000000A2</span>, <span class="number">0x000001E4</span>, <span class="number">0x00000136</span>, <span class="number">0x0000014D</span>, <span class="number">0x0000015A</span>, <span class="number">0x00000153</span>, <span class="number">0x00000096</span>, <span class="number">0x000000C2</span>, <span class="number">0x000000AF</span>, <span class="number">0x00000158</span>, <span class="number">0x0000009E</span>, <span class="number">0x000000FA</span>, <span class="number">0x00000080</span>, <span class="number">0x000000AF</span>, <span class="number">0x0000009E</span>, <span class="number">0x000000AD</span>, <span class="number">0x00000098</span>, <span class="number">0x0000017B</span>, <span class="number">0x0000009E</span>, <span class="number">0x00000124</span>, <span class="number">0x00000082</span>, <span class="number">0x0000016D</span>, <span class="number">0x000000C5</span>, <span class="number">0x00000014</span>, <span class="number">0x000000C5</span>, <span class="number">0x000000A1</span>, <span class="number">0x000000C6</span>, <span class="number">0x0000000A</span>, <span class="number">0x000000CF</span>, <span class="number">0x000000F4</span>, <span class="number">0x000000CA</span>, <span class="number">0x0000000E</span>, <span class="number">0x000000CC</span>, <span class="number">0x000000B0</span>, <span class="number">0x000000C1</span>, <span class="number">0x000000FF</span>, <span class="number">0x00000023</span>, <span class="number">0x00000007</span>, <span class="number">0x0000009E</span>, <span class="number">0x000000B5</span>, <span class="number">0x00000091</span>, <span class="number">0x00000161</span>, <span class="number">0x00000099</span>, <span class="number">0x00000165</span>, <span class="number">0x000000F6</span>, <span class="number">0x00000097</span>]</span><br><span class="line"><span class="meta">#flag=[0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000184, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x000000C2, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123, 0x00000123]</span></span><br><span class="line"><span class="meta">#flag=[0x000001D6, 0x000001E1, 0x000001D2, 0x000001E1, 0x000001D6, 0x000001E1, 0x000001D7, 0x000001E1, 0x000001D6, 0x000001E1, 0x000001D2, 0x000001E1, 0x000001D6, 0x000001E1, 0x000001D7, 0x000001E1, 0x000001D6, 0x000001E1, 0x000001D2, 0x000001E1, 0x000001D6, 0x000001E1, 0x000001D7, 0x000001E1, 0x00000171, 0x00000146, 0x00000175, 0x00000146, 0x00000171, 0x00000146, 0x00000170, 0x00000146, 0x00000171, 0x00000146, 0x00000175, 0x00000146, 0x00000171, 0x00000146, 0x00000170, 0x00000146, 0x00000090, 0x000000A7, 0x00000094, 0x000000A7, 0x00000090, 0x000000A7, 0x00000091, 0x000000A7, 0x00000090, 0x000000A7, 0x00000094, 0x000000A7, 0x00000090, 0x000000A7, 0x00000091, 0x000000A7, 0x00000171, 0x00000146, 0x00000175, 0x00000146, 0x00000171, 0x00000146, 0x00000170, 0x00000146]</span></span><br><span class="line"></span><br><span class="line">xor = [<span class="number">82</span>,<span class="number">101</span>,<span class="number">86</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">83</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">86</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">83</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">86</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">83</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">86</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">83</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">86</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">83</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">86</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">83</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">86</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">83</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">86</span>,<span class="number">101</span>,<span class="number">82</span>,<span class="number">101</span>,<span class="number">83</span>,<span class="number">101</span>,]</span><br><span class="line"></span><br><span class="line">outputbox_pre_xor = [flag[i] ^ xor[i] <span class="keyword">for</span> i in range(<span class="number">64</span>)]</span><br><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">data = [</span><br><span class="line">    [<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line">inputbox = [[Int(f<span class="string">&quot;inputbox_&#123;i&#125;_&#123;j&#125;&quot;</span>) <span class="keyword">for</span> j in range(<span class="number">8</span>)] <span class="keyword">for</span> i in range(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j in range(<span class="number">8</span>):</span><br><span class="line">        solver.add(inputbox[i][j] &gt;= <span class="number">0</span>, inputbox[i][j] &lt;= <span class="number">255</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j in range(<span class="number">8</span>):</span><br><span class="line">        total = sum(data[i][k] * inputbox[k][j] <span class="keyword">for</span> k in range(<span class="number">8</span>))</span><br><span class="line">        solver.add(total == outputbox_pre_xor[i*<span class="number">8</span> + j])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    inputbox_values = [[model.eval(inputbox[i][j]).as_long() <span class="keyword">for</span> j in range(<span class="number">8</span>)] <span class="keyword">for</span> i in range(<span class="number">8</span>)]</span><br><span class="line">    print(inputbox_values)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&quot;No solution found.&quot;</span>)</span><br><span class="line">processed_input = [inputbox_values[i][j] <span class="keyword">for</span> i in range(<span class="number">8</span>) <span class="keyword">for</span> j in range(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">randnum = [</span><br><span class="line">    <span class="number">27</span>, <span class="number">26</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">28</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">10</span>,</span><br><span class="line">    <span class="number">20</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">31</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>,</span><br><span class="line">    <span class="number">9</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">29</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">12</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">4</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">v4 = len(processed_input)</span><br><span class="line"><span class="keyword">for</span> i in range(v4 &gt;&gt; <span class="number">1</span>):</span><br><span class="line">    pos = v4 - randnum[i] - <span class="number">1</span></span><br><span class="line">    processed_input[i], processed_input[pos] = processed_input[pos], processed_input[i]</span><br><span class="line">original_input = bytes(processed_input)</span><br><span class="line">print(original_input.decode())</span><br></pre></td></tr></table></figure>

<p>得到3zfb899ac5c256d-7a8r59f0tccd-4fa6b8vfd111-a44ffy4r0-6dce5679da58</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>l1pmoluy,1392181761@qq.com</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://l1pmoluy.github.io/2025/06/02/2025TGCTF/" title="TGctf2025-re-wp">https://l1pmoluy.github.io/2025/06/02/2025TGCTF/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2025/10/08/gh0st%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" rel="prev" title="gh0st源码分析"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">gh0st源码分析</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2025/05/25/2025%E8%BD%A9%E8%BE%95%E6%9D%AF/" rel="next" title="轩辕杯2025-re-wp"><span class="post-nav-text">轩辕杯2025-re-wp</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2025 </span><a class="with-love" id="animate" href="https://l1pmoluy.github.io" title="l1pmoluy's blog"><span class="icon iconify" data-icon="ri:cloud-line"></span></a><span class="author"> l1pmoluy</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.3.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#f5b8d5" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://fastly.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://fastly.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js" type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div></body></html>